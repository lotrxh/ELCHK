GeneralFormListScreen As screen:
    Fill: =RGBA(243, 243, 243, 1)
    OnVisible: |
        =
        //生成待处理集合
        ClearCollect(
            ApprovalDetailCol,
            Filter(
                ShowColumns(
                    ApprovalDetail_Table,
                    "Title",
                    "Approval_No",
                    "Approver",
                    "ApproverEmail",
                    "Priortty",
                    "TaskStatus",
                    "AgentUserEmail",
                    "ActionNode"
                ),
                CurrentUser in ApproverEmail && (TaskStatus = "001" || TaskStatus = "002")
            )
        );
        //生成已处理集合
        ClearCollect(
            ProcessedDetailCol,
            Filter(
                ShowColumns(
                    ApprovalDetail_Table,
                    "Title",
                    "Approval_No",
                    "Approver",
                    "ApproverEmail",
                    "Priortty",
                    "TaskStatus",
                    "Editor",
                    "AgentUserEmail",
                    "ActionNode"
                ),
                CurrentUser in ApproverEmail && (TaskStatus = "004" || TaskStatus = "006" || TaskStatus = "000")
            )
        );
        //全部集合
        ClearCollect(
            ComplatelDetailCol,
            Filter(
                ShowColumns(
                    ApprovalDetail_Table,
                    "Title",
                    "Approval_No",
                    "Approver",
                    "ApproverEmail",
                    "Priortty",
                    "TaskStatus",
                    "Editor",
                    "AgentUserEmail",
                    "ActionNode"
                ),
                CurrentUser in ApproverEmail && (TaskStatus = "000" || TaskStatus = "001" || TaskStatus = "004" || TaskStatus = "006" || TaskStatus = "002" || TaskStatus = "005")
            )
        );
        //生成带部门和任务名称字段的ApprovalDetail_Table待處理任务
        ClearCollect(
            ApprovalDetailColwithdepartment,
            AddColumns(
                Filter(
                ShowColumns(
                    ApprovalDetail_Table,
                    "Title",
                    "Approval_No",
                    "Approver",
                    "ApproverEmail",
                    "Priortty",
                    "TaskStatus",
                    "AgentUserEmail",
                    "ActionNode"
                ),
                TaskStatus = "001" || TaskStatus = "002"
            ),
                "DepartMentName",
                LookUp(
                    Approval_Table,
                    标题 = Approval_No
                ).DepartMentUnit,
                "FormDepartMentName",
                LookUp(
                    Approval_Table,
                    标题 = Approval_No
                ).DepartMentName,
                "TaskName",
                LookUp(
                    Approval_Table,
                    标题 = Approval_No
                ).Task_Name    
            )
        );
        //過濾一期待處理認爲
        ClearCollect(
            ApprovalDetailColwithPhase1,
            Filter(ApprovalDetailColwithdepartment,
            TaskName = "任職資源申請" || TaskName = "招聘職位申請表" || TaskName = "假期批核人資料表" || TaskName = "預備合約通知書(新入職)"
            )
        );
        //過濾二期待處理認爲
        ClearCollect(
            ApprovalDetailColwithPhase2,
            Filter(ApprovalDetailColwithdepartment,
            TaskName <> "任職資源申請" && TaskName <> "招聘職位申請表" && TaskName <> "假期批核人資料表" && TaskName <> "預備合約通知書(新入職)"
            )
        );
        //生成待处理集合，新增Ismanger判断
        With(
            {
                SearchPendingData: If(
                    CurrentRoleTaskPermission = "NoManger",
                    Filter(
                        ApprovalDetailCol,
                        1 = 1
                    ),
                    ClearCollect(NewApprovalTable,ApprovalDetailColwithPhase1,
                    Filter(
                        ApprovalDetailColwithPhase2,
                        CurrentUser in ApproverEmail || CurrentRoleTaskPermission in DepartMentName || CurrentRoleTaskPermissionForm in FormDepartMentName
                    )
                ))
            },
            ClearCollect(
                FilterPendingDataCol,
                AddColumns(
                    GroupBy(
                        SearchPendingData,
                        "Approval_No",
                        "Data1"
                    ),
                    "TaskStatus",
                    LookUp(
                        SearchPendingData,
                        Approval_No = Approval_No
                    ).TaskStatus,
                    "FlowTaskName",
                    LookUp(
                        Approval_Table,
                        标题 = Approval_No
                    ).Task_Name,
                    "FlowOrder",
                    LookUp(
                        Approval_Table,
                        标题 = Approval_No
                    ).Application_No,
                    "SubmitApprover",
                    LookUp(
                        Approval_Table,
                        标题 = Approval_No
                    ).'Operator ',
                    "FlowCreateDate",
                    LookUp(
                        Approval_Table,
                        标题 = Approval_No
                    ).创建时间,
                    "DepartMentName",
                    LookUp(
                        Approval_Table,
                        标题 = Approval_No
                    ).DepartMentUnit,
                    "FormType",
                    LookUp(
                        Approval_Table,
                        标题 = Approval_No
                    ).FormType,
                    "Application_Status",
                    LookUp(
                        Approval_Table,
                        标题 = Approval_No
                    ).Application_Status,
                    "CustomerSearch",
                    LookUp(
                        GenericFormList,
                        ApprovalId = Approval_No
                    ).FilterLabel,
                    "ActionNode",
                    LookUp(
                        SearchPendingData,
                        Approval_No = Approval_No
                    ).ActionNode
                )
            )
        );
        //生成带部门和任務名稱字段的ApprovalDetail_Table已处理任务
        ClearCollect(
            ProcessedDetailColwithdepartment,
            AddColumns(
                ProcessedDetailCol,
                "DepartMentName",
                LookUp(
                    Approval_Table,
                    标题 = Approval_No
                ).DepartMentUnit,
                "FormDepartMentName",
                LookUp(
                    Approval_Table,
                    标题 = Approval_No
                ).DepartMentName,
                "TaskName",
                LookUp(
                    Approval_Table,
                    标题 = Approval_No
                ).Task_Name
            )
        );
        /*
        //過濾一期已处理認爲
        ClearCollect(
            ProcessedDetailColwithPhase1,
            Filter(ProcessedDetailColwithdepartment,
            TaskName = "任職資源申請" || TaskName = "招聘職位申請表" || TaskName = "假期批核人資料表" || TaskName = "預備合約通知書(新入職)"
            )
        );
        //過濾二期已处理認爲
        ClearCollect(
            ProcessedDetailColwithPhase2,
            Filter(ProcessedDetailColwithdepartment,
            TaskName <> "任職資源申請" && TaskName <> "招聘職位申請表" && TaskName <> "假期批核人資料表" && TaskName <> "預備合約通知書(新入職)"
            )
        );
        */
        //生成已处理集合，新增Ismanger判断
        With(
            {
                ProcessedListCol: If(
                    CurrentRoleTaskPermission = "NoManger",
                    Filter(
                        ProcessedDetailCol,
                        1 = 1
                    ),
                    Filter(
                        ProcessedDetailCol,
                        1 = 1
                        //ProcessedDetailColwithdepartment,
                        //CurrentRoleTaskPermission in DepartMentName || CurrentRoleTaskPermissionForm in FormDepartMentName
                    )
                )
            },
            ClearCollect(
                inprogressData,
                AddColumns(
                    GroupBy(
                        ProcessedListCol,
                        "Approval_No",
                        "Data"
                    ),
                    "TaskStatus",
                    LookUp(
                        ProcessedListCol,
                        Approval_No = Approval_No
                    ).TaskStatus,
                    "FlowTaskName",
                    LookUp(
                        Approval_Table,
                        标题 = Approval_No
                    ).Task_Name,
                    "FlowOrder",
                    LookUp(
                        Approval_Table,
                        标题 = Approval_No
                    ).Application_No,
                    "SubmitApprover",
                    LookUp(
                        Approval_Table,
                        标题 = Approval_No
                    ).'Operator ',
                    "FlowCreateDate",
                    LookUp(
                        Approval_Table,
                        标题 = Approval_No
                    ).创建时间,
                    "DepartMentName",
                    LookUp(
                        Approval_Table,
                        标题 = Approval_No
                    ).DepartMentUnit,
                    "FormType",
                    LookUp(
                        Approval_Table,
                        标题 = Approval_No
                    ).FormType,
                    "Application_Status",
                    LookUp(
                        Approval_Table,
                        标题 = Approval_No
                    ).Application_Status,
                    "CustomerSearch",
                    LookUp(
                        GenericFormList,
                        ApprovalId = Approval_No
                    ).FilterLabel
                )
            )
        );
        //生成带部门和任務名稱字段的ApprovalDetail_Table全部任务
        ClearCollect(
            ComplatelDetailColwithdepartment,
            AddColumns(
                Filter(
                ShowColumns(
                    ApprovalDetail_Table,
                    "Title",
                    "Approval_No",
                    "Approver",
                    "ApproverEmail",
                    "Priortty",
                    "TaskStatus",
                    "Editor",
                    "AgentUserEmail",
                    "ActionNode"
                ),
                TaskStatus = "000" || TaskStatus = "001" || TaskStatus = "004" || TaskStatus = "006" || TaskStatus = "002" || TaskStatus = "005"
            ),
                "DepartMentName",
                LookUp(
                    Approval_Table,
                    标题 = Approval_No
                ).DepartMentUnit,
                "FormDepartMentName",
                LookUp(
                    Approval_Table,
                    标题 = Approval_No
                ).DepartMentName,
                "TaskName",
                LookUp(
                    Approval_Table,
                    标题 = Approval_No
                ).Task_Name
            )
        );
        //過濾一期全部認爲
        ClearCollect(
            AllDetailColwithPhase1,
            Filter(ComplatelDetailColwithdepartment,
            TaskName = "任職資源申請" || TaskName = "招聘職位申請表" || TaskName = "假期批核人資料表" || TaskName = "預備合約通知書(新入職)"
            )
        );
        //過濾二期全部認爲
        ClearCollect(
            AllDetailColwithPhase2,
            Filter(ComplatelDetailColwithdepartment,
            TaskName <> "任職資源申請" && TaskName <> "招聘職位申請表" && TaskName <> "假期批核人資料表" && TaskName <> "預備合約通知書(新入職)"
            )
        );
        //生成所有集合，新增Ismanger判断
        With(
            {
                AllApprovalList: If(
                    CurrentRoleTaskPermission = "NoManger",
                    Filter(
                        ComplatelDetailCol,
                        TaskStatus <> Blank()
                    ),
                    ClearCollect(AllTaskTable,AllDetailColwithPhase1,
                    Filter(
                        AllDetailColwithPhase2,
                        TaskStatus <> Blank() && (CurrentUser in ApproverEmail || CurrentRoleTaskPermission in DepartMentName || CurrentRoleTaskPermissionForm in FormDepartMentName)
                    )
                ))
            },
            ClearCollect(
                AllApprovalListDataCol,
                AddColumns(
                    GroupBy(
                        AllApprovalList,
                        "Approval_No",
                        "Data"
                    ),
                    "TaskStatus",
                    LookUp(
                        AllApprovalList,
                        Approval_No = Approval_No
                    ).TaskStatus,
                    "FlowTaskName",
                    LookUp(
                        Approval_Table,
                        标题 = Approval_No
                    ).Task_Name,
                    "FlowOrder",
                    LookUp(
                        Approval_Table,
                        标题 = Approval_No
                    ).Application_No,
                    "FlowCreateDate",
                    LookUp(
                        Approval_Table,
                        标题 = Approval_No
                    ).创建时间,
                    "SubmitApprover",
                    LookUp(
                        Approval_Table,
                        标题 = Approval_No
                    ).'Operator ',
                    "DepartMentName",
                    LookUp(
                        Approval_Table,
                        标题 = Approval_No
                    ).DepartMentUnit,
                    "FormType",
                    LookUp(
                        Approval_Table,
                        标题 = Approval_No
                    ).FormType,
                    "Application_Status",
                    LookUp(
                        Approval_Table,
                        标题 = Approval_No
                    ).Application_Status,
                    "CustomerSearch",
                    LookUp(
                        GenericFormList,
                        ApprovalId = Approval_No
                    ).FilterLabel
                )
            )
        );
        Select(BtnSecondIconOnly_4);

    ContainerMain As groupContainer.manualLayoutContainer:
        Fill: =RGBA(247, 247, 247, 1)
        Height: =768
        Width: =1126
        X: =240
        ZIndex: =1

        Container5_2 As groupContainer.manualLayoutContainer:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =130
            Width: =1105
            X: =12
            Y: =16
            ZIndex: =4

            ComboBox1_5 As combobox:
                BorderColor: =glbNeutralTertiaryColor
                BorderThickness: =1
                ChevronBackground: =RGBA(255, 255, 255, 1)
                ChevronDisabledBackground: =RGBA(0, 0, 0, 0)
                ChevronDisabledFill: =RGBA(202, 202, 202, 1)
                ChevronFill: =glbNeutralTertiaryColor
                ChevronHoverBackground: =ColorFade(Self.ChevronBackground, -5%)
                ChevronHoverFill: =ColorFade(Self.BorderColor, -20%)
                Color: =glbNeutralPrimaryColor
                DisplayFields: =["Result"]
                FocusedBorderThickness: =1
                Height: =32
                HoverBorderColor: =ColorFade(Self.BorderColor, -20%)
                HoverColor: =Self.Color
                HoverFill: =ColorFade(Self.Fill, -5%)
                InputTextPlaceholder: ="選擇部門"
                IsSearchable: =false
                Items: =Sort(Distinct(Filter(ConfigurationInfo,Type_Name="組織配置"&&(Value1="部門信息"||Value1="單位信息")),Code_No2&"-"&Value2),Result)
                NoSelectionText: ="表格部門/服務"
                PaddingLeft: =10
                PressedColor: =Self.Color
                PressedFill: =ColorFade(Self.Fill, -5%)
                SearchFields: =["Result"]
                SearchItems: =[]
                SelectionColor: =glbThemePrimaryColor
                SelectionFill: =ColorFade(Self.SelectionColor, 90%)
                Size: =10
                Width: =180
                X: =340
                Y: =80
                ZIndex: =1

            ComboBox1_6 As combobox:
                BorderColor: =glbNeutralTertiaryColor
                BorderThickness: =1
                ChevronBackground: =RGBA(255, 255, 255, 1)
                ChevronDisabledBackground: =RGBA(0, 0, 0, 0)
                ChevronDisabledFill: =RGBA(202, 202, 202, 1)
                ChevronFill: =glbNeutralTertiaryColor
                ChevronHoverBackground: =ColorFade(Self.ChevronBackground, -5%)
                ChevronHoverFill: =ColorFade(Self.BorderColor, -20%)
                Color: =glbNeutralPrimaryColor
                DisplayFields: =["Result"]
                FocusedBorderThickness: =1
                Height: =32
                HoverBorderColor: =ColorFade(Self.BorderColor, -20%)
                HoverColor: =Self.Color
                HoverFill: =ColorFade(Self.Fill, -5%)
                InputTextPlaceholder: ="表格類型"
                IsSearchable: =false
                Items: =Distinct(FormTableType,FormType)
                NoSelectionText: ="表格類型/單位"
                PaddingLeft: =10
                PressedColor: =Self.Color
                PressedFill: =ColorFade(Self.Fill, -5%)
                SearchFields: =["Result"]
                SearchItems: =[]
                SelectionColor: =glbThemePrimaryColor
                SelectionFill: =ColorFade(Self.SelectionColor, 90%)
                Size: =10
                Width: =180
                X: =530
                Y: =80
                ZIndex: =3

            BtnLgIconOnly_4 As icon.Add:
                BorderColor: =Self.Fill
                BorderThickness: =1
                Color: =glbThemePrimaryColor
                DisabledBorderColor: =RGBA(219, 219, 219, 1)
                DisabledColor: =RGBA(149, 149, 149, 1)
                DisabledFill: =RGBA(244, 244, 244, 1)
                Height: =32
                HoverFill: =ColorFade(Self.Fill, -15%)
                Icon: =Icon.Search
                OnSelect: |-
                    =If(
                        TabGallery3_4.Selected.Value = "全部",
                        ClearCollect(
                            AllApprovalDataCol,
                            Search(
                                Filter(
                                    SortByColumns(
                                        AllApprovalListDataCol,
                                        "FlowCreateDate",
                                        Descending
                                    ),
                                    IsBlank(ComboBox1_5.Selected.Result) || DepartMentName in ComboBox1_5.SelectedItems,
                                    IsBlank(ComboBox1_6.Selected.Result) || FormType in ComboBox1_6.SelectedItems,
                                    (DateValue(Text(FlowCreateDate)) >= DateValue(Text(TemplateStartDate_2.SelectedDate)) && DateValue(Text(FlowCreateDate)) <= DateValue(Text(TemplateEndDate_2.SelectedDate)))
                                ),
                                TextInput2_13.Text,
                                "FlowOrder",
                                "FlowTaskName",
                                "CustomerSearch",
                                "SubmitApprover"
                            )
                        ),
                        TabGallery3_4.Selected.Value = "待我處理",
                        ClearCollect(
                            AllPendingApprovalData,
                            Search(
                                Filter(
                                    SortByColumns(
                                        FilterPendingDataCol,
                                        "FlowCreateDate",
                                        Descending
                                    ),
                                    IsBlank(ComboBox1_5.Selected.Result) || DepartMentName in ComboBox1_5.SelectedItems,
                                    IsBlank(ComboBox1_6.Selected.Result) || FormType in ComboBox1_6.SelectedItems,
                                    (DateValue(Text(FlowCreateDate)) >= DateValue(Text(TemplateStartDate_2.SelectedDate)) && DateValue(Text(FlowCreateDate)) <= DateValue(Text(TemplateEndDate_2.SelectedDate)))
                                ),
                                TextInput2_13.Text,
                                "FlowOrder",
                                "FlowTaskName",
                                "CustomerSearch",
                                "SubmitApprover"
                            )
                        ),
                        TabGallery3_4.Selected.Value = "我已處理",
                        ClearCollect(
                            AllinprogressApprovalData,
                            Search(
                                Filter(
                                    SortByColumns(
                                        inprogressData,
                                        "FlowCreateDate",
                                        Descending
                                    ),
                                    IsBlank(ComboBox1_5.Selected.Result) || DepartMentName in ComboBox1_5.SelectedItems,
                                    IsBlank(ComboBox1_6.Selected.Result) || FormType in ComboBox1_6.SelectedItems,
                                    (DateValue(Text(FlowCreateDate)) >= DateValue(Text(TemplateStartDate_2.SelectedDate)) && DateValue(Text(FlowCreateDate)) <= DateValue(Text(TemplateEndDate_2.SelectedDate)))
                                ),
                                TextInput2_13.Text,
                                "FlowOrder",
                                "FlowTaskName",
                                "CustomerSearch",
                                "SubmitApprover"
                            )
                        )
                    )
                PaddingBottom: =2
                PaddingTop: =2
                PressedColor: =ColorFade(Self.Color, -15%)
                PressedFill: =ColorFade(Self.Fill, -25%)
                Width: =32
                X: =1060
                Y: =80
                ZIndex: =5

            LineRectangle_1 As rectangle:
                Fill: =RGBA(219, 219, 219, 1)
                Height: =1
                Width: =1105
                Y: =54
                ZIndex: =7

            TabGallery3_4 As gallery.galleryHorizontal:
                Height: =40
                Items: =["待我處理","我已處理","全部"]
                OnSelect: |
                    =//Select(BtnLgIconOnly_4);
                TemplatePadding: =0
                TemplateSize: =147
                Width: =996
                X: =20
                Y: =15
                ZIndex: =8

                Label2_3 As label:
                    Align: =Align.Center
                    Color: |-
                        =If(
                            ThisItem.IsSelected,
                            glbThemePrimaryColor,
                            glbNeutralSecondaryColor
                        )
                    FontWeight: |-
                        =If(
                            ThisItem.IsSelected,
                            FontWeight.Bold,
                            FontWeight.Normal
                        )
                    Height: =32
                    HoverColor: =glbThemePrimaryColor
                    OnSelect: |-
                        =//Select(BtnLgIconOnly_4);
                        Select(BtnSecondIconOnly_4)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =15
                    Text: =ThisItem.Value
                    Width: =100
                    X: =24
                    ZIndex: =1

                Rectangle2_3 As rectangle:
                    Fill: =glbThemePrimaryColor
                    Height: =3
                    OnSelect: =Select(Parent)
                    Visible: =If(ThisItem.IsSelected, true, false)
                    Width: =100
                    X: =24
                    Y: =37
                    ZIndex: =2

            TextInput2_13 As text:
                BorderColor: =glbNeutralTertiaryColor
                BorderThickness: =1
                Color: =glbNeutralPrimaryColor
                Default: =""
                FocusedBorderColor: =glbNeutralSecondaryColor
                FocusedBorderThickness: =1
                Height: =32
                HintText: ="請輸入申請編號、申請人、表格或標籤"
                HoverBorderColor: =ColorFade(Self.BorderColor, -20%)
                HoverFill: =ColorFade(Self.Fill, -5%)
                PaddingBottom: =0
                PaddingLeft: =10
                PaddingRight: =0
                PaddingTop: =0
                PressedBorderColor: =ColorFade(Self.BorderColor, -20%)
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =10
                Width: =310
                X: =20
                Y: =80
                ZIndex: =9

            Group1_1 As group:
                Height: =5
                Width: =5
                X: =-983
                Y: =-190
                ZIndex: =14

                DateBackground_3 As text:
                    BorderColor: =
                    BorderThickness: =1
                    Color: =
                    Default: =""
                    DisabledFill: =RGBA(255, 255, 255, 1)
                    DisplayMode: =DisplayMode.Disabled
                    FocusedBorderColor: =
                    FocusedBorderThickness: =1
                    Font: =Font.Arial
                    Height: =32
                    HintText: =""
                    HoverBorderColor: =
                    HoverFill: =
                    PaddingBottom: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    PressedBorderColor: =
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =11
                    Width: =263
                    X: =721
                    Y: =80
                    ZIndex: =10

                TemplateEndDate_2 As datepicker:
                    BorderColor: =
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =0
                    Color: =RGBA(96, 94, 92, 1)
                    Fill: =RGBA(0, 0, 0, 0)
                    FocusedBorderThickness: =1
                    Font: =Font.Arial
                    Format: ="dd/mm/yyyy"
                    Height: =32
                    IconBackground: =RGBA(0, 0, 0, 0)
                    IconFill: =glbNeutralSecondaryColor
                    InputTextPlaceholder: =//If(IsBlank(Self.SelectedDate), Text(Date(2001,12,31), Self.Format, Self.Language))
                    OnChange: |-
                        =/*If(
                            IsBlank(StartDate.SelectedDate) || IsBlank(EndDate.SelectedDate),
                            UpdateContext({DateErrorMessage: false}),
                            If(
                            EndDate.SelectedDate < StartDate.SelectedDate,
                            UpdateContext({DateErrorMessage: true})
                        ));*/
                        If(TemplateEndDate_2.SelectedDate < TemplateStartDate_2.SelectedDate,Notify("The end time must be greater than the start time");Reset(TemplateEndDate_2))
                    OnSelect: =
                    PaddingBottom: =0
                    PaddingRight: =0
                    Size: =10
                    Width: =120
                    X: =864
                    Y: =80
                    ZIndex: =11

                TemplateStartDate_2 As datepicker:
                    BorderColor: =
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =0
                    Color: =RGBA(96, 94, 92, 1)
                    DefaultDate: =Today()-30
                    Fill: =RGBA(0, 0, 0, 0)
                    FocusedBorderColor: =White
                    FocusedBorderThickness: =0
                    Font: =Font.Arial
                    Format: ="dd/mm/yyyy"
                    Height: =32
                    IconBackground: =RGBA(0, 0, 0, 0)
                    IconFill: =glbNeutralSecondaryColor
                    InputTextPlaceholder: =
                    PaddingBottom: =0
                    PaddingRight: =0
                    Size: =10
                    Width: =120
                    X: =721
                    Y: =80
                    ZIndex: =12

                DateLineLabel1_40 As label:
                    Align: =Align.Center
                    Color: =RGBA(149, 149, 149, 1)
                    Font: =Font.Arial
                    Height: =32
                    PaddingBottom: =3
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =10
                    Text: ="—"
                    Width: =16
                    X: =848
                    Y: =80
                    ZIndex: =13

            Group23_1 As group:
                Height: =5
                Width: =5
                X: =-928
                Y: =20
                ZIndex: =16

                Image5_1 As image:
                    Height: =32
                    Image: |-
                        ="data:image/svg+xml," & EncodeUrl("<svg width='15' height='15' viewBox='0 0 15 15' fill='none' xmlns='http://www.w3.org/2000/svg'> <path fill-rule='evenodd' clip-rule='evenodd' d='M4.10957 2.18765C4.20445 2.06904 4.34811 2 4.5 2H13.5C14.3284 2 15 2.67157 15 3.5V11.5C15 12.3284 14.3284 13 13.5 13H4.5C4.34811 13 4.20445 12.931 4.10957 12.8123L0.109566 7.81235C-0.0365219 7.62974 -0.0365219 7.37026 0.109566 7.18765L4.10957 2.18765ZM10.1465 9.85356L8.50004 8.20711L6.85359 9.85356L6.14648 9.14645L7.79293 7.50001L6.14648 5.85356L6.85359 5.14645L8.50004 6.7929L10.1465 5.14645L10.8536 5.85356L9.20714 7.50001L10.8536 9.14645L10.1465 9.85356Z' fill='#cccccc'/> </svg>")
                    PaddingBottom: =4
                    PaddingTop: =4
                    Width: =32
                    X: =1016
                    Y: =80
                    ZIndex: =14

                BtnSecondIconOnly_4 As icon.Add:
                    BorderColor: =glbNeutralQuaternaryColor
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =1
                    Color: =RGBA(0, 0, 0, 0)
                    DisabledBorderColor: =RGBA(219, 219, 219, 1)
                    DisabledColor: =RGBA(149, 149, 149, 1)
                    DisabledFill: =RGBA(244, 244, 244, 1)
                    FocusedBorderThickness: =1
                    Height: =32
                    HoverBorderColor: =RGBA(0, 0, 0, 0)
                    HoverColor: =RGBA(0, 0, 0, 0)
                    HoverFill: =RGBA(0, 0, 0, 0)
                    Icon: =Icon.Erase
                    OnSelect: |-
                        =Reset(TextInput2_13);
                        Reset(ComboBox1_5);
                        Reset(ComboBox1_6);
                        Reset(TemplateStartDate_2);
                        Reset(TemplateEndDate_2);
                        Select(BtnLgIconOnly_4);
                    PaddingBottom: =8
                    PaddingTop: =8
                    PressedBorderColor: =ColorFade(glbThemePrimaryColor, -15%)
                    PressedColor: =Transparent
                    PressedFill: =Transparent
                    Width: =32
                    X: =1016
                    Y: =80
                    ZIndex: =15

        Container5_3 As groupContainer.manualLayoutContainer:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =608
            Width: =1105
            X: =12
            Y: =146
            ZIndex: =5

            Container2_2 As groupContainer.manualLayoutContainer:
                Fill: =RGBA(255, 255, 255, 1)
                Height: =40
                Width: =1085
                X: =20
                ZIndex: =1

                Label4_6 As label:
                    Align: =Align.Center
                    Color: =glbNeutralPrimaryColor
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =12
                    Text: ="申請編號"
                    Width: =140
                    ZIndex: =1

                Label4_7 As label:
                    Align: =Align.Center
                    Color: =glbNeutralPrimaryColor
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =12
                    Text: ="表格名稱及編號"
                    Width: =246
                    X: =140
                    ZIndex: =2

                Label4_9 As label:
                    Align: =Align.Center
                    Color: =glbNeutralPrimaryColor
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =12
                    Text: ="申請部門或單位"
                    Width: =123
                    X: =386
                    ZIndex: =4

                Label4_10 As label:
                    Align: =Align.Center
                    Color: =glbNeutralPrimaryColor
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =12
                    Text: ="填表人及日期"
                    Width: =137
                    X: =509
                    ZIndex: =5

                Label4_12 As label:
                    Align: =Align.Center
                    Color: =glbNeutralPrimaryColor
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =12
                    Text: ="狀態"
                    Width: =130
                    X: =850
                    ZIndex: =7

                Label4_13 As label:
                    Align: =Align.Center
                    Color: =glbNeutralPrimaryColor
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =12
                    Text: ="標籤"
                    Width: =200
                    X: =650
                    ZIndex: =8

            TaskListGallery As gallery.galleryVertical:
                Fill: =RGBA(255, 255, 255, 1)
                Height: =535
                Items: |-
                    =If(
                        TabGallery3_4.Selected.Value = "全部",
                        AllApprovalDataCol,
                        TabGallery3_4.Selected.Value = "待我處理",
                        AllPendingApprovalData,
                        TabGallery3_4.Selected.Value = "我已處理",
                        AllinprogressApprovalData
                    )
                Layout: =Layout.Vertical
                OnSelect: =
                TemplatePadding: =0
                TemplateSize: =48
                Width: =1085
                X: =20
                Y: =40
                ZIndex: =2

                Label3_6 As label:
                    Align: =Align.Center
                    Color: =glbNeutralSecondaryColor
                    Height: =48
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =10
                    Text: =ThisItem.FlowOrder
                    Width: =140
                    ZIndex: =1

                Rectangle3_3 As rectangle:
                    Fill: =glbNeutralLightColor
                    Height: =1
                    OnSelect: =Select(Parent)
                    Width: =Parent.TemplateWidth
                    Y: =47
                    ZIndex: =2

                Label3_7 As label:
                    Align: =Align.Center
                    Color: =glbNeutralSecondaryColor
                    Height: =48
                    HoverColor: =glbThemePrimaryColor
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =10
                    Text: =If(Len(ThisItem.FlowOrder) = 15,Left(ThisItem.FlowOrder,4),Len(ThisItem.FlowOrder) = 16,Left(ThisItem.FlowOrder,5))&Char(10)&ThisItem.FlowTaskName
                    Tooltip: =ThisItem.FlowTaskName
                    Width: =246
                    Wrap: =false
                    X: =140
                    ZIndex: =9

                lblTag_7 As label:
                    Align: =Align.Center
                    BorderColor: =RGBA(255, 255, 255, 1)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =1
                    Color: |-
                        =If(
                            lblTag_7.Text = "執行完成",
                            glbSuccessColor,
                            lblTag_7.Text = "準備中",//"Success",
                            glbThemeSecondaryColor,
                            "待" in lblTag_7.Text && !("被退回" in lblTag_7.Text),//"Processing",
                            glbLinkColor,
                            "被退回" in lblTag_7.Text,
                            glbWarningColor,
                            lblTag_7.Text = "被拒絕",
                            glbErrorColor,
                            lblTag_7.Text = "待執行",
                            glbNeutralLightColor,
                            glbNeutralQuaternaryColor
                            )
                    Fill: =ColorFade(Self.Color, 90%)
                    FocusedBorderThickness: =2
                    Height: =38
                    OnSelect: =
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =10
                    Text: |-
                        =If(
                            First(
                                SortByColumns(
                                    Filter(
                                        ApprovalDetail_Table,
                                        Approval_No = ThisItem.Approval_No,
                                        TaskStatus = "002"
                                    ),
                                    "Priortty",
                                    Descending
                                )
                            ).ActionNode = "填寫", "待：填寫",
                            First(
                                SortByColumns(
                                    Filter(
                                        ApprovalDetail_Table,
                                        Approval_No = ThisItem.Approval_No,
                                        TaskStatus = "002"
                                    ),
                                    "Priortty",
                                    Descending
                                )
                            ).ActionNode = "提交", "待：提交",
                            First(
                                SortByColumns(
                                    Filter(
                                        ApprovalDetail_Table,
                                        Approval_No = ThisItem.Approval_No,
                                        TaskStatus = "002"
                                    ),
                                    "Priortty",
                                    Descending
                                )
                            ).ActionNode = "補充資料", "待：補充資料",
                            First(
                                SortByColumns(
                                    Filter(
                                        ApprovalDetail_Table,
                                        Approval_No = ThisItem.Approval_No,
                                        TaskStatus = "002"
                                    ),
                                    "Priortty",
                                    Descending
                                )
                            ).ActionNode = "檢查", "待：檢查",
                            First(
                                SortByColumns(
                                    Filter(
                                        ApprovalDetail_Table,
                                        Approval_No = ThisItem.Approval_No,
                                        TaskStatus = "002"
                                    ),
                                    "Priortty",
                                    Descending
                                )
                            ).ActionNode = "簽批", "待：簽批",
                            First(
                                SortByColumns(
                                    Filter(
                                        ApprovalDetail_Table,
                                        Approval_No = ThisItem.Approval_No,
                                        TaskStatus = "002"
                                    ),
                                    "Priortty",
                                    Descending
                                )
                            ).ActionNode = "助理總幹事審批", "待：助理總幹事審批",
                            First(
                                SortByColumns(
                                    Filter(
                                        ApprovalDetail_Table,
                                        Approval_No = ThisItem.Approval_No,
                                        TaskStatus = "002"
                                    ),
                                    "Priortty",
                                    Descending
                                )
                            ).ActionNode = "總幹事審批", "待：總幹事審批",
                            First(
                                SortByColumns(
                                    Filter(
                                        ApprovalDetail_Table,
                                        Approval_No = ThisItem.Approval_No,
                                        TaskStatus = "002"
                                    ),
                                    "Priortty",
                                    Descending
                                )
                            ).ActionNode = "跟進", "待：跟進",
                            First(
                                SortByColumns(
                                    Filter(
                                        ApprovalDetail_Table,
                                        Approval_No = ThisItem.Approval_No,
                                        TaskStatus="000"
                                    ),
                                    "Priortty",
                                    Descending
                                )
                            ).TaskStatus = "000","被拒絕",
                            First(
                                SortByColumns(
                                    Filter(
                                        ApprovalDetail_Table,
                                        Approval_No = ThisItem.Approval_No
                                    ),
                                    "Priortty",
                                    Descending
                                )
                            ).TaskStatus = "006","執行完成",
                            First(
                                SortByColumns(
                                    Filter(
                                        ApprovalDetail_Table,
                                        Approval_No = ThisItem.Approval_No
                                    ),
                                    "Priortty",
                                    Descending
                                )
                            ).TaskStatus = "001","準備中",
                            First(
                                SortByColumns(
                                    Filter(
                                        ApprovalDetail_Table,
                                        Approval_No = ThisItem.Approval_No
                                    ),
                                    "Priortty",
                                    Descending
                                )
                            ).TaskStatus = "003","待執行",
                            "待批准"
                        )&If(Index(
                                SortByColumns(
                                    Filter(
                                        ApprovalDetail_Table,
                                        Approval_No = ThisItem.Approval_No
                                    ),
                                    "Priortty",
                                    Descending
                                ),
                                2
                            ).TaskStatus = "005",Char(10)&"（被退回）","")
                    Width: =130
                    X: =850
                    Y: =5
                    ZIndex: =10

                BtnDefaultIconOnly_5 As icon.Add:
                    BorderColor: =Self.Color
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =1
                    Color: =glbThemePrimaryColor
                    DisabledBorderColor: =RGBA(219, 219, 219, 1)
                    DisabledColor: =RGBA(149, 149, 149, 1)
                    DisabledFill: =RGBA(244, 244, 244, 1)
                    DisplayMode: =If(ThisItem.FlowTaskName in ["招聘職位申請表","預備合約通知書(新入職)","假期批核人資料表"],DisplayMode.Edit,DisplayMode.Disabled)
                    Fill: =White
                    FocusedBorderThickness: =1
                    Height: =24
                    HoverBorderColor: =ColorFade(Self.BorderColor, -25%)
                    HoverColor: =ColorFade(Self.BorderColor, -25%)
                    Icon: =Icon.Copy
                    OnSelect: |-
                        =If(
                            ThisItem.FlowTaskName = "招聘職位申請表",
                            Launch(
                                JumpUrl & "&Screen=JobTitleCopyFormScreen&AppIds=" & LookUp(
                                    ApplitionJobPosition,
                                    ApprovalId = TaskListGallery.Selected.Approval_No
                                ).标题 & "&MasterflowId=" & TaskListGallery.Selected.Approval_No & "&resubmits=true&newApplicationGuid=" & GUID() & "&flowguid=" & GUID()&"&bustype=Edit",{},LaunchTarget.Replace
                            ),
                            ThisItem.FlowTaskName = "假期批核人資料表",
                            Launch(
                                JumpUrlA306A111 & "&Screen=VacationFormScreen&taskNum=" & LookUp(
                                    VacationApprovalForm,
                                    Applicant_No = TaskListGallery.Selected.Approval_No
                                ).标题 & "&approvalNum=" & TaskListGallery.Selected.Approval_No & "&resubmit=false&isCopy=true",{},LaunchTarget.Replace
                            ),
                            ThisItem.FlowTaskName = "預備合約通知書(新入職)",
                            Launch(
                                JumpUrl & "&Screen=ContractNoticeCopyForm&taskNum=" & LookUp(
                                    ContractNotice,
                                    ApprovalId = TaskListGallery.Selected.Approval_No
                                ).标题 & "&approvalNum=" & TaskListGallery.Selected.Approval_No & "&resubmits=true&newApplicationGuid=" & GUID() & "&flowguid=" & GUID()&"&bustype=Edit",{},LaunchTarget.Replace
                            )
                        )
                    PaddingBottom: =4
                    PaddingTop: =4
                    PressedBorderColor: =ColorFade(Self.BorderColor, -15%)
                    PressedColor: =ColorFade(Self.BorderColor, -15%)
                    PressedFill: =ColorFade(Self.Color, 95%)
                    Visible: |-
                        =//true
                        //If(ThisItem.FlowTaskName in ["招聘職位申請表","預備合約通知書(新入職)","自助假期批核資料表"],true,false)
                        If(ThisItem.FlowTaskName in ["招聘職位申請表","預備合約通知書(新入職)","假期批核人資料表"],true,false)
                    Width: =24
                    X: =1020
                    Y: =14
                    ZIndex: =11

                BtnDefaultIconOnly_6 As icon.Add:
                    BorderColor: =Self.Color
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =1
                    Color: =glbThemePrimaryColor
                    DisabledBorderColor: =RGBA(219, 219, 219, 1)
                    DisabledColor: =RGBA(149, 149, 149, 1)
                    DisabledFill: =RGBA(244, 244, 244, 1)
                    Fill: =White
                    FocusedBorderThickness: =1
                    Height: =24
                    HoverBorderColor: =ColorFade(Self.BorderColor, -25%)
                    HoverColor: =ColorFade(Self.BorderColor, -25%)
                    Icon: =Icon.Trash
                    OnSelect: |-
                        =UpdateContext({
                            DeletTask:true,
                            DeleteNum:ThisItem.Approval_No
                        })
                    PaddingBottom: =4
                    PaddingTop: =4
                    PressedBorderColor: =ColorFade(Self.BorderColor, -15%)
                    PressedColor: =ColorFade(Self.BorderColor, -15%)
                    PressedFill: =ColorFade(Self.Color, 95%)
                    Visible: |-
                        =//If(ThisItem.TaskStatus="001", true , false )
                        If(ThisItem.FlowTaskName in ["招聘職位申請表","預備合約通知書(新入職)","假期批核人資料表"] && 
                        //ThisItem.TaskStatus="001"
                        First(
                                SortByColumns(
                                    Filter(
                                        ApprovalDetail_Table,
                                        Approval_No = ThisItem.Approval_No
                                    ),
                                    "Priortty",
                                    Descending
                                )
                            ).TaskStatus = "001"
                        ,true,false)
                    Width: =24
                    X: =1046
                    Y: =14
                    ZIndex: =12

                Label3_8 As label:
                    Align: =Align.Center
                    Color: =glbNeutralSecondaryColor
                    Height: =48
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =10
                    Text: =If(CountA(Split(ThisItem.DepartMentName,"-").Result)=2,First(Split(ThisItem.DepartMentName,"-")).Result,First(Split(ThisItem.DepartMentName,"-")).Result&"-"&Index(Split(ThisItem.DepartMentName,"-"),2).Result)
                    Tooltip: =ThisItem.DepartMentName
                    Width: =123
                    Wrap: =false
                    X: =386
                    ZIndex: =13

                Label3_10 As label:
                    Align: =Align.Center
                    Color: =glbNeutralSecondaryColor
                    Height: =48
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =10
                    Text: |-
                        =First(Split(ThisItem.SubmitApprover,"@")).Result&Char(10)&Text(ThisItem.FlowCreateDate,"dd/mm/yyyy HH:mm")
                    Tooltip: =First(Split(ThisItem.SubmitApprover,"@")).Result
                    Width: =137
                    Wrap: =false
                    X: =509
                    ZIndex: =15

                Label3_12 As label:
                    Align: =Align.Center
                    Color: =glbNeutralSecondaryColor
                    Height: =48
                    OnSelect: =
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =12
                    Text: |-
                        =ThisItem.CustomerSearch
                        
                        /*
                        Switch(
                                ThisItem.TaskStatus,
                                "001",
                                "準備中",
                                "002",
                                "待批准",
                                "003",
                                "待執行",
                                "004",
                                "進行中",
                                "006",
                                "任務完成",
                                "000",
                                "已拒絕",
                                "進行中"
                            )
                        */
                    Tooltip: =ThisItem.CustomerSearch
                    Width: =200
                    Wrap: =false
                    X: =650
                    ZIndex: =17

                Icon5_3 As icon.ChevronRight:
                    Color: =glbThemePrimaryColor
                    Height: =24
                    HoverColor: =RGBA(102, 182, 227, 1)
                    HoverFill: =RGBA(0, 0, 0, 0)
                    Icon: =Icon.ChevronRight
                    OnSelect: |-
                        =If(
                            ThisItem.FlowTaskName = "招聘職位申請表",
                            If(
                                First(
                                    SortByColumns(
                                        Filter(
                                            ApprovalDetail_Table,
                                            Approval_No = ThisItem.Approval_No
                                        ),
                                        "Priortty",
                                        Descending
                                    )
                                ).TaskStatus = "001",
                                Launch(
                                    JumpUrl & "&Screen=JobTitleFormScreen&AppIds=" & LookUp(
                                        ApplitionJobPosition,
                                        ApprovalId = TaskListGallery.Selected.Approval_No
                                    ).标题 & "&MasterflowId=" & TaskListGallery.Selected.Approval_No & "&resubmit=true&bustype=edit"
                                ),
                                First(
                                    SortByColumns(
                                        Filter(
                                            ApprovalDetail_Table,
                                            Approval_No = ThisItem.Approval_No
                                        ),
                                        "Priortty",
                                        Descending
                                    )
                                ).TaskStatus = "002",
                                Launch(
                                    JumpUrl & "&Screen=JobTitleFormDetailScreen&AppIds=" & LookUp(
                                        ApplitionJobPosition,
                                        ApprovalId = TaskListGallery.Selected.Approval_No
                                    ).标题 & "&MasterflowId=" & TaskListGallery.Selected.Approval_No & "&resubmit=false&canOperation=true"
                                ),
                                Launch(
                                    JumpUrl & "&Screen=JobTitleFormDetailScreen&AppIds=" & LookUp(
                                        ApplitionJobPosition,
                                        ApprovalId = TaskListGallery.Selected.Approval_No
                                    ).标题 & "&MasterflowId=" & TaskListGallery.Selected.Approval_No & "&resubmit=false&canOperation=true"
                                )
                            ),
                            ThisItem.FlowTaskName = "假期批核人資料表",
                            If(
                                First(
                                    SortByColumns(
                                        Filter(
                                            ApprovalDetail_Table,
                                            Approval_No = ThisItem.Approval_No
                                        ),
                                        "Priortty",
                                        Descending
                                    )
                                ).TaskStatus = "001",
                                Launch(
                                    JumpUrlA306A111 & "&Screen=VacationFormScreen&taskNum=" & LookUp(
                                        VacationApprovalForm,
                                        Applicant_No = TaskListGallery.Selected.Approval_No
                                    ).标题 & "&approvalNum=" & TaskListGallery.Selected.Approval_No & "&resubmit=true&bustype=edit"
                                ),
                                First(
                                    SortByColumns(
                                        Filter(
                                            ApprovalDetail_Table,
                                            Approval_No = ThisItem.Approval_No
                                        ),
                                        "Priortty",
                                        Descending
                                    )
                                ).TaskStatus = "002",
                                Launch(
                                    JumpUrlA306A111 & "&Screen=VacationFormDetailScreen&taskNum=" & LookUp(
                                        VacationApprovalForm,
                                        Applicant_No = TaskListGallery.Selected.Approval_No
                                    ).标题 & "&approvalNum=" & TaskListGallery.Selected.Approval_No & "&resubmit=false&canOperation=true"
                                ),
                                Launch(
                                    JumpUrlA306A111 & "&Screen=VacationFormDetailScreen&taskNum=" & LookUp(
                                        VacationApprovalForm,
                                        Applicant_No = TaskListGallery.Selected.Approval_No
                                    ).标题 & "&approvalNum=" & TaskListGallery.Selected.Approval_No & "&resubmit=false&canOperation=true"
                                )
                            ),
                            ThisItem.FlowTaskName = "預備合約通知書(新入職)",
                            If(
                                First(
                                    SortByColumns(
                                        Filter(
                                            ApprovalDetail_Table,
                                            Approval_No = ThisItem.Approval_No
                                        ),
                                        "Priortty",
                                        Descending
                                    )
                                ).TaskStatus = "001",
                                Launch(
                                    JumpUrl & "&Screen=ContractNoticeForm&taskNum=" & LookUp(
                                        ContractNotice,
                                        ApprovalId = TaskListGallery.Selected.Approval_No
                                    ).标题 & "&approvalNum=" & TaskListGallery.Selected.Approval_No & "&resubmit=true&bustype=edit"
                                ),
                                First(
                                    SortByColumns(
                                        Filter(
                                            ApprovalDetail_Table,
                                            Approval_No = ThisItem.Approval_No
                                        ),
                                        "Priortty",
                                        Descending
                                    )
                                ).TaskStatus = "002",
                                Launch(
                                    JumpUrl & "&Screen=ContractNoticeFormDetail&taskNum=" & LookUp(
                                        ContractNotice,
                                        ApprovalId = TaskListGallery.Selected.Approval_No
                                    ).标题 & "&approvalNum=" & TaskListGallery.Selected.Approval_No & "&resubmit=false&canOperation=true"
                                ),
                                Launch(
                                    JumpUrl & "&Screen=ContractNoticeFormDetail&taskNum=" & LookUp(
                                        ContractNotice,
                                        ApprovalId = TaskListGallery.Selected.Approval_No
                                    ).标题 & "&approvalNum=" & TaskListGallery.Selected.Approval_No & "&resubmit=false&canOperation=true"
                                )
                            ),
                            ThisItem.FlowTaskName = "任職資源申請",
                            If(
                                First(
                                    SortByColumns(
                                        Filter(
                                            ApprovalDetail_Table,
                                            Approval_No = ThisItem.Approval_No
                                        ),
                                        "Priortty",
                                        Descending
                                    )
                                ).TaskStatus = "001",
                                Launch(
                                    JumpUrlA306A111 & "&Screen=EmploymentFormScreen&taskNum=" & LookUp(
                                        EmploymentResource,
                                        ApprovalId = TaskListGallery.Selected.Approval_No
                                    ).标题 & "&approvalNum=" & TaskListGallery.Selected.Approval_No & "&resubmit=true&bustype=edit"
                                ),
                                Launch(
                                    JumpUrlA306A111 & "&Screen=EmploymentFormDetail&taskNum=" & LookUp(
                                        EmploymentResource,
                                        ApprovalId = TaskListGallery.Selected.Approval_No
                                    ).标题 & "&approvalNum=" & TaskListGallery.Selected.Approval_No & "&resubmit=false&canOperation=true"
                                )
                            ),
                            With(
                                {
                                    FormId: LookUp(
                                        GenericFormList,
                                        ApprovalId = ThisItem.Approval_No
                                    ).标题
                                },
                                Launch(
                                    JumpUrlMobileApp & "&Screen=DetailGeneralFormScreen&FormId=" & FormId & "&FLowId=" & TaskListGallery.Selected.Approval_No & "&Page=Home",
                                    {},
                                    LaunchTarget.Replace
                                )
                            )
                        )
                    PaddingBottom: =3
                    PaddingTop: =3
                    Width: =24
                    X: =995
                    Y: =14
                    ZIndex: =19

    Container3_7 As groupContainer.manualLayoutContainer:
        Fill: =RGBA(255, 255, 255, 1)
        Height: =768
        Width: =240
        ZIndex: =2

        GalleryNav_15 As gallery.galleryVertical:
            Height: =327
            Items: |
                =Filter(If(
                    CurrentRoleFormModelPermssion = "None"
                    ,
                    [
                        "首頁",
                        "申請記錄",
                        If(CurrentRole,"數據統計",CurrentRole || HRAO || SuperUser,"系統設定"),
                        If(If(CurrentRole,"數據統計",CurrentRole || HRAO || SuperUser,"系統設定")="系統設定",Blank(),CurrentRole || HRAO || SuperUser,"系統設定")
                        
                    ],
                    [
                        "首頁",
                        "表格資料",
                        "申請記錄",
                        If(CurrentRole,"數據統計",CurrentRole || HRAO || SuperUser,"系統設定"),
                        If(If(CurrentRole,"數據統計",CurrentRole || HRAO || SuperUser,"系統設定")="系統設定",Blank(),CurrentRole || HRAO || SuperUser,"系統設定")
                    ]
                ),ThisRecord.Value <> Blank())
            Layout: =Layout.Vertical
            OnSelect: =
            TemplateFill: =If(ThisItem.Value="申請記錄", RGBA(102,182,227,0.2),Transparent)
            TemplatePadding: =0
            TemplateSize: =46
            Width: =240
            Y: =100
            ZIndex: =1

            BtnDefault_12 As button:
                Align: =Align.Left
                BorderColor: =RGBA(255, 255, 255, 1)
                BorderThickness: =0
                Color: =If(ThisItem.Value="申請記錄", glbThemePrimaryColor,glbNeutralSecondaryColor)
                DisabledBorderColor: =
                Fill: =If(ThisItem.Value="申請記錄", ColorFade(Self.Color, 90%),White)
                FocusedBorderThickness: =1
                FontWeight: =If(ThisItem.Value="申請記錄", FontWeight.Semibold,Normal)
                Height: =46
                HoverBorderColor: =
                HoverColor: =ColorFade(Self.Color, -15%)
                HoverFill: =If(ThisItem.Value<>Blank(),ColorFade(glbThemePrimaryColor, 90%))
                OnSelect: |-
                    =If(
                        ThisItem.Value = "首頁",
                        Navigate(
                            HomepageScreen,
                            ScreenTransition.None
                        ),
                        ThisItem.Value = "表格資料",
                        Navigate(AdminFormListScreen,
                            ScreenTransition.None
                        ),
                        ThisItem.Value = "數據統計",
                        Navigate(StatisticsScreen,
                            ScreenTransition.None
                        //Launch("https://apps.powerapps.com/play/c030168f-5133-4c9d-8e17-3c870ba99ab4?tenantId=b7a4bbdd-6e9c-4929-b5a4-6550feead77c&Screen=StatisticsScreen"
                        ),
                    
                        ThisItem.Value = "系統設定",
                        Navigate(SystemsScreen,None,{ToUserInfoManager:"用戶管理"}),
                        //Launch("https://apps.powerapps.com/play/c030168f-5133-4c9d-8e17-3c870ba99ab4?tenantId=b7a4bbdd-6e9c-4929-b5a4-6550feead77c&Screen=UserScreen"),
                    
                        ThisItem.Value = "申請記錄",
                        Navigate(
                            GeneralFormListScreen,
                            ScreenTransition.None,{ListID:1}
                        )
                    )
                PaddingBottom: =0
                PaddingLeft: =104
                PaddingRight: =0
                PaddingTop: =0
                PressedBorderColor: =
                PressedColor: =ColorFade(Self.Color, -25%)
                PressedFill: =
                RadiusBottomLeft: =4
                RadiusBottomRight: =4
                RadiusTopLeft: =4
                RadiusTopRight: =4
                Size: =12
                Text: =ThisItem.Value
                Width: =240
                ZIndex: =1

            Image2_7 As image:
                Height: =30
                Image: |
                    =If(
                        ThisItem.Value = "首頁",
                        首页,
                        ThisItem.Value = "表格資料",
                        表格资料,
                        ThisItem.Value = "數據統計",
                        数据,
                        ThisItem.Value = "系統設定",
                        设置,
                        ThisItem.Value = "申請記錄",
                        申请列表
                    )
                OnSelect: =Select(Parent)
                Width: =30
                X: =60
                Y: =10
                ZIndex: =2

        GalleryNav_16 As gallery.galleryVertical:
            Height: =60
            Items: =["IT服務台","用戶手冊","意見收集"]
            Layout: =Layout.Vertical
            TemplatePadding: =0
            TemplateSize: =60
            Width: =240
            WrapCount: =3
            Y: =690
            ZIndex: =5

            Image2_8 As image:
                Height: =26
                Image: |
                    =If(
                        ThisItem.Value = "IT服務台",
                        工作台,
                        ThisItem.Value = "用戶手冊",
                        手册,
                        ThisItem.Value = "意見收集",
                        意见箱
                    )
                OnSelect: =Select(Parent)
                Width: =26
                X: =27
                Y: =6
                ZIndex: =1

            BtnDefault_14 As button:
                BorderColor: =Self.Color
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =glbNeutralSecondaryColor
                DisabledBorderColor: =RGBA(219, 219, 219, 1)
                DisabledFill: =RGBA(0, 0, 0, 0)
                Fill: =RGBA(0, 0, 0, 0)
                FocusedBorderThickness: =1
                FontWeight: =Normal
                Height: =60
                HoverBorderColor: =ColorFade(Self.Color, -15%)
                HoverColor: =ColorFade(Self.Color, -15%)
                HoverFill: =
                OnSelect: |-
                    =If(
                        ThisItem.Value = "意見箱",
                        Launch("https://forms.office.com/Pages/ResponsePage.aspx?id=3bukt5xuKUm1pGVQ_urXfI59VMuh5BdPgBsZQOZA1aFUNVFDTEVCTkU1OTZEWE1HUUExTkNEVlJBNSQlQCN0PWcu"),
                        ThisItem.Value = "IT服務台",
                        Launch("https://elcss-14cebfd770be55.sharepoint.com/sites/elcssbriefcase/HelpDeskPlus/Pages/Default.aspx?SPHostUrl=https%3A%2F%2Felcss%2Esharepoint%2Ecom%2Fsites%2Felcssbriefcase&SPLanguage=en%2DUS&SPClientTag=1&SPProductNumber=16%2E0%2E22112%2E12002&SPAppWebUrl=https%3A%2F%2Felcss%2D14cebfd770be55%2Esharepoint%2Ecom%2Fsites%2Felcssbriefcase%2FHelpDeskPlus"),
                        ThisItem.Value = "用戶手冊",
                        Download("https://elcss.sharepoint.com/:w:/r/sites/eps-prd/_layouts/15/download.aspx?SourceUrl=/sites/eps-prd/TempExcel/ePS%E7%B3%BB%E7%B5%B1-%E7%94%A8%E6%88%B6%E6%89%8B%E5%86%8A%20V1.3.4.pdf")
                    )
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =34
                PressedBorderColor: =ColorFade(Self.Color, -25%)
                PressedColor: =ColorFade(Self.Color, -25%)
                PressedFill: =
                RadiusBottomLeft: =4
                RadiusBottomRight: =4
                RadiusTopLeft: =4
                RadiusTopRight: =4
                Size: =9
                Text: =ThisItem.Value
                Width: =70
                X: =5
                ZIndex: =2

        Label8_6 As label:
            Color: =RGBA(149, 149, 149, 1)
            Height: =20
            Italic: =true
            Size: =8
            Text: ="Version 1.0.0"
            Width: =160
            X: =64
            Y: =56
            ZIndex: =6

        Image8_2 As image:
            Height: =40
            Image: =logo_only_icon
            Width: =40
            X: =20
            Y: =10
            ZIndex: =7

        Label1_99 As label:
            Color: =RGBA(54, 52, 52, 1)
            Height: =21
            Size: =12
            Text: ="ELCSS-HK"
            Width: =100
            X: =64
            Y: =10
            ZIndex: =9

        Label1_100 As label:
            Color: =RGBA(116, 116, 116, 1)
            Height: =21
            Size: =7
            Text: ="eProcessing System (ePS)"
            Width: =160
            X: =64
            Y: =31
            ZIndex: =10

    DeleteTask_1 As groupContainer.manualLayoutContainer:
        Fill: =RGBA(0, 0, 0, 0.3)
        Height: =768
        Visible: =DeletTask
        Width: =1366
        ZIndex: =3

        Button1_8 As button:
            BorderStyle: =BorderStyle.None
            Fill: =RGBA(255, 255, 255, 1)
            Height: =161
            HoverFill: =RGBA(255, 255, 255, 1)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =RGBA(255, 255, 255, 1)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Text: ="按钮"
            Width: =392
            X: =510
            Y: =295
            ZIndex: =1

        Label32_2 As label:
            Color: =RGBA(246, 88, 16, 1)
            Height: =56
            Text: ="確認刪除該條數據！"
            Width: =187
            X: =658
            Y: =315
            ZIndex: =2

        Icon7_2 As icon.Information:
            Color: =RGBA(246, 88, 16, 1)
            Height: =26
            Icon: =Icon.Information
            Width: =40
            X: =618
            Y: =330
            ZIndex: =3

        Button2_7 As button:
            Color: =RGBA(0, 134, 208, 1)
            Fill: =RGBA(255, 255, 255, 1)
            FontWeight: =FontWeight.Normal
            Height: =36
            HoverColor: =RGBA(0, 134, 208, 1)
            HoverFill: =RGBA(255, 255, 255, 1)
            OnSelect: |-
                =UpdateContext({DeletTask:false})
            PressedColor: =RGBA(0, 134, 208, 1)
            PressedFill: =RGBA(255, 255, 255, 1)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =12
            Text: ="取消"
            Width: =120
            X: =575
            Y: =390
            ZIndex: =4

        Button3_4 As button:
            BorderColor: =RGBA(230, 230, 230, 1)
            BorderStyle: =BorderStyle.None
            Fill: =RGBA(0, 134, 208, 1)
            FontWeight: =FontWeight.Normal
            Height: =36
            HoverFill: =RGBA(8, 127, 190, 1)
            OnSelect: |-
                =If(
                    LookUp(
                        Approval_Table,
                        标题 = DeleteNum
                    ).Task_Name = "招聘職位申請表",
                    RemoveIf(
                        IncomeAccount,
                        Application_No = LookUp(
                            ApplitionJobPosition,
                            ApprovalId = DeleteNum
                        ).标题
                    );
                    RemoveIf(
                        UploadFile,
                        ApplicationId = LookUp(
                            ApplitionJobPosition,
                            ApprovalId = DeleteNum
                        ).标题
                    );
                    RemoveIf(
                        ApplitionJobPosition,
                        ApprovalId = DeleteNum
                    );
                    RemoveIf(
                        ApprovalDetail_Table,
                        Approval_No = DeleteNum
                    );
                    RemoveIf(
                        Approval_Table,
                        标题 = DeleteNum
                    ),
                    If(
                        LookUp(
                            Approval_Table,
                            标题 = DeleteNum
                        ).Task_Name = "假期批核人資料表",
                        RemoveIf(
                            VacationApprovalForm,
                            Application_No = DeleteNum
                        );
                        RemoveIf(
                            ApprovalDetail_Table,
                            Approval_No = DeleteNum
                        );
                        RemoveIf(
                            Approval_Table,
                            标题 = DeleteNum
                        ),
                        //删除1b相关表数据
                        RemoveIf(
                            IncomeAccount,
                            Application_No = LookUp(
                                ContractNotice,
                                ApprovalId = DeleteNum
                            ).标题
                        );
                        RemoveIf(
                            AllowanceInformation,
                            Application_No = LookUp(
                                ContractNotice,
                                ApprovalId = DeleteNum
                            ).标题
                        );
                        RemoveIf(
                            UploadFile,
                            ApplicationId = LookUp(
                                ContractNotice,
                                ApprovalId = DeleteNum
                            ).标题
                        );
                        RemoveIf(
                            VacationApprovalForm,
                            Applicant_No = LookUp(
                                ContractNotice,
                                ApprovalId = DeleteNum
                            ).标题
                        );
                        RemoveIf(
                            ContractNotice,
                            ApprovalId = DeleteNum
                        );
                        RemoveIf(
                            ApprovalDetail_Table,
                            Approval_No = DeleteNum
                        );
                        RemoveIf(
                            Approval_Table,
                            标题 = DeleteNum
                        )
                    )
                );
                Select(uploadButton_1);
                UpdateContext({DeletTask: false });
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =RGBA(255, 255, 255, 1)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =12
            Text: ="確認"
            Width: =120
            X: =720
            Y: =390
            ZIndex: =5

    uploadButton_1 As button:
        OnSelect: |
            =//生成待处理集合
            ClearCollect(
                ApprovalDetailCol,
                Filter(
                    ShowColumns(
                        ApprovalDetail_Table,
                        "Title",
                        "Approval_No",
                        "Approver",
                        "ApproverEmail",
                        "Priortty",
                        "TaskStatus",
                        "AgentUserEmail",
                        "ActionNode"
                    ),
                    CurrentUser in ApproverEmail && (TaskStatus = "001" || TaskStatus = "002")
                )
            );
            //生成已处理集合
            ClearCollect(
                ProcessedDetailCol,
                Filter(
                    ShowColumns(
                        ApprovalDetail_Table,
                        "Title",
                        "Approval_No",
                        "Approver",
                        "ApproverEmail",
                        "Priortty",
                        "TaskStatus",
                        "Editor",
                        "AgentUserEmail",
                        "ActionNode"
                    ),
                    CurrentUser in ApproverEmail && (TaskStatus = "004" || TaskStatus = "006" || TaskStatus = "000")
                )
            );
            //全部集合
            ClearCollect(
                ComplatelDetailCol,
                Filter(
                    ShowColumns(
                        ApprovalDetail_Table,
                        "Title",
                        "Approval_No",
                        "Approver",
                        "ApproverEmail",
                        "Priortty",
                        "TaskStatus",
                        "Editor",
                        "AgentUserEmail",
                        "ActionNode"
                    ),
                    CurrentUser in ApproverEmail && (TaskStatus = "000" || TaskStatus = "001" || TaskStatus = "004" || TaskStatus = "006" || TaskStatus = "002" || TaskStatus = "005")
                )
            );
            //生成带部门和任务名称字段的ApprovalDetail_Table待處理任务
            ClearCollect(
                ApprovalDetailColwithdepartment,
                AddColumns(
                    Filter(
                    ShowColumns(
                        ApprovalDetail_Table,
                        "Title",
                        "Approval_No",
                        "Approver",
                        "ApproverEmail",
                        "Priortty",
                        "TaskStatus",
                        "AgentUserEmail",
                        "ActionNode"
                    ),
                    TaskStatus = "001" || TaskStatus = "002"
                ),
                    "DepartMentName",
                    LookUp(
                        Approval_Table,
                        标题 = Approval_No
                    ).DepartMentUnit,
                    "FormDepartMentName",
                    LookUp(
                        Approval_Table,
                        标题 = Approval_No
                    ).DepartMentName,
                    "TaskName",
                    LookUp(
                        Approval_Table,
                        标题 = Approval_No
                    ).Task_Name    
                )
            );
            //過濾一期待處理認爲
            ClearCollect(
                ApprovalDetailColwithPhase1,
                Filter(ApprovalDetailColwithdepartment,
                TaskName = "任職資源申請" || TaskName = "招聘職位申請表" || TaskName = "假期批核人資料表" || TaskName = "預備合約通知書(新入職)"
                )
            );
            //過濾二期待處理認爲
            ClearCollect(
                ApprovalDetailColwithPhase2,
                Filter(ApprovalDetailColwithdepartment,
                TaskName <> "任職資源申請" && TaskName <> "招聘職位申請表" && TaskName <> "假期批核人資料表" && TaskName <> "預備合約通知書(新入職)"
                )
            );
            //生成待处理集合，新增Ismanger判断
            With(
                {
                    SearchPendingData: If(
                        CurrentRoleTaskPermission = "NoManger",
                        Filter(
                            ApprovalDetailCol,
                            1 = 1
                        ),
                        ClearCollect(NewApprovalTable,ApprovalDetailColwithPhase1,
                        Filter(
                            ApprovalDetailColwithPhase2,
                            CurrentUser in ApproverEmail || CurrentRoleTaskPermission in DepartMentName || CurrentRoleTaskPermissionForm in FormDepartMentName
                        )
                    ))
                },
                ClearCollect(
                    FilterPendingDataCol,
                    AddColumns(
                        GroupBy(
                            SearchPendingData,
                            "Approval_No",
                            "Data1"
                        ),
                        "TaskStatus",
                        LookUp(
                            SearchPendingData,
                            Approval_No = Approval_No
                        ).TaskStatus,
                        "FlowTaskName",
                        LookUp(
                            Approval_Table,
                            标题 = Approval_No
                        ).Task_Name,
                        "FlowOrder",
                        LookUp(
                            Approval_Table,
                            标题 = Approval_No
                        ).Application_No,
                        "SubmitApprover",
                        LookUp(
                            Approval_Table,
                            标题 = Approval_No
                        ).'Operator ',
                        "FlowCreateDate",
                        LookUp(
                            Approval_Table,
                            标题 = Approval_No
                        ).创建时间,
                        "DepartMentName",
                        LookUp(
                            Approval_Table,
                            标题 = Approval_No
                        ).DepartMentUnit,
                        "FormType",
                        LookUp(
                            Approval_Table,
                            标题 = Approval_No
                        ).FormType,
                        "Application_Status",
                        LookUp(
                            Approval_Table,
                            标题 = Approval_No
                        ).Application_Status,
                        "CustomerSearch",
                        LookUp(
                            GenericFormList,
                            ApprovalId = Approval_No
                        ).FilterLabel,
                        "ActionNode",
                        LookUp(
                            SearchPendingData,
                            Approval_No = Approval_No
                        ).ActionNode
                    )
                )
            );
            //生成带部门和任務名稱字段的ApprovalDetail_Table已处理任务
            ClearCollect(
                ProcessedDetailColwithdepartment,
                AddColumns(
                    ProcessedDetailCol,
                    "DepartMentName",
                    LookUp(
                        Approval_Table,
                        标题 = Approval_No
                    ).DepartMentUnit,
                    "FormDepartMentName",
                    LookUp(
                        Approval_Table,
                        标题 = Approval_No
                    ).DepartMentName,
                    "TaskName",
                    LookUp(
                        Approval_Table,
                        标题 = Approval_No
                    ).Task_Name
                )
            );
            /*
            //過濾一期已处理認爲
            ClearCollect(
                ProcessedDetailColwithPhase1,
                Filter(ProcessedDetailColwithdepartment,
                TaskName = "任職資源申請" || TaskName = "招聘職位申請表" || TaskName = "假期批核人資料表" || TaskName = "預備合約通知書(新入職)"
                )
            );
            //過濾二期已处理認爲
            ClearCollect(
                ProcessedDetailColwithPhase2,
                Filter(ProcessedDetailColwithdepartment,
                TaskName <> "任職資源申請" && TaskName <> "招聘職位申請表" && TaskName <> "假期批核人資料表" && TaskName <> "預備合約通知書(新入職)"
                )
            );
            */
            //生成已处理集合，新增Ismanger判断
            With(
                {
                    ProcessedListCol: If(
                        CurrentRoleTaskPermission = "NoManger",
                        Filter(
                            ProcessedDetailCol,
                            1 = 1
                        ),
                        Filter(
                            ProcessedDetailCol,
                            1 = 1
                            //ProcessedDetailColwithdepartment,
                            //CurrentRoleTaskPermission in DepartMentName || CurrentRoleTaskPermissionForm in FormDepartMentName
                        )
                    )
                },
                ClearCollect(
                    inprogressData,
                    AddColumns(
                        GroupBy(
                            ProcessedListCol,
                            "Approval_No",
                            "Data"
                        ),
                        "TaskStatus",
                        LookUp(
                            ProcessedListCol,
                            Approval_No = Approval_No
                        ).TaskStatus,
                        "FlowTaskName",
                        LookUp(
                            Approval_Table,
                            标题 = Approval_No
                        ).Task_Name,
                        "FlowOrder",
                        LookUp(
                            Approval_Table,
                            标题 = Approval_No
                        ).Application_No,
                        "SubmitApprover",
                        LookUp(
                            Approval_Table,
                            标题 = Approval_No
                        ).'Operator ',
                        "FlowCreateDate",
                        LookUp(
                            Approval_Table,
                            标题 = Approval_No
                        ).创建时间,
                        "DepartMentName",
                        LookUp(
                            Approval_Table,
                            标题 = Approval_No
                        ).DepartMentUnit,
                        "FormType",
                        LookUp(
                            Approval_Table,
                            标题 = Approval_No
                        ).FormType,
                        "Application_Status",
                        LookUp(
                            Approval_Table,
                            标题 = Approval_No
                        ).Application_Status,
                        "CustomerSearch",
                        LookUp(
                            GenericFormList,
                            ApprovalId = Approval_No
                        ).FilterLabel
                    )
                )
            );
            //生成带部门和任務名稱字段的ApprovalDetail_Table全部任务
            ClearCollect(
                ComplatelDetailColwithdepartment,
                AddColumns(
                    Filter(
                    ShowColumns(
                        ApprovalDetail_Table,
                        "Title",
                        "Approval_No",
                        "Approver",
                        "ApproverEmail",
                        "Priortty",
                        "TaskStatus",
                        "Editor",
                        "AgentUserEmail",
                        "ActionNode"
                    ),
                    TaskStatus = "000" || TaskStatus = "001" || TaskStatus = "004" || TaskStatus = "006" || TaskStatus = "002" || TaskStatus = "005"
                ),
                    "DepartMentName",
                    LookUp(
                        Approval_Table,
                        标题 = Approval_No
                    ).DepartMentUnit,
                    "FormDepartMentName",
                    LookUp(
                        Approval_Table,
                        标题 = Approval_No
                    ).DepartMentName,
                    "TaskName",
                    LookUp(
                        Approval_Table,
                        标题 = Approval_No
                    ).Task_Name
                )
            );
            //過濾一期全部認爲
            ClearCollect(
                AllDetailColwithPhase1,
                Filter(ComplatelDetailColwithdepartment,
                TaskName = "任職資源申請" || TaskName = "招聘職位申請表" || TaskName = "假期批核人資料表" || TaskName = "預備合約通知書(新入職)"
                )
            );
            //過濾二期全部認爲
            ClearCollect(
                AllDetailColwithPhase2,
                Filter(ComplatelDetailColwithdepartment,
                TaskName <> "任職資源申請" && TaskName <> "招聘職位申請表" && TaskName <> "假期批核人資料表" && TaskName <> "預備合約通知書(新入職)"
                )
            );
            //生成所有集合，新增Ismanger判断
            With(
                {
                    AllApprovalList: If(
                        CurrentRoleTaskPermission = "NoManger",
                        Filter(
                            ComplatelDetailCol,
                            TaskStatus <> Blank()
                        ),
                        ClearCollect(AllTaskTable,AllDetailColwithPhase1,
                        Filter(
                            AllDetailColwithPhase2,
                            TaskStatus <> Blank() && (CurrentUser in ApproverEmail || CurrentRoleTaskPermission in DepartMentName || CurrentRoleTaskPermissionForm in FormDepartMentName)
                        )
                    ))
                },
                ClearCollect(
                    AllApprovalListDataCol,
                    AddColumns(
                        GroupBy(
                            AllApprovalList,
                            "Approval_No",
                            "Data"
                        ),
                        "TaskStatus",
                        LookUp(
                            AllApprovalList,
                            Approval_No = Approval_No
                        ).TaskStatus,
                        "FlowTaskName",
                        LookUp(
                            Approval_Table,
                            标题 = Approval_No
                        ).Task_Name,
                        "FlowOrder",
                        LookUp(
                            Approval_Table,
                            标题 = Approval_No
                        ).Application_No,
                        "FlowCreateDate",
                        LookUp(
                            Approval_Table,
                            标题 = Approval_No
                        ).创建时间,
                        "SubmitApprover",
                        LookUp(
                            Approval_Table,
                            标题 = Approval_No
                        ).'Operator ',
                        "DepartMentName",
                        LookUp(
                            Approval_Table,
                            标题 = Approval_No
                        ).DepartMentUnit,
                        "FormType",
                        LookUp(
                            Approval_Table,
                            标题 = Approval_No
                        ).FormType,
                        "Application_Status",
                        LookUp(
                            Approval_Table,
                            标题 = Approval_No
                        ).Application_Status,
                        "CustomerSearch",
                        LookUp(
                            GenericFormList,
                            ApprovalId = Approval_No
                        ).FilterLabel
                    )
                )
            );
            Select(BtnSecondIconOnly_4);
        Text: ="LoadData"
        Visible: =false
        X: =723
        Y: =23
        ZIndex: =4


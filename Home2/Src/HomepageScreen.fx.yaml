HomepageScreen As screen:
    Fill: =RGBA(243, 243, 243, 1)
    OnVisible: |-
        =ClearCollect(approvalCol,Approval_Table);ClearCollect(ApprovalDetailData,ApprovalDetail_Table);
        // 优先处理
        With({XXX11:Filter(ApprovalDetailData,(CurrentUser in ApproverEmail||CurrentUser in AgentUserEmail)&&TaskStatus<>Blank()&&(TaskStatus="002"||TaskStatus="001")&&DateDiff(修改时间,Today())>3)},ClearCollect(Priority_Processing,XXX11));
        // 待处理
        With({SearchPendingData:Filter(ApprovalDetailData,(CurrentUser in ApproverEmail||CurrentUser<>Blank()&&CurrentUser in AgentUserEmail)&&(TaskStatus="001"||TaskStatus="002"))},ClearCollect(FilterPendingDataCol,SearchPendingData));
        
        ClearCollect(DataModelName,GenericFormModel);
        Patch(DataModelName,Defaults(DataModelName),{ModelName:"招聘職位申請表",ModelDescription:"招聘表格",ModelFlowNumber:"A103",ModelDepartment:"行政部"});
        Patch(DataModelName,Defaults(DataModelName),{ModelName:"假期批核人資料表",ModelDescription:"假期表格",ModelFlowNumber:"A306",ModelDepartment:"行政部"});
        Patch(DataModelName,Defaults(DataModelName),{ModelName:"任職資源申請",ModelDescription:"IT財務指引表格",ModelFlowNumber:"A111",ModelDepartment:"行政部"});
        Patch(DataModelName,Defaults(DataModelName),{ModelName:"預備合約通知書(新入職)",ModelDescription:"預備合約表格",ModelFlowNumber:"A104",ModelDepartment:"行政部"});
        
        //創建首頁部門集合
        /*
        ClearCollect(FormTable3,FormTableType);
        Patch(FormTable3,Defaults(FormTable3),{
        DepartMentName:"常用表格",
        ID:0
        });
        ClearCollect(FormTable2,SortByColumns(FormTable3,"ID",Ascending));
        ClearCollect(FormTable4,Distinct(FormTable2,DepartMentName));
        */
        Reset(TextInput2_15);

    Container3_3 As groupContainer.manualLayoutContainer:
        Fill: =RGBA(255, 255, 255, 1)
        Height: =768
        Width: =240
        ZIndex: =1

        GalleryNav_3 As gallery.galleryVertical:
            Height: =327
            Items: |
                =Filter(If(
                    CurrentRoleFormModelPermssion = "None"
                    ,
                    [
                        "首頁",
                        "申請記錄",
                        If(CurrentRole,"數據統計",CurrentRole || HRAO || SuperUser,"系統設定"),
                        If(If(CurrentRole,"數據統計",CurrentRole || HRAO || SuperUser,"系統設定")="系統設定",Blank(),CurrentRole || HRAO || SuperUser,"系統設定")
                        
                    ],
                    [
                        "首頁",
                        "表格資料",
                        "申請記錄",
                        If(CurrentRole,"數據統計",CurrentRole || HRAO || SuperUser,"系統設定"),
                        If(If(CurrentRole,"數據統計",CurrentRole || HRAO || SuperUser,"系統設定")="系統設定",Blank(),CurrentRole || HRAO || SuperUser,"系統設定")
                    ]
                ),ThisRecord.Value <> Blank())
            Layout: =Layout.Vertical
            OnSelect: =
            TemplateFill: =If(ThisItem.Value="首頁", RGBA(102,182,227,0.2),Transparent)
            TemplatePadding: =0
            TemplateSize: =46
            Width: =240
            Y: =100
            ZIndex: =1

            BtnDefault_9 As button:
                Align: =Align.Left
                BorderColor: =Self.Color
                BorderStyle: =BorderStyle.None
                BorderThickness: =0
                Color: =If(ThisItem.Value="首頁", glbThemePrimaryColor,glbNeutralSecondaryColor)
                DisabledBorderColor: =RGBA(219, 219, 219, 1)
                Fill: =If(ThisItem.Value="首頁", ColorFade(Self.Color, 90%),White)
                FocusedBorderThickness: =1
                FontWeight: =If(ThisItem.Value="首頁", FontWeight.Semibold,Normal)
                Height: =46
                HoverBorderColor: =ColorFade(Self.Color, -15%)
                HoverColor: =ColorFade(Self.Color, -15%)
                HoverFill: =If(ThisItem.Value<>Blank(),ColorFade(glbThemePrimaryColor, 90%))
                OnSelect: |-
                    =If(
                        ThisItem.Value = "首頁",
                        Navigate(
                            HomepageScreen,
                            ScreenTransition.None
                        ),
                        ThisItem.Value = "表格資料",
                        Navigate(AdminFormListScreen,
                            ScreenTransition.None
                        ),
                        ThisItem.Value = "數據統計",
                        Navigate(StatisticsScreen,
                            ScreenTransition.None
                        //Launch("https://apps.powerapps.com/play/c030168f-5133-4c9d-8e17-3c870ba99ab4?tenantId=b7a4bbdd-6e9c-4929-b5a4-6550feead77c&Screen=StatisticsScreen"
                        ),
                    
                        ThisItem.Value = "系統設定",
                        Navigate(SystemsScreen,None,{ToUserInfoManager:"用戶管理"}),
                        //Launch("https://apps.powerapps.com/play/c030168f-5133-4c9d-8e17-3c870ba99ab4?tenantId=b7a4bbdd-6e9c-4929-b5a4-6550feead77c&Screen=UserScreen"),
                    
                        ThisItem.Value = "申請記錄",
                        Navigate(
                            GeneralFormListScreen,
                            ScreenTransition.None
                        )
                    )
                PaddingBottom: =0
                PaddingLeft: =104
                PaddingRight: =0
                PaddingTop: =0
                PressedBorderColor: =ColorFade(Self.Color, -25%)
                PressedColor: =ColorFade(Self.Color, -25%)
                PressedFill: =
                RadiusBottomLeft: =4
                RadiusBottomRight: =4
                RadiusTopLeft: =4
                RadiusTopRight: =4
                Size: =12
                Text: =ThisItem.Value
                Width: =240
                ZIndex: =1

            Image2 As image:
                Height: =30
                Image: |
                    =If(
                        ThisItem.Value = "首頁",
                        首页,
                        ThisItem.Value = "表格資料",
                        表格资料,
                        ThisItem.Value = "數據統計",
                        数据,
                        ThisItem.Value = "系統設定",
                        设置,
                        ThisItem.Value = "申請記錄",
                        申请列表
                    )
                OnSelect: =Select(Parent)
                Width: =30
                X: =60
                Y: =10
                ZIndex: =2

        GalleryNav_5 As gallery.galleryVertical:
            Height: =60
            Items: =["IT服務台","用戶手冊","意見收集"]
            Layout: =Layout.Vertical
            TemplatePadding: =0
            TemplateSize: =60
            Width: =240
            WrapCount: =3
            Y: =690
            ZIndex: =5

            Image2_4 As image:
                Height: =26
                Image: |
                    =If(
                        ThisItem.Value = "IT服務台",
                        工作台,
                        ThisItem.Value = "用戶手冊",
                        手册,
                        ThisItem.Value = "意見收集",
                        意见箱
                    )
                OnSelect: =Select(Parent)
                Width: =26
                X: =27
                Y: =6
                ZIndex: =1

            BtnDefault_11 As button:
                BorderColor: =Self.Color
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =glbNeutralSecondaryColor
                DisabledBorderColor: =RGBA(219, 219, 219, 1)
                DisabledFill: =RGBA(0, 0, 0, 0)
                Fill: =RGBA(0, 0, 0, 0)
                FocusedBorderThickness: =1
                FontWeight: =Normal
                Height: =60
                HoverBorderColor: =ColorFade(Self.Color, -15%)
                HoverColor: =ColorFade(Self.Color, -15%)
                HoverFill: =
                OnSelect: |-
                    =If(
                        ThisItem.Value = "意見箱",
                        Launch("https://forms.office.com/Pages/ResponsePage.aspx?id=3bukt5xuKUm1pGVQ_urXfI59VMuh5BdPgBsZQOZA1aFUNVFDTEVCTkU1OTZEWE1HUUExTkNEVlJBNSQlQCN0PWcu"),
                        ThisItem.Value = "IT服務台",
                        Launch("https://elcss-14cebfd770be55.sharepoint.com/sites/elcssbriefcase/HelpDeskPlus/Pages/Default.aspx?SPHostUrl=https%3A%2F%2Felcss%2Esharepoint%2Ecom%2Fsites%2Felcssbriefcase&SPLanguage=en%2DUS&SPClientTag=1&SPProductNumber=16%2E0%2E22112%2E12002&SPAppWebUrl=https%3A%2F%2Felcss%2D14cebfd770be55%2Esharepoint%2Ecom%2Fsites%2Felcssbriefcase%2FHelpDeskPlus"),
                        ThisItem.Value = "用戶手冊",
                        Download("https://elcss.sharepoint.com/:w:/r/sites/eps-prd/_layouts/15/download.aspx?SourceUrl=/sites/eps-prd/TempExcel/ePS%E7%B3%BB%E7%B5%B1-%E7%94%A8%E6%88%B6%E6%89%8B%E5%86%8A%20V1.3.4.pdf")
                    )
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =34
                PressedBorderColor: =ColorFade(Self.Color, -25%)
                PressedColor: =ColorFade(Self.Color, -25%)
                PressedFill: =
                RadiusBottomLeft: =4
                RadiusBottomRight: =4
                RadiusTopLeft: =4
                RadiusTopRight: =4
                Size: =9
                Text: =ThisItem.Value
                Width: =70
                X: =5
                ZIndex: =2

        Label8 As label:
            Color: =RGBA(149, 149, 149, 1)
            Height: =20
            Italic: =true
            Size: =8
            Text: ="Version 1.0.0"
            Width: =160
            X: =64
            Y: =56
            ZIndex: =6

        Image8 As image:
            Height: =40
            Image: =logo_only_icon
            OnSelect: =Set(visiblecount,If(visiblecount>3,0,visiblecount+1))
            Width: =40
            X: =20
            Y: =10
            ZIndex: =7

        Label1_89 As label:
            Color: =RGBA(54, 52, 52, 1)
            Height: =21
            Size: =12
            Text: ="ELCSS-HK"
            Width: =100
            X: =64
            Y: =10
            ZIndex: =9

        Label1_96 As label:
            Color: =RGBA(116, 116, 116, 1)
            Height: =21
            Size: =7
            Text: ="eProcessing System (ePS)"
            Width: =160
            X: =64
            Y: =31
            ZIndex: =10

    Container4_2 As groupContainer.manualLayoutContainer:
        Fill: =glbNeutralLighterColor
        Height: =768
        Width: =1126
        X: =240
        ZIndex: =2

        Container5_1 As groupContainer.manualLayoutContainer:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =473
            Width: =1102
            X: =12
            Y: =283
            ZIndex: =4

            LineRectangle As rectangle:
                Fill: =RGBA(219, 219, 219, 1)
                Height: =430
                Width: =1
                X: =205
                Y: =20
                ZIndex: =2

            Gallery2 As gallery.galleryVertical:
                Height: =401
                Items: =Distinct(Filter(FormTableType,DepartMentType=TabGallery3_3.Selected.Value),DepartMentName)
                Layout: =Layout.Vertical
                TemplatePadding: =0
                TemplateSize: =40
                Width: =180
                X: =20
                Y: =50
                ZIndex: =7

                Label2_5 As label:
                    Color: =If(ThisItem.IsSelected, glbThemePrimaryColor,glbNeutralSecondaryColor)
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold,FontWeight.Normal)
                    HoverColor: =glbThemePrimaryColor
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =11
                    Text: =ThisItem.Result
                    Width: =Parent.Width
                    ZIndex: =2

                Button2 As button:
                    BorderStyle: =BorderStyle.None
                    Color: =RGBA(0, 0, 0, 0)
                    Fill: =RGBA(0, 0, 0, 0)
                    HoverBorderColor: =
                    HoverColor: =RGBA(0, 0, 0, 0)
                    HoverFill: =
                    OnSelect: =Select(Parent)
                    Text: ="Button"
                    Width: =Parent.Width
                    ZIndex: =3

            TabGallery3_3 As gallery.galleryHorizontal:
                Height: =32
                Items: =["部門","服務"]
                TemplatePadding: =0
                TemplateSize: =90
                Width: =180
                X: =20
                Y: =12
                ZIndex: =8

                Label2_4 As label:
                    Align: =Align.Center
                    Color: =If(ThisItem.IsSelected, glbThemePrimaryColor,glbNeutralSecondaryColor)
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold,FontWeight.Normal)
                    Height: =32
                    HoverColor: =glbThemePrimaryColor
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =12
                    Text: =ThisItem.Value
                    Width: =60
                    X: =15
                    ZIndex: =1

                Rectangle2_6 As rectangle:
                    Fill: =glbThemePrimaryColor
                    Height: =3
                    OnSelect: =Select(Parent)
                    Visible: =If(ThisItem.IsSelected, true, false)
                    Width: =90
                    Y: =29
                    ZIndex: =2

                Button2_1 As button:
                    BorderStyle: =BorderStyle.None
                    Color: =RGBA(0, 0, 0, 0)
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =32
                    HoverBorderColor: =
                    HoverColor: =RGBA(0, 0, 0, 0)
                    HoverFill: =
                    OnSelect: =Select(Parent)
                    Text: ="Button"
                    Width: =90
                    ZIndex: =3

            Gallery2_1 As gallery.galleryVertical:
                Height: =401
                Items: |-
                    =Filter(
                            FormTableType,
                            DepartMentName = Gallery2.Selected.Result
                        ).FormType
                Layout: =Layout.Vertical
                TemplatePadding: =0
                TemplateSize: =40
                Width: =210
                X: =215
                Y: =50
                ZIndex: =9

                Label2_6 As label:
                    Color: =If(ThisItem.IsSelected, glbThemePrimaryColor,glbNeutralSecondaryColor)
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold,FontWeight.Normal)
                    HoverColor: =glbThemePrimaryColor
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =20
                    PaddingTop: =0
                    Size: =11
                    Text: =ThisItem.FormType
                    Width: =Parent.Width
                    ZIndex: =2

                Button2_6 As button:
                    BorderStyle: =BorderStyle.None
                    Color: =RGBA(0, 0, 0, 0)
                    Fill: =RGBA(0, 0, 0, 0)
                    HoverBorderColor: =
                    HoverColor: =RGBA(0, 0, 0, 0)
                    HoverFill: =
                    OnSelect: =Select(Parent)
                    Text: ="Button"
                    Width: =Parent.Width
                    ZIndex: =3

            TaskNameGallery_1 As gallery.galleryVertical:
                Height: =420
                Items: |-
                    =Sort(
                    ShowColumns(
                            Filter(
                                        DataModelName,
                                        ModelDepartment = Gallery2.Selected.Result,
                                        ModelType = Gallery2_1.Selected.FormType
                                    ),
                                    "ModelName",
                                    "ModelDescription",
                                    "ModelFlowNumber"
                                ),ModelFlowNumber,Ascending)
                Layout: =Layout.Vertical
                ShowScrollbar: =false
                TemplatePadding: =0
                TemplateSize: =70
                Width: =652
                WrapCount: =3
                X: =445
                Y: =50
                ZIndex: =10

                Label2_7 As label:
                    Color: =glbNeutralSecondaryColor
                    DisplayMode: =
                    Height: =20
                    HoverColor: =glbThemePrimaryColor
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =30
                    PaddingRight: =30
                    PaddingTop: =0
                    Size: =11
                    Text: =If(ThisItem.ModelName in Filter(GenericFormModel,IsEnable="0").ModelName,ThisItem.ModelFlowNumber&"(停用中)",ThisItem.ModelFlowNumber)
                    Width: =Parent.TemplateWidth-10
                    Wrap: =false
                    Y: =11
                    ZIndex: =1

                Label2_8 As label:
                    Color: =glbNeutralSecondaryColor
                    DisplayMode: =
                    Height: =20
                    HoverColor: =glbThemePrimaryColor
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =30
                    PaddingRight: =30
                    PaddingTop: =0
                    Size: =11
                    Text: =ThisItem.ModelName
                    Tooltip: =Self.Text
                    Width: =Parent.TemplateWidth-10
                    Wrap: =false
                    Y: =31
                    ZIndex: =2

                Button_large_12 As button:
                    Align: =Align.Left
                    BorderColor: =glbNeutralQuaternaryColor
                    BorderThickness: =1
                    Color: =glbNeutralPrimaryColor
                    DisabledBorderColor: =glbNeutralQuaternaryColor
                    DisabledFill: =RGBA(0, 0, 0, 0)
                    DisplayMode: =If(ThisItem.ModelName in Filter(GenericFormModel,IsEnable="0").ModelName,Disabled,DisplayMode.Edit)
                    Fill: =RGBA(0, 0, 0, 0)
                    FocusedBorderThickness: =1
                    FontWeight: =FontWeight.Normal
                    Height: =60
                    HoverBorderColor: =glbThemePrimaryColor
                    HoverColor: =RGBA(128, 128, 128, 1)
                    HoverFill: =
                    OnSelect: |-
                        =If(
                            ThisItem.ModelName = "招聘職位申請表",
                                If(
                                    !IsBlank(
                                        LookUp(
                                            MyContacts,
                                            UserEmail = User().Email && TaskFormName = "招聘職位申請表"
                                        )
                                    ),
                                    "",
                                    Patch(
                                        MyContacts,
                                        Defaults(MyContacts),
                                        {
                                            TaskFormName: "招聘職位申請表",
                                            标题: GUID(),
                                            UserEmail: User().Email,
                                            ContatsType: "",
                                            ModelFlowNumber: "A103"
                                        }
                                    )
                                );
                            Launch(
                                JumpUrl & "&Screen=JobTitleFormScreen&newApplicationGuid=" & GUID() & "&flowguid=" & GUID() & "&bustype=New",
                                {},
                                LaunchTarget.Replace
                            ),
                            ThisItem.ModelName = "假期批核人資料表",
                            
                                If(
                                    !IsBlank(
                                        LookUp(
                                            MyContacts,
                                            UserEmail = User().Email && TaskFormName = "假期批核人資料表"
                                        )
                                    ),
                                    "",
                                    Patch(
                                        MyContacts,
                                        Defaults(MyContacts),
                                        {
                                            TaskFormName: "假期批核人資料表",
                                            标题: GUID(),
                                            UserEmail: User().Email,
                                            ContatsType: "",
                                            ModelFlowNumber: "A306"
                                        }
                                    )
                                );
                            Launch(
                                JumpUrlA306A111 & "&Screen=VacationFormScreen&newApplicationGuid=" & GUID() & "&flowguid=" & GUID() & "&bustype=New",
                                {},
                                LaunchTarget.Replace
                            ),
                            ThisItem.ModelName = "任職資源申請",
                                If(
                                    !IsBlank(
                                        LookUp(
                                            MyContacts,
                                            UserEmail = User().Email && TaskFormName = "任職資源申請"
                                        )
                                    ),
                                    "",
                                    Patch(
                                        MyContacts,
                                        Defaults(MyContacts),
                                        {
                                            TaskFormName: "任職資源申請",
                                            标题: GUID(),
                                            UserEmail: User().Email,
                                            ContatsType: "",
                                            ModelFlowNumber: "A111"
                                        }
                                    )
                                );
                            Launch(
                                JumpUrlA306A111 & "&Screen=EmploymentFormScreen&newApplicationGuid=" & GUID() & "&flowguid=" & GUID() & "&bustype=New",
                                {},
                                LaunchTarget.Replace
                            ),
                            ThisItem.ModelName = "預備合約通知書(新入職)",
                                If(
                                    !IsBlank(
                                        LookUp(
                                            MyContacts,
                                            UserEmail = User().Email && TaskFormName = "預備合約通知書(新入職)"
                                        )
                                    ),
                                    "",
                                    Patch(
                                        MyContacts,
                                        Defaults(MyContacts),
                                        {
                                            TaskFormName: "預備合約通知書(新入職)",
                                            标题: GUID(),
                                            UserEmail: User().Email,
                                            ContatsType: "",
                                            ModelFlowNumber: "A104"
                                        }
                                    )
                                );
                            Launch(
                                JumpUrl & "&Screen=ContractNoticeForm&newApplicationGuid=" & GUID() & "&flowguid=" & GUID() & "&bustype=New",
                                {},
                                LaunchTarget.Replace
                            ),
                                If(
                                    !IsBlank(
                                        LookUp(
                                            MyContacts,
                                            UserEmail = User().Email && TaskFormName = ThisItem.ModelName
                                        )
                                    ),
                                    "",
                                    Patch(
                                        MyContacts,
                                        Defaults(MyContacts),
                                        {
                                            TaskFormName: ThisItem.ModelName,
                                            标题: GUID(),
                                            UserEmail: User().Email,
                                            ContatsType: "",
                                            TaskFormDescription: ThisItem.ModelDescription,
                                            ModelFlowNumber: ThisItem.ModelFlowNumber
                                        }
                                    )
                                );
                            With(
                                {
                                    FormModelId: LookUp(
                                        GenericFormModel,
                                        ModelFlowNumber = ThisItem.ModelFlowNumber
                                    ).标题
                                },
                                Launch(
                                    JumpUrlMobileApp&"&Screen=CreateGeneralFormScreen&FormModelId="&FormModelId & "&Page=Home",
                                    {},
                                    LaunchTarget.Replace
                                )
                            )
                        )
                    PaddingBottom: =0
                    PaddingLeft: =10
                    PaddingRight: =0
                    PaddingTop: =0
                    PressedBorderColor: =glbThemePrimaryColor
                    PressedColor: =
                    PressedFill: =
                    RadiusBottomLeft: =4
                    RadiusBottomRight: =4
                    RadiusTopLeft: =4
                    RadiusTopRight: =4
                    Size: =10
                    Text: =
                    Tooltip: ="名稱："&ThisItem.ModelName&Char(10)&"備註："&If(ThisItem.ModelDescription=Blank(),"/",ThisItem.ModelDescription)
                    Width: =Parent.TemplateWidth-10
                    X: =1
                    Y: =1
                    ZIndex: =3

            Label7_4 As label:
                Color: =glbNeutralSecondaryColor
                DisplayMode: =DisplayMode.View
                FontWeight: =FontWeight.Semibold
                Height: =32
                HoverColor: =glbThemePrimaryColor
                OnSelect: |-
                    =//Navigate(GeneralFormListScreen,None,{ListID:2})
                PaddingLeft: =0
                Size: =12
                Text: =If(TabGallery3_3.Selected.Value="服務","單位","類型")
                Width: =80
                X: =215
                Y: =12
                ZIndex: =11

            Label7_5 As label:
                Color: =glbNeutralSecondaryColor
                DisplayMode: =DisplayMode.View
                FontWeight: =FontWeight.Semibold
                Height: =32
                HoverColor: =glbThemePrimaryColor
                OnSelect: |-
                    =Navigate(GeneralFormListScreen,None,{ListID:2})
                PaddingLeft: =0
                Size: =12
                Text: ="表格"
                Width: =80
                X: =445
                Y: =12
                ZIndex: =12

            LineRectangle_2 As rectangle:
                Fill: =RGBA(219, 219, 219, 1)
                Height: =430
                Width: =1
                X: =435
                Y: =20
                ZIndex: =13

        Container5_4 As groupContainer.manualLayoutContainer:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =260
            Width: =689
            X: =12
            Y: =12
            ZIndex: =5

            Image6 As image:
                Fill: =RGBA(252, 237, 230, 1)
                Height: =50
                Image: |-
                    ="data:image/svg+xml," & EncodeUrl("<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' version='1.1' id='mdi-bell-ring' width='24' height='24' viewBox='0 0 24 24'><path fill='#fa6400' d='M21,19V20H3V19L5,17V11C5,7.9 7.03,5.17 10,4.29C10,4.19 10,4.1 10,4A2,2 0 0,1 12,2A2,2 0 0,1 14,4C14,4.1 14,4.19 14,4.29C16.97,5.17 19,7.9 19,11V17L21,19M14,21A2,2 0 0,1 12,23A2,2 0 0,1 10,21M19.75,3.19L18.33,4.61C20.04,6.3 21,8.6 21,11H23C23,8.07 21.84,5.25 19.75,3.19M1,11H3C3,8.6 3.96,6.3 5.67,4.61L4.25,3.19C2.16,5.25 1,8.07 1,11Z' /></svg>")
                PaddingBottom: =10
                PaddingTop: =10
                RadiusBottomLeft: =15
                RadiusBottomRight: =15
                RadiusTopLeft: =15
                RadiusTopRight: =15
                Width: =50
                X: =31
                Y: =20
                ZIndex: =1

            Label7_1 As label:
                Color: =RGBA(250, 100, 0, 1)
                Font: =Font.'Lato Black'
                Height: =26
                PaddingLeft: =0
                Size: =18
                Text: =CountRows(Priority_Processing)
                Width: =67
                X: =96
                Y: =20
                ZIndex: =3

            Image6_1 As image:
                Fill: =RGBA(230, 244, 252, 1)
                Height: =50
                Image: |-
                    ="data:image/svg+xml," & EncodeUrl("<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' version='1.1' id='mdi-table-clock' width='24' height='24' viewBox='0 0 24 24'><path fill='#01a8f4' d='M16.5 15.82L18.94 17.23L18.19 18.53L15 16.69V13H16.5V15.82M20 10.26V5C20 3.9 19.11 3 18 3H4C2.9 3 2 3.9 2 5V17C2 18.11 2.9 19 4 19H9.68C10.81 21.36 13.21 23 16 23C19.87 23 23 19.87 23 16C23 13.62 21.81 11.53 20 10.26M18 7V9.29C17.37 9.11 16.7 9 16 9C14.5 9 13.13 9.47 12 10.26V7H18M4 7H10V11H4V7M4 17V13H9.68C9.25 13.91 9 14.93 9 16C9 16.34 9.03 16.67 9.08 17H4M16 21C13.24 21 11 18.76 11 16S13.24 11 16 11 21 13.24 21 16 18.76 21 16 21Z' /></svg>")
                PaddingBottom: =10
                PaddingTop: =10
                RadiusBottomLeft: =15
                RadiusBottomRight: =15
                RadiusTopLeft: =15
                RadiusTopRight: =15
                Width: =50
                X: =376
                Y: =20
                ZIndex: =5

            Label7_3 As label:
                Color: =glbThemePrimaryColor
                Font: =Font.'Lato Black'
                Height: =26
                PaddingLeft: =0
                Size: =18
                Text: =CountRows(FilterPendingDataCol)
                Width: =67
                X: =441
                Y: =20
                ZIndex: =7

            Icon5 As icon.ChevronRight:
                Color: =RGBA(149, 149, 149, 1)
                Height: =24
                HoverColor: =glbThemePrimaryColor
                Icon: =Icon.ChevronRight
                PaddingBottom: =5
                PaddingTop: =5
                Width: =24
                X: =152
                Y: =46
                ZIndex: =8

            Gallery5 As gallery.galleryVertical:
                Height: =160
                Items: =Sort(Filter(ApprovalDetail_Table,ApproverEmail = CurrentUser,TaskStatus = "002"),修改时间,Ascending)
                Layout: =Layout.Vertical
                OnSelect: =
                ShowScrollbar: =false
                TemplatePadding: =0
                TemplateSize: =32
                Transition: =Transition.Pop
                Width: =661
                X: =20
                Y: =95
                ZIndex: =10

                LineRectangle_4 As rectangle:
                    Fill: =RGBA(219, 219, 219, 1)
                    Height: =1
                    Width: =661
                    Y: =31
                    ZIndex: =5

                Icon5_2 As icon.ChevronRight:
                    Color: =glbThemePrimaryColor
                    Height: =24
                    HoverColor: =RGBA(102, 182, 227, 1)
                    HoverFill: =RGBA(0, 0, 0, 0)
                    Icon: =Icon.ChevronRight
                    OnSelect: |-
                        =With(
                        {
                        FormName:LookUp(Approval_Table,标题=ThisItem.Approval_No).Task_Name
                        },
                        If(
                            FormName = "招聘職位申請表",
                            If(
                                ThisItem.TaskStatus = "001",
                                Launch(
                                    JumpUrl&"&Screen=JobTitleFormScreen&AppIds=" & LookUp(
                                        ApplitionJobPosition,
                                        ApprovalId = Gallery5.Selected.Approval_No
                                    ).标题 & "&MasterflowId=" & Gallery5.Selected.Approval_No & "&resubmit=true"
                                ),
                                Launch(
                                    JumpUrl&"&Screen=JobTitleFormDetailScreen&AppIds=" & LookUp(
                                        ApplitionJobPosition,
                                        ApprovalId = Gallery5.Selected.Approval_No
                                    ).标题 & "&MasterflowId=" & Gallery5.Selected.Approval_No & "&resubmit=false"
                                )
                            ),
                            FormName = "假期批核人資料表",
                            If(
                                ThisItem.TaskStatus = "001",
                                Launch(
                                    JumpUrlA306A111&"&Screen=VacationFormDetailScreen&taskNum=" & LookUp(
                                        VacationApprovalForm,
                                        Applicant_No = Gallery5.Selected.Approval_No
                                    ).标题 & "&approvalNum=" & Gallery5.Selected.Approval_No & "&resubmit=true"
                                ),
                                Launch(
                                    JumpUrlA306A111&"&Screen=VacationFormDetailScreen&taskNum=" & LookUp(
                                        VacationApprovalForm,
                                        Applicant_No = Gallery5.Selected.Approval_No
                                    ).标题 & "&approvalNum=" & Gallery5.Selected.Approval_No & "&resubmit=false"
                                )
                            ),
                            FormName = "預備合約通知書(新入職)",
                            If(
                                ThisItem.TaskStatus = "001",
                                Launch(
                                    JumpUrl&"&Screen=ContractNoticeForm&taskNum=" & LookUp(
                                        ContractNotice,
                                        ApprovalId = Gallery5.Selected.Approval_No
                                    ).标题 & "&approvalNum=" & Gallery5.Selected.Approval_No & "&resubmit=true"
                                ),
                                Launch(
                                    JumpUrl&"&Screen=ContractNoticeFormDetail&taskNum=" & LookUp(
                                        ContractNotice,
                                        ApprovalId = Gallery5.Selected.Approval_No
                                    ).标题 & "&approvalNum=" & Gallery5.Selected.Approval_No & "&resubmit=false"
                                )
                            ),
                            FormName = "任職資源申請",
                            Launch(
                                JumpUrlA306A111&"&Screen=EmploymentFormDetail&taskNum=" & LookUp(
                                    EmploymentResource,
                                    ApprovalId = Gallery5.Selected.Approval_No
                                ).标题 & "&approvalNum=" & Gallery5.Selected.Approval_No & "&resubmit=false"
                            ),
                            With(
                                {
                                    FormId: LookUp(
                                        GenericFormList,
                                        ApprovalId = ThisItem.Approval_No
                                    ).标题
                                },
                                Launch(JumpUrlMobileApp&"&Screen=DetailGeneralFormScreen&FormId=" & FormId & "&FLowId=" & Gallery5.Selected.Approval_No & "&Page=Home"
                                ,{},LaunchTarget.Replace)
                            )
                        )
                        )
                    PaddingBottom: =3
                    PaddingTop: =3
                    Width: =24
                    X: =633
                    Y: =4
                    ZIndex: =6

                Group18 As group:
                    Height: =5
                    Width: =5
                    X: =40
                    Y: =32
                    ZIndex: =6

                    Label11 As label:
                        Color: =glbNeutralSecondaryColor
                        Height: =32
                        OnSelect: =Select(Parent)
                        Size: =10
                        Text: =LookUp(Approval_Table,标题=ThisItem.Approval_No).Application_No
                        Tooltip: =LookUp(Approval_Table,标题=ThisItem.Approval_No).Application_No
                        Width: =142
                        Wrap: =false
                        ZIndex: =1

                    Label11_1 As label:
                        Color: =glbNeutralSecondaryColor
                        Height: =32
                        OnSelect: =Select(Parent)
                        Size: =10
                        Text: |-
                            =//LookUp(Approval_Table,Title=ThisItem.Approval_No).DepartMentUnit
                            
                            If(CountA(Split(LookUp(Approval_Table,标题=ThisItem.Approval_No).DepartMentUnit,"-").Result)=2,First(Split(LookUp(Approval_Table,标题=ThisItem.Approval_No).DepartMentUnit,"-")).Result,First(Split(LookUp(Approval_Table,标题=ThisItem.Approval_No).DepartMentUnit,"-")).Result&"-"&Index(Split(LookUp(Approval_Table,标题=ThisItem.Approval_No).DepartMentUnit,"-"),2).Result)
                        Tooltip: =LookUp(Approval_Table,标题=ThisItem.Approval_No).DepartMentUnit
                        Width: =100
                        Wrap: =false
                        X: =418
                        ZIndex: =2

                    Label11_2 As label:
                        Color: =glbNeutralSecondaryColor
                        Height: =32
                        OnSelect: =Select(Parent)
                        Size: =10
                        Text: =LookUp(Approval_Table,标题=ThisItem.Approval_No).Task_Name
                        Tooltip: =LookUp(Approval_Table,标题=ThisItem.Approval_No).Task_Name
                        Width: =276
                        Wrap: =false
                        X: =142
                        ZIndex: =3

                    Label11_3 As label:
                        Align: =Align.Right
                        Color: =glbNeutralSecondaryColor
                        Height: =32
                        OnSelect: =Select(Parent)
                        Size: =9
                        Text: |-
                            =Text(ThisItem.修改时间,"dd/mm/yyyy HH:mm")
                        Tooltip: |-
                            =Text(ThisItem.修改时间,"dd/mm/yyyy HH:mm")
                        Width: =115
                        Wrap: =false
                        X: =518
                        ZIndex: =4

            LineRectangle_3 As rectangle:
                Fill: =RGBA(221, 79, 14, 1)
                Height: =1
                Width: =661
                X: =20
                Y: =90
                ZIndex: =11

            Icon5_1 As icon.ChevronRight:
                Color: =RGBA(149, 149, 149, 1)
                Height: =24
                HoverColor: =glbThemePrimaryColor
                Icon: =Icon.ChevronRight
                PaddingBottom: =5
                PaddingTop: =5
                Width: =24
                X: =483
                Y: =46
                ZIndex: =12

            BtnLink_5 As button:
                Align: =Align.Left
                BorderColor: =
                BorderThickness: =0
                Color: =glbLinkColor
                DisabledBorderColor: =RGBA(219, 219, 219, 1)
                Fill: =RGBA(0, 0, 0, 0)
                FocusedBorderThickness: =0
                FontWeight: =FontWeight.Normal
                Height: =24
                HoverBorderColor: =ColorFade(Self.Color, -15%)
                HoverColor: =ColorFade(Self.Color, -15%)
                HoverFill: =RGBA(0, 0, 0, 0)
                OnSelect: =Navigate(GeneralFormListScreen,None)
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                PressedBorderColor: =ColorFade(Self.Color, -25%)
                PressedColor: =ColorFade(Self.Color, -25%)
                PressedFill: =RGBA(0, 0, 0, 0)
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =12
                Text: ="待處理"
                Width: =60
                X: =441
                Y: =46
                ZIndex: =13

            BtnLink_6 As button:
                Align: =Align.Left
                BorderColor: =
                BorderThickness: =0
                Color: =RGBA(250, 100, 0, 1)
                DisabledBorderColor: =RGBA(219, 219, 219, 1)
                Fill: =RGBA(0, 0, 0, 0)
                FocusedBorderThickness: =0
                Font: =Font.'Lato Black'
                FontWeight: =FontWeight.Normal
                Height: =24
                HoverBorderColor: =ColorFade(Self.Color, -15%)
                HoverColor: =ColorFade(Self.Color, -15%)
                HoverFill: =RGBA(0, 0, 0, 0)
                OnSelect: =Navigate(GeneralFormListScreen,None)
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                PressedBorderColor: =ColorFade(Self.Color, -25%)
                PressedColor: =ColorFade(Self.Color, -25%)
                PressedFill: =RGBA(0, 0, 0, 0)
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =12
                Text: ="優先處理"
                Width: =80
                X: =96
                Y: =46
                ZIndex: =14

        Container1 As groupContainer.manualLayoutContainer:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =90
            Width: =399
            X: =715
            Y: =12
            ZIndex: =6

            Image7 As image:
                Height: =40
                Image: =User().Image
                RadiusBottomLeft: =20
                RadiusBottomRight: =20
                RadiusTopLeft: =20
                RadiusTopRight: =20
                Width: =40
                X: =24
                Y: =25
                ZIndex: =3

            Label7_6 As label:
                Color: =glbNeutralSecondaryColor
                DisplayMode: =DisplayMode.View
                Height: =24
                HoverColor: =glbThemePrimaryColor
                OnSelect: |-
                    =Navigate(GeneralFormListScreen,None,{ListID:2})
                PaddingLeft: =0
                Size: =12
                Text: ="歡迎你，"
                Width: =80
                X: =79
                Y: =22
                ZIndex: =4

            Label7_7 As label:
                Color: =glbNeutralSecondaryColor
                DisplayMode: =DisplayMode.View
                FontWeight: =FontWeight.Semibold
                Height: =24
                HoverColor: =glbThemePrimaryColor
                OnSelect: |-
                    =Navigate(GeneralFormListScreen,None,{ListID:2})
                PaddingLeft: =0
                Size: =12
                Text: =User().FullName
                Width: =300
                X: =79
                Y: =47
                ZIndex: =5

        Container4 As groupContainer.manualLayoutContainer:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =158
            Width: =399
            X: =715
            Y: =114
            ZIndex: =7

            TextInput2_15 As text:
                BorderColor: =glbNeutralQuaternaryColor
                BorderThickness: =1
                Color: =glbNeutralPrimaryColor
                Default: =""
                FocusedBorderColor: =glbNeutralSecondaryColor
                FocusedBorderThickness: =1
                Height: =36
                HintText: ="搜索表格"
                HoverBorderColor: =glbThemePrimaryColor
                HoverFill: =White
                PaddingBottom: =0
                PaddingLeft: =34
                PaddingRight: =0
                PaddingTop: =0
                PressedBorderColor: =ColorFade(Self.BorderColor, -20%)
                PressedFill: =White
                RadiusBottomLeft: =4
                RadiusBottomRight: =4
                RadiusTopLeft: =4
                RadiusTopRight: =4
                Size: =10
                Width: =370
                X: =20
                Y: =20
                ZIndex: =1

            Icon3 As icon.Search:
                Color: =RGBA(116, 116, 116, 1)
                Height: =32
                Icon: =Icon.Search
                PaddingBottom: =6
                PaddingTop: =6
                Width: =32
                X: =20
                Y: =22
                ZIndex: =2

            TaskNameGallery_2 As gallery.galleryVertical:
                Height: =60
                Items: |-
                    =If(
                        TextInput2_15.Text = "",
                        Search(
                            ShowColumns(RenameColumns(
                                SortByColumns(
                                    Filter(
                                        MyContacts,
                                        UserEmail = User().Email,
                                        ContatsType = Blank()
                                        //,TaskFormName = First(Filter(GenericFormModel,ModelName = TaskFormName, IsEnable= "1")).ModelName
                                        
                                    ),
                                    "Created",
                                    Descending
                                ),
                                "TaskFormName",
                                "ModelName",
                                "TaskFormDescription",
                                "ModelDescription"
                            ),"ModelName","ModelDescription","ModelFlowNumber"),
                            TextInput2_15.Text,
                            "ModelName","ModelDescription","ModelFlowNumber"
                        ),
                        
                            Search(
                                ShowColumns(
                                    DataModelName,
                                   /* Filter(
                                        ,
                                        ModelDescription = Gallery2_1.Selected.FormType
                                    ),*/
                                    "ModelName",
                                    "ModelDescription",
                                    "ModelFlowNumber"
                                ),
                                TextInput2_15.Text,
                                "ModelName","ModelDescription","ModelFlowNumber"
                            
                    )
                    )
                Layout: =Layout.Vertical
                ShowScrollbar: =false
                TemplatePadding: =0
                TemplateSize: =60
                Width: =379
                WrapCount: =3
                X: =20
                Y: =70
                ZIndex: =3

                Label2_9 As label:
                    Color: =glbNeutralSecondaryColor
                    Height: =20
                    HoverColor: =glbThemePrimaryColor
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =15
                    PaddingRight: =15
                    PaddingTop: =0
                    Size: =11
                    Text: =If(ThisItem.ModelName in Filter(GenericFormModel,IsEnable="0").ModelName,ThisItem.ModelFlowNumber&"(停用中)",ThisItem.ModelFlowNumber)
                    Width: =Parent.TemplateWidth-10
                    Wrap: =false
                    Y: =6
                    ZIndex: =1

                Label2_10 As label:
                    Color: =glbNeutralSecondaryColor
                    Height: =20
                    HoverColor: =glbThemePrimaryColor
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =15
                    PaddingRight: =15
                    PaddingTop: =0
                    Size: =11
                    Text: =ThisItem.ModelName
                    Tooltip: =Self.Text
                    Width: =Parent.TemplateWidth-10
                    Wrap: =false
                    Y: =26
                    ZIndex: =2

                Button_large_13 As button:
                    Align: =Align.Left
                    BorderColor: =glbNeutralQuaternaryColor
                    BorderThickness: =1
                    Color: =glbNeutralPrimaryColor
                    DisabledBorderColor: =glbNeutralQuaternaryColor
                    DisabledFill: =RGBA(0, 0, 0, 0)
                    DisplayMode: =If(ThisItem.ModelName in Filter(GenericFormModel,IsEnable="0").ModelName,Disabled,Edit)
                    Fill: =RGBA(0, 0, 0, 0)
                    FocusedBorderThickness: =1
                    FontWeight: =FontWeight.Normal
                    Height: =50
                    HoverBorderColor: =glbThemePrimaryColor
                    HoverColor: =
                    HoverFill: =
                    OnSelect: |-
                        =If(
                            ThisItem.ModelName = "招聘職位申請表",
                                If(
                                    !IsBlank(
                                        LookUp(
                                            MyContacts,
                                            UserEmail = User().Email && TaskFormName = "招聘職位申請表"
                                        )
                                    ),
                                    "",
                                    Patch(
                                        MyContacts,
                                        Defaults(MyContacts),
                                        {
                                            TaskFormName: "招聘職位申請表",
                                            标题: GUID(),
                                            UserEmail: User().Email,
                                            ContatsType: "",
                                            ModelFlowNumber: "A103"
                                        }
                                    )
                                );
                            Launch(
                                JumpUrl & "&Screen=JobTitleFormScreen&newApplicationGuid=" & GUID() & "&flowguid=" & GUID() & "&bustype=New",
                                {},
                                LaunchTarget.Replace
                            ),
                            ThisItem.ModelName = "假期批核人資料表",
                            
                                If(
                                    !IsBlank(
                                        LookUp(
                                            MyContacts,
                                            UserEmail = User().Email && TaskFormName = "假期批核人資料表"
                                        )
                                    ),
                                    "",
                                    Patch(
                                        MyContacts,
                                        Defaults(MyContacts),
                                        {
                                            TaskFormName: "假期批核人資料表",
                                            标题: GUID(),
                                            UserEmail: User().Email,
                                            ContatsType: "",
                                            ModelFlowNumber: "A306"
                                        }
                                    )
                                );
                            Launch(
                                JumpUrlA306A111 & "&Screen=VacationFormScreen&newApplicationGuid=" & GUID() & "&flowguid=" & GUID() & "&bustype=New",
                                {},
                                LaunchTarget.Replace
                            ),
                            ThisItem.ModelName = "任職資源申請",
                                If(
                                    !IsBlank(
                                        LookUp(
                                            MyContacts,
                                            UserEmail = User().Email && TaskFormName = "任職資源申請"
                                        )
                                    ),
                                    "",
                                    Patch(
                                        MyContacts,
                                        Defaults(MyContacts),
                                        {
                                            TaskFormName: "任職資源申請",
                                            标题: GUID(),
                                            UserEmail: User().Email,
                                            ContatsType: "",
                                            ModelFlowNumber: "A111"
                                        }
                                    )
                                );
                            Launch(
                                JumpUrlA306A111 & "&Screen=EmploymentFormScreen&newApplicationGuid=" & GUID() & "&flowguid=" & GUID() & "&bustype=New",
                                {},
                                LaunchTarget.Replace
                            ),
                            ThisItem.ModelName = "預備合約通知書(新入職)",
                                If(
                                    !IsBlank(
                                        LookUp(
                                            MyContacts,
                                            UserEmail = User().Email && TaskFormName = "預備合約通知書(新入職)"
                                        )
                                    ),
                                    "",
                                    Patch(
                                        MyContacts,
                                        Defaults(MyContacts),
                                        {
                                            TaskFormName: "預備合約通知書(新入職)",
                                            标题: GUID(),
                                            UserEmail: User().Email,
                                            ContatsType: "",
                                            ModelFlowNumber: "A104"
                                        }
                                    )
                                );
                            Launch(
                                JumpUrl & "&Screen=ContractNoticeForm&newApplicationGuid=" & GUID() & "&flowguid=" & GUID() & "&bustype=New",
                                {},
                                LaunchTarget.Replace
                            ),
                                If(
                                    !IsBlank(
                                        LookUp(
                                            MyContacts,
                                            UserEmail = User().Email && TaskFormName = ThisItem.ModelName
                                        )
                                    ),
                                    "",
                                    Patch(
                                        MyContacts,
                                        Defaults(MyContacts),
                                        {
                                            TaskFormName: ThisItem.ModelName,
                                            标题: GUID(),
                                            UserEmail: User().Email,
                                            ContatsType: "",
                                            TaskFormDescription: ThisItem.ModelDescription,
                                            ModelFlowNumber: ThisItem.ModelFlowNumber
                                        }
                                    )
                                );
                            With(
                                {
                                    FormModelId: LookUp(
                                        GenericFormModel,
                                        ModelFlowNumber = ThisItem.ModelFlowNumber
                                    ).标题
                                },
                                Launch(
                                    JumpUrlMobileApp&"&Screen=CreateGeneralFormScreen&FormModelId="&FormModelId & "&Page=Home",
                                    {},
                                    LaunchTarget.Replace
                                )
                            )
                        )
                    PaddingBottom: =0
                    PaddingLeft: =15
                    PaddingRight: =15
                    PaddingTop: =0
                    PressedBorderColor: =glbThemePrimaryColor
                    PressedColor: =
                    PressedFill: =
                    RadiusBottomLeft: =4
                    RadiusBottomRight: =4
                    RadiusTopLeft: =4
                    RadiusTopRight: =4
                    Size: =10
                    Text: =
                    Tooltip: ="名稱："&ThisItem.ModelName&Char(10)&"備註："&If(ThisItem.ModelDescription=Blank(),"/",ThisItem.ModelDescription)
                    Width: =Parent.TemplateWidth-10
                    X: =1
                    Y: =1
                    ZIndex: =3

    Dropdown1_2 As dropdown:
        Default: =""
        Items: =["eps-vendor2@elchk.org.hk","eps-vendor@elchk.org.hk","eps-tester1@elchk.org.hk","eps-tester4@elchk.org.hk","eps-tester2@elchk.org.hk","eps-tester3@elchk.org.hk","zhuzhenhua@chinasofti.com"]
        OnChange: |-
            =Set(
                CurrentUser,
                Dropdown1_2.Selected.Value
            );
            Set(
                CurrentUserName,
            First(
                Split(
                    CurrentUser,
                    "@"
                ).Result
            ).Result);
            Set(
                CurrentRole,
                CurrentUser in Filter(
                    SignerInfo,
                    S_Mechanism_No = "HO-ADM"
                ).Signer_Email
            );
            Set(
                CurrentRoleName,
                 LookUp(
                    SignerInfo,
                    Signer_Email = CurrentUser
                ).Role
            );
            //二期權限測試添加
            //-----------
            /*Set(
                CurrentRoleFormPermission,
                 If(LookUp(
                    UserInfo,
                    User_Email = CurrentUser
                ).FormPermission = LookUp(
                    UserInfo,
                    User_Email = CurrentUser
                ).O_Mechanism_No,LookUp(
                    UserInfo,
                    User_Email = CurrentUser
                ).O_Mechanism,If(LookUp(
                    UserInfo,
                    User_Email = CurrentUser
                ).FormPermission = "全部表格","All","None")
            ));*/
            //新增多部門及表格類型表單權限過濾測試代碼
            Set(
                CurrentRoleFormModelPermssion,
                If(
                    LookUp(
                        UserInfo,
                        User_Email = CurrentUser).FormPermission = "全部表格","All",LookUp(
                        UserInfo,
                        User_Email = CurrentUser).FormPermission = Blank(),"None",LookUp(
                        UserInfo,
                        User_Email = CurrentUser).FormPermission
                )
            );
            Set(
                CurrentRoleFormModelPermssion_sub,
                LookUp(
                        UserInfo,
                        User_Email = CurrentUser).FormPermission_Sub
            );
            Set(
                CurrentRoleTaskPermission,
                If(LookUp(
                    UserInfo,
                    User_Email = CurrentUser
                ).IsManger="是",LookUp(
                    UserInfo,
                    User_Email = CurrentUser
                ).O_Mechanism_No&"-"&LookUp(
                    UserInfo,
                    User_Email = CurrentUser
                ).O_Mechanism,"NoManger")
            );
            Set(
                CurrentRoleTaskPermissionForm,
                If(LookUp(
                    UserInfo,
                    User_Email = CurrentUser
                ).IsManger="是",LookUp(
                    UserInfo,
                    User_Email = CurrentUser
                ).O_Mechanism,"NoManger")
            );
            Set(
                HRAO,
                CurrentUser in Filter(
                    UserInfo,
                    O_Mechanism = "人力資源部" && Post_No = "ADMO"
                ).User_Email
            );
            Set(
                SuperUser,
                CurrentUser in Filter(
                    UserInfo,
                    IsSuperUser = "是"
                ).User_Email
            );
            //------------
            //Select(uploadButton)
        Visible: |
            =//User().Email in ["wangxuhui@chinasofti.com"]
            If(
                visiblecount = 3,
                true,
                false
            )
        Width: =259
        X: =1035
        Y: =40
        ZIndex: =3


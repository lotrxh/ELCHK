AdminFormListScreen As screen:
    OnVisible: |
        =//權限過濾后的部門/服務信息
        ClearCollect(
            FilterDepartment,
            If(
                CurrentRoleFormModelPermssion = "All",
                FormTableType,
                CurrentRoleFormModelPermssion = "None",
                Filter(
                    FormTableType,
                    DepartMentName = Blank()
                ),
                ClearCollect(
                    NameTransform,
                    Split(
                        CurrentRoleFormModelPermssion,
                        ";"
                    )
                );
                Ungroup(
                    ForAll(
                        Filter(
                            RenameColumns(
                                NameTransform,
                                "Result",
                                "CurrentFormDepartment"
                            ),
                            CurrentFormDepartment <> ""
                        ),
                        {
                            Formtypevalue3: Filter(
                                FormTableType,
                                DepartMentName = CurrentFormDepartment
                            )
                        }
                    ),
                    "Formtypevalue3"
                )
            )
        );
        //權限過濾后的表格模板/單位信息
        ClearCollect(
            FilterFormType,
            If(
                CurrentRoleFormModelPermssion = "All",
                FormTableType,
                CurrentRoleFormModelPermssion = "None",
                Filter(
                    FormTableType,
                    FormType = Blank()
                ),
                ClearCollect(
                    NameTransformtype,
                    Split(
                        CurrentRoleFormModelPermssion_sub,
                        ";"
                    )
                );
                Ungroup(
                    ForAll(
                        Filter(
                            RenameColumns(
                                NameTransformtype,
                                "Result",
                                "CurrentFormDepartmentFormtype"
                            ),
                            CurrentFormDepartmentFormtype <> ""
                        ),
                        {
                            Formtypevalue4: Filter(
                                FormTableType,
                                FormType = CurrentFormDepartmentFormtype
                            )
                        }
                    ),
                    "Formtypevalue4"
                )
            )
        );
        //生成權限過濾后的表格列表
        ClearCollect(
            DepartmentTable,
            Distinct(
                FilterDepartment,
                DepartMentName
            )
        );
        ClearCollect(
            FormTypeTable,
            Distinct(
                FilterFormType,
                FormType
            )
        );
        ClearCollect(
            FilterFormDepartment,
            If(
                CurrentRoleFormModelPermssion = "All",
                GenericFormModel,
                CurrentRoleFormModelPermssion = "None",
                Filter(
                    GenericFormModel,
                    ModelDepartment = Blank()
                ),
                Ungroup(
                    ForAll(
                        Filter(
                            RenameColumns(
                                FormTypeTable,
                                "Result",
                                "CurrentFormDepartmentFormtype1"
                            ),
                            CurrentFormDepartmentFormtype1 <> ""
                        ),
                        {
                            Formtypevalue6: Filter(
                                Ungroup(
                                    ForAll(
                                        Filter(
                                            RenameColumns(
                                                DepartmentTable,
                                                "Result",
                                                "CurrentFormDepartment1"
                                            ),
                                            CurrentFormDepartment1 <> ""
                                        ),
                                        {
                                            Formtypevalue5: Filter(
                                                GenericFormModel,
                                                ModelDepartment = CurrentFormDepartment1
                                            )
                                        }
                                    ),
                                    "Formtypevalue5"
                                ),
                                ModelType = CurrentFormDepartmentFormtype1
                            )
                        }
                    ),
                    "Formtypevalue6"
                )
            )
        );
        //启用停用前判断是否有任务未完成使用
        ClearCollect(
            approvalCol1,
            Approval_Table
        );
        //生產待處理任務集合
        ClearCollect(
            ApprovalDetailCol1,
            Filter(
                ShowColumns(
                    ApprovalDetail_Table,
                    "Title",
                    "Approval_No",
                    "Approver",
                    "ApproverEmail",
                    "Priortty",
                    "TaskStatus",
                    "AgentUserEmail"
                ),
                TaskStatus = "001" || TaskStatus = "002"
            )
        );
        //生成带表格模板名稱字段的ApprovalDetail_Table待理任务
        ClearCollect(
            ApprovalDetailColwithFormName1,
            AddColumns(
                ApprovalDetailCol1,
                "FormName",
                LookUp(
                    approvalCol1,
                    标题 = Approval_No
                ).Task_Name
            )
        );
        Select(Reset_button);

    Container4_3 As groupContainer.manualLayoutContainer:
        Fill: =RGBA(247, 247, 247, 1)
        Height: =768
        Width: =1126
        X: =240
        ZIndex: =2

        Container5_5 As groupContainer.manualLayoutContainer:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =70
            Width: =1101
            X: =12
            Y: =65
            ZIndex: =1

            drpFilterDepartment As combobox:
                BorderColor: =glbNeutralTertiaryColor
                BorderThickness: =1
                ChevronBackground: =RGBA(255, 255, 255, 1)
                ChevronDisabledBackground: =RGBA(0, 0, 0, 0)
                ChevronDisabledFill: =RGBA(202, 202, 202, 1)
                ChevronFill: =glbNeutralTertiaryColor
                ChevronHoverBackground: =ColorFade(Self.ChevronBackground, -5%)
                ChevronHoverFill: =ColorFade(Self.BorderColor, -20%)
                Color: =glbNeutralPrimaryColor
                DisplayFields: =["Result"]
                FocusedBorderThickness: =1
                Height: =32
                HoverBorderColor: =ColorFade(Self.BorderColor, -20%)
                HoverColor: =Self.Color
                HoverFill: =ColorFade(Self.Fill, -5%)
                InputTextPlaceholder: ="表格部門/服務"
                Items: =Distinct(FilterDepartment,DepartMentName)
                NoSelectionText: ="表格部門/服務"
                PaddingLeft: =10
                PressedColor: =Self.Color
                PressedFill: =ColorFade(Self.Fill, -5%)
                SearchFields: =["Result"]
                SearchItems: =Search(Distinct(FilterDepartment,DepartMentName),drpFilterDepartment.SearchText,"Result")
                SelectionColor: =glbThemePrimaryColor
                SelectionFill: =ColorFade(Self.SelectionColor, 90%)
                Size: =10
                Width: =180
                X: =290
                Y: =20
                ZIndex: =1

            ComboBox1_formtype As combobox:
                BorderColor: =glbNeutralTertiaryColor
                BorderThickness: =1
                ChevronBackground: =RGBA(255, 255, 255, 1)
                ChevronDisabledBackground: =RGBA(0, 0, 0, 0)
                ChevronDisabledFill: =RGBA(202, 202, 202, 1)
                ChevronFill: =glbNeutralTertiaryColor
                ChevronHoverBackground: =ColorFade(Self.ChevronBackground, -5%)
                ChevronHoverFill: =ColorFade(Self.BorderColor, -20%)
                Color: =glbNeutralPrimaryColor
                DisplayFields: =["Result"]
                FocusedBorderThickness: =1
                Height: =32
                HoverBorderColor: =ColorFade(Self.BorderColor, -20%)
                HoverColor: =Self.Color
                HoverFill: =ColorFade(Self.Fill, -5%)
                InputTextPlaceholder: ="表格類型/單位"
                Items: =Distinct(FilterFormType,FormType)
                NoSelectionText: ="表格類型/單位"
                PaddingLeft: =10
                PressedColor: =Self.Color
                PressedFill: =ColorFade(Self.Fill, -5%)
                SearchFields: =["Result"]
                SearchItems: =Search(Distinct(FilterFormType,FormType),ComboBox1_formtype.SearchText,"Result")
                SelectionColor: =glbThemePrimaryColor
                SelectionFill: =ColorFade(Self.SelectionColor, 90%)
                Size: =10
                Width: =180
                X: =481
                Y: =20
                ZIndex: =2

            TextInput_namenumber As text:
                BorderColor: =glbNeutralTertiaryColor
                BorderThickness: =1
                Color: =glbNeutralPrimaryColor
                Default: =""
                FocusedBorderColor: =glbNeutralSecondaryColor
                FocusedBorderThickness: =1
                Height: =32
                HintText: ="請輸入表格編號或名稱"
                HoverBorderColor: =ColorFade(Self.BorderColor, -20%)
                HoverFill: =ColorFade(Self.Fill, -5%)
                PaddingBottom: =0
                PaddingLeft: =10
                PaddingRight: =0
                PaddingTop: =0
                PressedBorderColor: =ColorFade(Self.BorderColor, -20%)
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =10
                Width: =260
                X: =20
                Y: =20
                ZIndex: =3

            Search_button As icon.Add:
                BorderColor: =Self.Fill
                Color: =glbThemePrimaryColor
                DisabledBorderColor: =RGBA(219, 219, 219, 1)
                DisabledColor: =RGBA(149, 149, 149, 1)
                DisabledFill: =RGBA(244, 244, 244, 1)
                FocusedBorderColor: =Self.Fill
                Height: =32
                HoverBorderColor: =Self.Fill
                HoverFill: =ColorFade(Self.Fill, -15%)
                Icon: =Icon.Search
                OnSelect: |-
                    =ClearCollect(
                        FilterFormDepartment1,
                        Search(
                            Filter(
                                SortByColumns(
                                FilterFormDepartment,
                                "Modified",
                                Descending
                                ),
                                IsBlank(drpFilterDepartment.Selected.Result) || ModelDepartment in drpFilterDepartment.SelectedItems,
                                IsBlank(ComboBox1_formtype.Selected.Result) || ModelType in ComboBox1_formtype.SelectedItems,
                                (DateValue(Text(修改时间))>=DateValue(Text(TemplateStartDate_3.SelectedDate))&&DateValue(Text(修改时间))<=DateValue(Text(TemplateEndDate_3.SelectedDate)))   
                            ),
                            TextInput_namenumber.Text,
                            "ModelName",
                            "ModelFlowNumber"
                        )
                    )
                PaddingBottom: =2
                PaddingTop: =2
                PressedColor: =ColorFade(Self.Color, -15%)
                Width: =32
                X: =1030
                Y: =20
                ZIndex: =8

            Group1_2 As group:
                Height: =5
                Width: =5
                X: =20
                Y: =-40
                ZIndex: =8

                DateBackground_4 As text:
                    BorderColor: =
                    BorderThickness: =1
                    Color: =
                    Default: =""
                    DisabledFill: =RGBA(255, 255, 255, 1)
                    DisplayMode: =DisplayMode.Disabled
                    FocusedBorderColor: =
                    FocusedBorderThickness: =1
                    Font: =Font.Arial
                    Height: =32
                    HintText: =""
                    HoverBorderColor: =
                    HoverFill: =
                    PaddingBottom: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    PressedBorderColor: =
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =11
                    Width: =263
                    X: =671
                    Y: =20
                    ZIndex: =4

                TemplateEndDate_3 As datepicker:
                    BorderColor: =
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =0
                    Color: =RGBA(96, 94, 92, 1)
                    Fill: =RGBA(0, 0, 0, 0)
                    FocusedBorderThickness: =1
                    Font: =Font.Arial
                    Format: ="dd/mm/yyyy"
                    Height: =32
                    IconBackground: =RGBA(0, 0, 0, 0)
                    IconFill: =glbNeutralSecondaryColor
                    InputTextPlaceholder: =//If(IsBlank(Self.SelectedDate), Text(Date(2001,12,31), Self.Format, Self.Language))
                    OnChange: |-
                        =/*If(
                            IsBlank(StartDate.SelectedDate) || IsBlank(EndDate.SelectedDate),
                            UpdateContext({DateErrorMessage: false}),
                            If(
                            EndDate.SelectedDate < StartDate.SelectedDate,
                            UpdateContext({DateErrorMessage: true})
                        ));*/
                        If(TemplateEndDate_3.SelectedDate < TemplateStartDate_3.SelectedDate,Notify("The end time must be greater than the start time");Reset(TemplateEndDate_3))
                    OnSelect: =
                    PaddingBottom: =0
                    PaddingRight: =0
                    Size: =10
                    Width: =120
                    X: =814
                    Y: =20
                    ZIndex: =5

                TemplateStartDate_3 As datepicker:
                    BorderColor: =
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =0
                    Color: =RGBA(96, 94, 92, 1)
                    DefaultDate: =Today()-30
                    Fill: =RGBA(0, 0, 0, 0)
                    FocusedBorderColor: =White
                    FocusedBorderThickness: =0
                    Font: =Font.Arial
                    Format: ="dd/mm/yyyy"
                    Height: =32
                    IconBackground: =RGBA(0, 0, 0, 0)
                    IconFill: =glbNeutralSecondaryColor
                    InputTextPlaceholder: =
                    PaddingBottom: =0
                    PaddingRight: =0
                    Size: =10
                    Width: =120
                    X: =672
                    Y: =20
                    ZIndex: =6

                DateLineLabel1_41 As label:
                    Align: =Align.Center
                    Color: =RGBA(149, 149, 149, 1)
                    Font: =Font.Arial
                    Height: =32
                    PaddingBottom: =3
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =10
                    Text: ="—"
                    Width: =16
                    X: =797
                    Y: =20
                    ZIndex: =7

            Icon1 As icon.Reset:
                Height: =32
                Icon: =Icon.Reset
                PaddingBottom: =2
                PaddingTop: =2
                Visible: =false
                Width: =32
                X: =968
                Y: =20
                ZIndex: =11

            Group23 As group:
                Height: =5
                Width: =5
                X: =40
                Y: =40
                ZIndex: =11

                Image5 As image:
                    Height: =32
                    Image: |-
                        ="data:image/svg+xml," & EncodeUrl("<svg width='15' height='15' viewBox='0 0 15 15' fill='none' xmlns='http://www.w3.org/2000/svg'> <path fill-rule='evenodd' clip-rule='evenodd' d='M4.10957 2.18765C4.20445 2.06904 4.34811 2 4.5 2H13.5C14.3284 2 15 2.67157 15 3.5V11.5C15 12.3284 14.3284 13 13.5 13H4.5C4.34811 13 4.20445 12.931 4.10957 12.8123L0.109566 7.81235C-0.0365219 7.62974 -0.0365219 7.37026 0.109566 7.18765L4.10957 2.18765ZM10.1465 9.85356L8.50004 8.20711L6.85359 9.85356L6.14648 9.14645L7.79293 7.50001L6.14648 5.85356L6.85359 5.14645L8.50004 6.7929L10.1465 5.14645L10.8536 5.85356L9.20714 7.50001L10.8536 9.14645L10.1465 9.85356Z' fill='#cccccc'/> </svg>")
                    PaddingBottom: =4
                    PaddingTop: =4
                    Width: =32
                    X: =968
                    Y: =20
                    ZIndex: =9

                Reset_button As icon.Add:
                    BorderColor: =glbNeutralQuaternaryColor
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =1
                    Color: =RGBA(0, 0, 0, 0)
                    DisabledBorderColor: =RGBA(219, 219, 219, 1)
                    DisabledColor: =RGBA(149, 149, 149, 1)
                    DisabledFill: =RGBA(244, 244, 244, 1)
                    FocusedBorderThickness: =1
                    Height: =32
                    HoverBorderColor: =RGBA(0, 0, 0, 0)
                    HoverColor: =RGBA(0, 0, 0, 0)
                    HoverFill: =RGBA(0, 0, 0, 0)
                    Icon: =Icon.Erase
                    OnSelect: |-
                        =Reset(TextInput_namenumber);
                        Reset([@ComboBox1_formtype]);
                        Reset([@drpFilterDepartment]);
                        Reset(TemplateEndDate_3);
                        Reset(TemplateStartDate_3);
                        Select(Search_button);
                    PaddingBottom: =8
                    PaddingTop: =8
                    PressedBorderColor: =ColorFade(glbThemePrimaryColor, -15%)
                    PressedColor: =Transparent
                    PressedFill: =Transparent
                    Width: =32
                    X: =968
                    Y: =20
                    ZIndex: =10

        Container5_6 As groupContainer.manualLayoutContainer:
            BorderColor: =RGBA(56, 96, 178, 1)
            Fill: =RGBA(255, 255, 255, 1)
            Height: =626
            Width: =1101
            X: =12
            Y: =135
            ZIndex: =2

            Container2_3 As groupContainer.manualLayoutContainer:
                Fill: =RGBA(255, 255, 255, 1)
                Height: =40
                Width: =1101
                ZIndex: =1

                Label4_14 As label:
                    Align: =Align.Center
                    Color: =glbNeutralPrimaryColor
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =12
                    Text: ="名稱"
                    Width: =212
                    X: =133
                    ZIndex: =2

                Label4_16 As label:
                    Align: =Align.Center
                    Color: =glbNeutralPrimaryColor
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =12
                    Text: ="類型/單位"
                    Width: =200
                    X: =496
                    ZIndex: =3

                Label4_15 As label:
                    Align: =Align.Center
                    Color: =glbNeutralPrimaryColor
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =12
                    Text: ="部門/服務"
                    Width: =151
                    X: =345
                    ZIndex: =4

                Label4_17 As label:
                    Align: =Align.Center
                    Color: =glbNeutralPrimaryColor
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =12
                    Text: ="修改人及日期"
                    Width: =120
                    X: =696
                    ZIndex: =5

                Label4_19 As label:
                    Align: =Align.Center
                    Color: =glbNeutralPrimaryColor
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =12
                    Text: ="編號"
                    Width: =82
                    X: =18
                    ZIndex: =7

            "Gallery_Form As gallery.'BrowseLayout_Vertical_ThreeTextVariant_ver4.0'":
                Fill: =RGBA(255, 255, 255, 1)
                Height: =582
                Items: |-
                    =//Sort(FilterFormDepartment1,Modified,Descending)
                    FilterFormDepartment1
                Layout: =Layout.Vertical
                OnSelect: |+
                    =Set(ShowSavebutton,false);
                    Set(attachment,DisplayMode.Disabled);
                    Set(NoEdit,DisplayMode.Disabled);//設置編輯模式下，不可編輯部門類型編號
                    Reset(drpFilter_Department);
                    Reset(drpFilter_FormType);
                    Reset(TextInput_FormVersion);
                    Reset(TextInput_FormName);
                    Reset(TextInput_FormNumber);
                    Reset(TextInput_FormDescription);
                    Reset(TextInput_CustomFilter);
                    Reset(Attachment_Form);
                    Reset(Attachment_Demonstrationform);
                    Reset(Attachment_FillGuide);
                    Reset(Radio_attachment);
                    Reset(Radio_password);
                    Reset(Radio_password_1);
                    Reset(Radio_flowtype);
                    Reset(Checkbox1_3);
                    Reset(Checkbox1_4);
                    Reset(Checkbox1_5);
                    Reset(Checkbox1_6);
                    Navigate(AdminFormDetailScreen,ScreenTransition.Fade);
                    ClearCollect(EditForm,ThisItem);
                    ClearCollect(EditAttachment,Filter(TemplateFileList,GenericFormId=ThisItem.标题&&TempType=ThisItem.ModelType));
                    ClearCollect(EditAttachment2,Filter(TemplateFileList,GenericFormId=ThisItem.标题&&TempType="示範表格TT"));
                    ClearCollect(EditAttachment3,Filter(TemplateFileList,GenericFormId=ThisItem.标题&&TempType="填寫指引TT"));
                    ClearCollect(CreateNewForm,{name:"查看表格"&"-"&ThisItem.ModelName});//創建集合變更編輯表格頁標題
                    
                    
                TemplatePadding: =0
                TemplateSize: =48
                Width: =1100
                X: =1
                Y: =40
                ZIndex: =1

                Separator7 As rectangle:
                    Fill: =glbNeutralLightColor
                    Height: =1
                    OnSelect: =Select(Parent)
                    Width: =Parent.TemplateWidth
                    Y: =Parent.TemplateHeight - 1
                    ZIndex: =1

                FormDepartment As label:
                    Align: =Align.Center
                    Color: =glbNeutralSecondaryColor
                    Height: =18
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =10
                    Text: =ThisItem.ModelDepartment
                    Tooltip: =ThisItem.ModelDepartment
                    VerticalAlign: =VerticalAlign.Top
                    Width: =151
                    Wrap: =false
                    X: =345
                    Y: =14
                    ZIndex: =2

                FormName As label:
                    Align: =Align.Center
                    Color: =glbNeutralSecondaryColor
                    Height: =20
                    HoverColor: =glbLinkColor
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =10
                    Text: =ThisItem.ModelName
                    Tooltip: =ThisItem.ModelName
                    VerticalAlign: =VerticalAlign.Top
                    Width: =212
                    Wrap: =false
                    X: =133
                    Y: =14
                    ZIndex: =3

                ModifiedBy As label:
                    Align: =Align.Center
                    Color: =glbNeutralSecondaryColor
                    Height: =45
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =10
                    Text: |-
                        =//ThisItem.'Modified By'.DisplayName & Char(13) & ThisItem.Modified;
                        //ThisItem.'Modified By'.DisplayName&Char(10)&Text(ThisItem.Modified,"dd/mm/yyyy hh:mm" )
                        ThisItem.修改者.DisplayName&Char(10)&Text(ThisItem.修改时间,"dd/mm/yyyy hh:mm" )
                    Tooltip: =ThisItem.修改者.DisplayName
                    VerticalAlign: =VerticalAlign.Top
                    Width: =120
                    Wrap: =false
                    X: =696
                    Y: =7
                    ZIndex: =4

                FormNumber As label:
                    Align: =Align.Center
                    Color: =glbNeutralSecondaryColor
                    Height: =22
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =10
                    Text: =ThisItem.ModelFlowNumber
                    VerticalAlign: =VerticalAlign.Top
                    Width: =82
                    Wrap: =false
                    X: =18
                    Y: =14
                    ZIndex: =5

                FormType As label:
                    Align: =Align.Center
                    Color: =glbNeutralSecondaryColor
                    Height: =18
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =10
                    Text: =ThisItem.ModelType
                    Tooltip: =ThisItem.ModelType
                    VerticalAlign: =VerticalAlign.Top
                    Width: =200
                    Wrap: =false
                    X: =496
                    Y: =14
                    ZIndex: =6

                Disable_button As button:
                    AutoDisableOnSelect: =false
                    BorderColor: =
                    BorderStyle: =BorderStyle.None
                    DisabledColor: =RGBA(0, 0, 0, 1)
                    Fill: =If(Self.Text="停用表格",glbErrorColor,glbSuccessColor)
                    FontWeight: =FontWeight.Normal
                    Height: =34
                    OnSelect: |+
                        =If(ThisItem.ModelName in ApprovalDetailColwithFormName1.FormName, Notify("該表單有待處理任務，當前無法停用，請處理后再停用",Warning),
                        
                        
                        If(Disable_button.Text="啓用表格",UpdateContext({Isenable:0}),UpdateContext({Isenable:1}));
                        If(Isenable=1,UpdateContext({Isenable:0}),Isenable=0,UpdateContext({Isenable:1}));
                        If(Isenable=1,UpdateIf(GenericFormModel,ModelName=FormName.Text,{IsEnable:1}),Isenable=0,UpdateIf(GenericFormModel,ModelName=FormName.Text,{IsEnable:0}));
                        ClearCollect(FilterForm,GenericFormModel))
                        
                    Size: =10
                    Text: =If(ThisItem.IsSelected,If(Isenable=0,"啓用表格","停用表格"),If(ThisItem.IsEnable="0","啓用表格","停用表格"))
                    Visible: =false
                    Width: =79
                    X: =980
                    Y: =7
                    ZIndex: =9

                Toggle1_1 As toggleSwitch:
                    Default: =If(ThisItem.IsEnable="1",true,ThisItem.IsEnable="0",false)
                    DisabledBorderColor: =RGBA(0, 13, 75, 1)
                    DisplayMode: |-
                        =//If(ThisItem.ModelName in ApprovalDetailColwithFormName1.FormName,Disabled,DisplayMode.Edit)
                        DisplayMode.Edit
                    FalseFill: =RGBA(202, 202, 202, 1)
                    FalseText: ="停用中"
                    FocusedBorderThickness: =0
                    Height: =24
                    OnCheck: =//If(ThisItem.ModelName in ApprovalDetailColwithFormName1.FormName,Notify("該表單有待處理任務，當前無法停用，請處理后再停用",Warning))
                    OnSelect: |
                        =/*If(
                            ThisItem.ModelName in ApprovalDetailColwithFormName1.FormName,
                            Notify(
                                "該表單有待處理任務，當前無法停用，請處理后再停用",
                                Warning
                            ),*/
                            If(
                                ThisItem.IsEnable = "1",
                                UpdateIf(
                                    GenericFormModel,
                                    ModelName = FormName.Text,
                                    {IsEnable: 0}
                                ),
                                ThisItem.IsEnable = "0",
                                UpdateIf(
                                    GenericFormModel,
                                    ModelName = FormName.Text,
                                    {IsEnable: 1}
                                )
                            );
                        //);
                        Select(Reset_button);
                    OnUncheck: =
                    Size: =10
                    Tooltip: =
                    TrueFill: =glbThemePrimaryColor
                    TrueText: ="使用中"
                    Width: =102
                    X: =938
                    Y: =12
                    ZIndex: =10

                Group22 As group:
                    Height: =5
                    Width: =5
                    X: =40
                    Y: =40
                    ZIndex: =11

                    Image5_2 As image:
                        Height: =32
                        Image: |-
                            ="data:image/svg+xml," & EncodeUrl("<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' version='1.1' id='mdi-square-edit-outline' width='24' height='24' viewBox='0 0 24 24'><path fill='#2C4D96' d='M5,3C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19H5V5H12V3H5M17.78,4C17.61,4 17.43,4.07 17.3,4.2L16.08,5.41L18.58,7.91L19.8,6.7C20.06,6.44 20.06,6 19.8,5.75L18.25,4.2C18.12,4.07 17.95,4 17.78,4M15.37,6.12L8,13.5V16H10.5L17.87,8.62L15.37,6.12Z' /></svg>")
                        PaddingBottom: =4
                        PaddingTop: =4
                        Width: =32
                        X: =858
                        Y: =9
                        ZIndex: =7

                    Edit_button As button:
                        AutoDisableOnSelect: =false
                        BorderStyle: =BorderStyle.None
                        Color: =RGBA(0, 0, 0, 0)
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =32
                        HoverColor: =RGBA(0, 0, 0, 0)
                        HoverFill: =RGBA(0, 0, 0, 0)
                        OnSelect: |
                            =Reset(drpFilter_Department);
                            Reset(drpFilter_FormType);
                            Reset(TextInput_FormVersion);
                            Reset(TextInput_FormName);
                            Reset(TextInput_FormNumber);
                            Reset(TextInput_FormDescription);
                            Reset(TextInput_CustomFilter);
                            Reset(Attachment_Form);
                            Reset(Attachment_Demonstrationform);
                            Reset(Attachment_FillGuide);
                            Reset(Radio_attachment);
                            Reset(Radio_password);
                            Reset(Radio_password_1);
                            Reset(Radio_flowtype);
                            Reset(Checkbox1_3);
                            Reset(Checkbox1_4);
                            Reset(Checkbox1_5);
                            Reset(Checkbox1_6);
                            Set(ShowSavebutton,true);
                            Set(attachment,DisplayMode.Edit);
                            Set(NoEdit,DisplayMode.Disabled);//設置編輯模式下，不可編輯部門類型編號
                            Navigate(AdminFormDetailScreen,ScreenTransition.Fade);
                            ClearCollect(EditForm,Filter(FilterFormDepartment1,ModelFlowNumber = ThisItem.ModelFlowNumber));
                            //ClearCollect(EditAttachment,Filter(TemplateFileList,GenericFormId=ThisItem.Title&&TempType=ThisItem.ModelType));//編輯表格類型后不可用，下面方法替換
                            ClearCollect(EditAttachment,Filter(TemplateFileList,GenericFormId=ThisItem.标题&&TempType=ThisItem.ModelType));
                            ClearCollect(EditAttachment2,Filter(TemplateFileList,GenericFormId=ThisItem.标题&&TempType="示範表格TT"));
                            ClearCollect(EditAttachment3,Filter(TemplateFileList,GenericFormId=ThisItem.标题&&TempType="填寫指引TT"));
                            ClearCollect(CreateNewForm,{name:"編輯表格"&"-"&ThisItem.ModelName});//創建集合變更編輯表格頁標題
                        PressedColor: =RGBA(0, 0, 0, 0)
                        PressedFill: =RGBA(0, 0, 0, 0)
                        Size: =12
                        Text: ="編輯"
                        Width: =32
                        X: =858
                        Y: =9
                        ZIndex: =8

        Container5 As groupContainer.manualLayoutContainer:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =50
            Width: =1101
            X: =12
            ZIndex: =6

            Label9_15 As label:
                Color: =glbNeutralPrimaryColor
                Height: =50
                PaddingBottom: =0
                PaddingLeft: =10
                PaddingRight: =0
                PaddingTop: =0
                Size: =15
                Text: ="表格管理"
                Width: =156
                X: =10
                ZIndex: =1

            BtnLgIcon_3 As group:
                Height: =5
                Width: =5
                X: =-1053
                Y: =9
                ZIndex: =3

                BtnPrimary_5 As button:
                    BorderColor: =Self.Fill
                    BorderThickness: =1
                    Color: =White
                    DisabledBorderColor: =RGBA(219, 219, 219, 1)
                    Fill: =glbThemePrimaryColor
                    FocusedBorderThickness: =1
                    FontWeight: =FontWeight.Normal
                    Height: =32
                    HoverFill: =ColorFade(Self.Fill, -15%)
                    OnSelect: |-
                        =Set(ShowSavebutton,true);//設置保存按鈕可見
                        Set(attachment,DisplayMode.Edit);//設置附件可編輯
                        Set(NoEdit,DisplayMode.Edit);//設置編輯模式下，不可編輯部門類型編號
                        Navigate(AdminFormDetailScreen,ScreenTransition.Fade);
                        Clear(EditForm);
                        Clear(EditAttachment);
                        Clear(EditAttachment2);
                        Clear(EditAttachment3);
                        Reset(drpFilter_Department);
                        Reset(drpFilter_FormType);
                        Reset(TextInput_FormVersion);
                        Reset(TextInput_FormName);
                        Reset(TextInput_FormNumber);
                        Reset(TextInput_FormDescription);
                        Reset(TextInput_CustomFilter);
                        Reset(Attachment_Form);
                        Reset(Attachment_Demonstrationform);
                        Reset(Attachment_FillGuide);
                        Reset(Radio_attachment);
                        Reset(Radio_password);
                        Reset(Radio_password_1);
                        Reset(Radio_flowtype);
                        Reset(Checkbox1_3);
                        Reset(Checkbox1_4);
                        Reset(Checkbox1_5);
                        Reset(Checkbox1_6);
                        ClearCollect(CreateNewForm,{name:"新增表格"});//創建集合變更新增表格頁標題
                    PaddingBottom: =0
                    PaddingLeft: =20
                    PaddingRight: =0
                    PaddingTop: =0
                    PressedColor: =White
                    PressedFill: =ColorFade(Self.Fill, -25%)
                    RadiusBottomLeft: =4
                    RadiusBottomRight: =4
                    RadiusTopLeft: =4
                    RadiusTopRight: =4
                    Size: =10
                    Text: ="新增表格"
                    Width: =100
                    X: =977
                    Y: =9
                    ZIndex: =2

                Icon4_27 As icon.Add:
                    Color: =RGBA(255, 255, 255, 1)
                    DisabledColor: =RGBA(149, 149, 149, 1)
                    Height: =16
                    Icon: =Icon.Add
                    OnSelect: |-
                        =Set(ShowSavebutton,true);//設置保存按鈕可見
                        Set(attachment,DisplayMode.Edit);//設置附件可編輯
                        Set(NoEdit,DisplayMode.Edit);//設置編輯模式下，不可編輯部門類型編號
                        Navigate(AdminFormDetailScreen,ScreenTransition.Fade);
                        Clear(EditForm);
                        Clear(EditAttachment);
                        Clear(EditAttachment2);
                        Clear(EditAttachment3);
                        Reset(drpFilter_Department);
                        Reset(drpFilter_FormType);
                        Reset(TextInput_FormVersion);
                        Reset(TextInput_FormName);
                        Reset(TextInput_FormNumber);
                        Reset(TextInput_FormDescription);
                        Reset(TextInput_CustomFilter);
                        Reset(Attachment_Form);
                        Reset(Attachment_Demonstrationform);
                        Reset(Attachment_FillGuide);
                        Reset(Radio_attachment);
                        Reset(Radio_password);
                        Reset(Radio_password_1);
                        Reset(Radio_flowtype);
                        Reset(Checkbox1_3);
                        Reset(Checkbox1_4);
                        Reset(Checkbox1_5);
                        Reset(Checkbox1_6);
                        ClearCollect(CreateNewForm,{name:"新增表格"});//創建集合變更新增表格頁標題
                    PressedColor: =White
                    Width: =16
                    X: =984
                    Y: =17
                    ZIndex: =3

    Container3_4 As groupContainer.manualLayoutContainer:
        Fill: =RGBA(255, 255, 255, 1)
        Height: =768
        Width: =240
        ZIndex: =3

        GalleryNav_8 As gallery.galleryVertical:
            Height: =327
            Items: |
                =Filter(If(
                    CurrentRoleFormModelPermssion = "None"
                    ,
                    [
                        "首頁",
                        "申請記錄",
                        If(CurrentRole,"數據統計",CurrentRole || HRAO || SuperUser,"系統設定"),
                        If(If(CurrentRole,"數據統計",CurrentRole || HRAO || SuperUser,"系統設定")="系統設定",Blank(),CurrentRole || HRAO || SuperUser,"系統設定")
                        
                    ],
                    [
                        "首頁",
                        "表格資料",
                        "申請記錄",
                        If(CurrentRole,"數據統計",CurrentRole || HRAO || SuperUser,"系統設定"),
                        If(If(CurrentRole,"數據統計",CurrentRole || HRAO || SuperUser,"系統設定")="系統設定",Blank(),CurrentRole || HRAO || SuperUser,"系統設定")
                    ]
                ),ThisRecord.Value <> Blank())
            Layout: =Layout.Vertical
            OnSelect: =
            TemplateFill: =If(ThisItem.Value="表格資料", RGBA(102,182,227,0.2),Transparent)
            TemplatePadding: =0
            TemplateSize: =46
            Width: =240
            Y: =100
            ZIndex: =1

            BtnDefault_10 As button:
                Align: =Align.Left
                BorderColor: =RGBA(255, 255, 255, 1)
                BorderThickness: =0
                Color: =If(ThisItem.Value="表格資料", glbThemePrimaryColor,glbNeutralSecondaryColor)
                DisabledBorderColor: =
                Fill: =If(ThisItem.Value="表格資料", ColorFade(Self.Color, 90%),White)
                FocusedBorderThickness: =1
                FontWeight: =If(ThisItem.Value="表格資料", FontWeight.Semibold,Normal)
                Height: =46
                HoverBorderColor: =
                HoverColor: =ColorFade(Self.Color, -15%)
                HoverFill: =If(ThisItem.Value<>Blank(),ColorFade(glbThemePrimaryColor, 90%))
                OnSelect: |-
                    =If(
                        ThisItem.Value = "首頁",
                        Navigate(
                            HomepageScreen,
                            ScreenTransition.None
                        ),
                        ThisItem.Value = "表格資料",
                        Navigate(AdminFormListScreen,
                            ScreenTransition.None
                        ),
                        ThisItem.Value = "數據統計",
                        Navigate(StatisticsScreen,
                            ScreenTransition.None
                        //Launch("https://apps.powerapps.com/play/c030168f-5133-4c9d-8e17-3c870ba99ab4?tenantId=b7a4bbdd-6e9c-4929-b5a4-6550feead77c&Screen=StatisticsScreen"
                        ),
                    
                        ThisItem.Value = "系統設定",
                        Navigate(SystemsScreen,None,{ToUserInfoManager:"用戶管理"}),
                        //Launch("https://apps.powerapps.com/play/c030168f-5133-4c9d-8e17-3c870ba99ab4?tenantId=b7a4bbdd-6e9c-4929-b5a4-6550feead77c&Screen=UserScreen"),
                    
                        ThisItem.Value = "申請記錄",
                        Navigate(
                            GeneralFormListScreen,
                            ScreenTransition.None,{ListID:1}
                        )
                    )
                PaddingBottom: =0
                PaddingLeft: =104
                PaddingRight: =0
                PaddingTop: =0
                PressedBorderColor: =
                PressedColor: =ColorFade(Self.Color, -25%)
                PressedFill: =
                RadiusBottomLeft: =4
                RadiusBottomRight: =4
                RadiusTopLeft: =4
                RadiusTopRight: =4
                Size: =12
                Text: =ThisItem.Value
                Width: =240
                Y: =2
                ZIndex: =1

            Image2_5 As image:
                Height: =30
                Image: |
                    =If(
                        ThisItem.Value = "首頁",
                        首页,
                        ThisItem.Value = "表格資料",
                        表格资料,
                        ThisItem.Value = "數據統計",
                        数据,
                        ThisItem.Value = "系統設定",
                        设置,
                        ThisItem.Value = "申請記錄",
                        申请列表
                    )
                OnSelect: =Select(Parent)
                Width: =30
                X: =60
                Y: =10
                ZIndex: =2

        GalleryNav_11 As gallery.galleryVertical:
            Height: =60
            Items: =["IT服務台","用戶手冊","意見收集"]
            Layout: =Layout.Vertical
            TemplatePadding: =0
            TemplateSize: =60
            Width: =240
            WrapCount: =3
            Y: =690
            ZIndex: =5

            Image2_6 As image:
                Height: =26
                Image: |
                    =If(
                        ThisItem.Value = "IT服務台",
                        工作台,
                        ThisItem.Value = "用戶手冊",
                        手册,
                        ThisItem.Value = "意見收集",
                        意见箱
                    )
                OnSelect: =Select(Parent)
                Width: =26
                X: =27
                Y: =6
                ZIndex: =1

            BtnDefault_13 As button:
                BorderColor: =Self.Color
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =glbNeutralSecondaryColor
                DisabledBorderColor: =RGBA(219, 219, 219, 1)
                DisabledFill: =RGBA(0, 0, 0, 0)
                Fill: =RGBA(0, 0, 0, 0)
                FocusedBorderThickness: =1
                FontWeight: =Normal
                Height: =60
                HoverBorderColor: =ColorFade(Self.Color, -15%)
                HoverColor: =ColorFade(Self.Color, -15%)
                HoverFill: =
                OnSelect: |-
                    =If(
                        ThisItem.Value = "意見收集",
                        Launch("https://forms.office.com/r/QtGdCLDD9X"),
                        ThisItem.Value = "IT服務台",
                        Launch("https://elcss-14cebfd770be55.sharepoint.com/sites/elcssbriefcase/HelpDeskPlus/Pages/Default.aspx?SPHostUrl=https%3A%2F%2Felcss%2Esharepoint%2Ecom%2Fsites%2Felcssbriefcase&SPLanguage=en%2DUS&SPClientTag=1&SPProductNumber=16%2E0%2E22112%2E12002&SPAppWebUrl=https%3A%2F%2Felcss%2D14cebfd770be55%2Esharepoint%2Ecom%2Fsites%2Felcssbriefcase%2FHelpDeskPlus"),
                        ThisItem.Value = "用戶手冊",
                        Download("https://elcss.sharepoint.com/:b:/r/sites/eps-uat-2/Shared%20Documents/TempFile/eProcessing%20System_%E7%94%A8%E6%88%B7%E6%89%8B%E5%86%8AV0.3.pdf?csf=1&web=1&e=WGBvrp")
                    )
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =34
                PressedBorderColor: =ColorFade(Self.Color, -25%)
                PressedColor: =ColorFade(Self.Color, -25%)
                PressedFill: =
                RadiusBottomLeft: =4
                RadiusBottomRight: =4
                RadiusTopLeft: =4
                RadiusTopRight: =4
                Size: =9
                Text: =ThisItem.Value
                Width: =70
                X: =5
                ZIndex: =2

        Label8_2 As label:
            Color: =RGBA(149, 149, 149, 1)
            Height: =20
            Italic: =true
            Size: =8
            Text: ="Version 1.0.0"
            Width: =160
            X: =64
            Y: =56
            ZIndex: =6

        Image8_1 As image:
            Height: =40
            Image: =logo_only_icon
            Width: =40
            X: =20
            Y: =10
            ZIndex: =7

        Label1_97 As label:
            Color: =RGBA(54, 52, 52, 1)
            Height: =21
            Size: =12
            Text: ="ELCSS-HK"
            Width: =100
            X: =64
            Y: =10
            ZIndex: =9

        Label1_98 As label:
            Color: =RGBA(116, 116, 116, 1)
            Height: =21
            Size: =7
            Text: ="eProcessing System (ePS)"
            Width: =160
            X: =64
            Y: =31
            ZIndex: =10


GeneralFormListScreen As screen:
    Fill: =RGBA(243, 243, 243, 1)
    OnVisible: |-
        =ClearCollect(approvalCol,Approval_Table);
        //生成待处理集合
        ClearCollect(ApprovalDetailCol,Filter(ShowColumns(ApprovalDetail_Table,"Title","field_Approval_No","field_Approver","field_ApproverEmail","field_Priortty","field_TaskStatus","field_AgentUserEmail"),field_TaskStatus="001"||field_TaskStatus="002"));
        //生成已处理集合
        ClearCollect(ProcessedDetailCol,Filter(ShowColumns(ApprovalDetail_Table,"Title","field_Approval_No","field_Approver","field_ApproverEmail","field_Priortty","field_TaskStatus","Editor","field_AgentUserEmail"),field_TaskStatus="004"||field_TaskStatus="006"||field_TaskStatus="000"));
        //全部集合
        ClearCollect(ComplatelDetailCol,Filter(ShowColumns(ApprovalDetail_Table,"Title","field_Approval_No","field_Approver","field_ApproverEmail","field_Priortty","field_TaskStatus","Editor","field_AgentUserEmail"),field_TaskStatus="000"||field_TaskStatus="001"||field_TaskStatus="004"||field_TaskStatus="006"||field_TaskStatus="002"));
        
        With({SearchPendingData:Filter(ApprovalDetailCol,(CurrentUser in field_ApproverEmail||CurrentUser<>Blank()&&CurrentUser in field_AgentUserEmail))},ClearCollect(FilterPendingDataCol,AddColumns(SearchPendingData,"FlowTaskName",LookUp(approvalCol,Title=field_Approval_No).Task_Name,"FlowOrder",LookUp(approvalCol,Title=field_Approval_No).Application_No,"FlowCreateDate",LookUp(approvalCol,Title=field_Approval_No).Created,"DepartMentName",LookUp(approvalCol,Title=field_Approval_No).DepartMentName,"FormType",LookUp(approvalCol,Title=field_Approval_No).FormType,"Application_Status",LookUp(approvalCol,Title=field_Approval_No).Application_Status)));
        ///生成已处理集合
        With({ProcessedListCol:Filter(ProcessedDetailCol,(CurrentUser in field_ApproverEmail||CurrentUser<>Blank()&&CurrentUser in field_AgentUserEmail))},ClearCollect(inprogressData,AddColumns(ProcessedListCol,"FlowTaskName",LookUp(approvalCol,Title=field_Approval_No).Task_Name,"FlowOrder",LookUp(approvalCol,Title=field_Approval_No).Application_No,"FlowCreateDate",LookUp(approvalCol,Title=field_Approval_No).Created,"DepartMentName",LookUp(approvalCol,Title=field_Approval_No).DepartMentName,"FormType",LookUp(approvalCol,Title=field_Approval_No).FormType,"Application_Status",LookUp(approvalCol,Title=field_Approval_No).Application_Status)));
        // 生成所有集合
        With({AllApprovalList:Filter(ComplatelDetailCol,(CurrentUser in field_ApproverEmail||CurrentUser<>Blank()&&CurrentUser in field_AgentUserEmail)&&field_TaskStatus<>Blank())},ClearCollect(AllApprovalListDataCol,AddColumns(AllApprovalList,"FlowTaskName",LookUp(approvalCol,Title=field_Approval_No).Task_Name,"FlowOrder",LookUp(approvalCol,Title=field_Approval_No).Application_No,"FlowCreateDate",LookUp(approvalCol,Title=field_Approval_No).Created,"DepartMentName",LookUp(approvalCol,Title=field_Approval_No).DepartMentName,"FormType",LookUp(approvalCol,Title=field_Approval_No).FormType,"Application_Status",LookUp(approvalCol,Title=field_Approval_No).Application_Status)));
        Select(BtnLgIconOnly_4);

    ContainerTitle As groupContainer.manualLayoutContainer:
        Fill: =glbThemePrimaryColor
        Height: =50
        Width: =1366
        ZIndex: =1

        Image1_2 As image:
            Height: =38
            Image: =logo
            Width: =203
            X: =15
            Y: =5
            ZIndex: =1

        Circle1_3 As circle:
            BorderColor: =RGBA(255, 255, 255, 1)
            BorderThickness: =1
            Fill: =RGBA(0, 0, 0, 0)
            Height: =32
            Width: =32
            X: =1318
            Y: =8
            ZIndex: =2

        Label1_74 As label:
            Color: =RGBA(255, 255, 255, 1)
            Fill: =glbThemePrimaryColor
            Height: =18
            Size: =9
            Text: ="基督教香港信義會社會服務部"
            Width: =186
            X: =63
            Y: =5
            ZIndex: =3

        Label1_75 As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            Height: =32
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =9
            Text: ="HG"
            Width: =32
            X: =1318
            Y: =8
            ZIndex: =4

        Label1_76 As label:
            Color: =RGBA(255, 255, 255, 1)
            Fill: =glbThemePrimaryColor
            FontWeight: =FontWeight.Bold
            Height: =24
            Size: =12
            Text: ="SYSTEM NAME"
            Width: =186
            X: =63
            Y: =22
            ZIndex: =5

    ContainerMain As groupContainer.manualLayoutContainer:
        Fill: =RGBA(247, 247, 247, 1)
        Height: =718
        Width: =1206
        X: =160
        Y: =50
        ZIndex: =3

        Container5_2 As groupContainer.manualLayoutContainer:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =130
            Width: =1182
            X: =12
            Y: =16
            ZIndex: =4

            ComboBox1_5 As combobox:
                BorderColor: =glbNeutralTertiaryColor
                BorderThickness: =1
                ChevronBackground: =RGBA(255, 255, 255, 1)
                ChevronDisabledBackground: =RGBA(0, 0, 0, 0)
                ChevronDisabledFill: =RGBA(202, 202, 202, 1)
                ChevronFill: =glbNeutralTertiaryColor
                ChevronHoverBackground: =ColorFade(Self.ChevronBackground, -5%)
                ChevronHoverFill: =ColorFade(Self.BorderColor, -20%)
                Color: =glbNeutralPrimaryColor
                DisplayFields: =["Value"]
                FocusedBorderThickness: =0
                Height: =32
                HoverBorderColor: =ColorFade(Self.BorderColor, -20%)
                HoverColor: =Self.Color
                HoverFill: =ColorFade(Self.Fill, -5%)
                InputTextPlaceholder: ="選擇部門"
                Items: =["行政部","財務部",""]
                PaddingLeft: =10
                PressedColor: =Self.Color
                PressedFill: =ColorFade(Self.Fill, -5%)
                SearchFields: =["Value"]
                SearchItems: =Search(["行政部","財務部",""],ComboBox1_5.SearchText,"Value")
                SelectionColor: =glbThemePrimaryColor
                SelectionFill: =ColorFade(Self.SelectionColor, 90%)
                Size: =11
                Width: =180
                X: =290
                Y: =80
                ZIndex: =1

            ComboBox1_6 As combobox:
                BorderColor: =glbNeutralTertiaryColor
                BorderThickness: =1
                ChevronBackground: =RGBA(255, 255, 255, 1)
                ChevronDisabledBackground: =RGBA(0, 0, 0, 0)
                ChevronDisabledFill: =RGBA(202, 202, 202, 1)
                ChevronFill: =glbNeutralTertiaryColor
                ChevronHoverBackground: =ColorFade(Self.ChevronBackground, -5%)
                ChevronHoverFill: =ColorFade(Self.BorderColor, -20%)
                Color: =glbNeutralPrimaryColor
                FocusedBorderThickness: =0
                Height: =32
                HoverBorderColor: =ColorFade(Self.BorderColor, -20%)
                HoverColor: =Self.Color
                HoverFill: =ColorFade(Self.Fill, -5%)
                InputTextPlaceholder: ="表格類型"
                Items: =ComboBoxSample
                PaddingLeft: =10
                PressedColor: =Self.Color
                PressedFill: =ColorFade(Self.Fill, -5%)
                SearchItems: =Search(ComboBoxSample,ComboBox1_6.SearchText,"Value1")
                SelectionColor: =glbThemePrimaryColor
                SelectionFill: =ColorFade(Self.SelectionColor, 90%)
                Size: =11
                Width: =180
                X: =480
                Y: =80
                ZIndex: =3

            BtnLgIconOnly_4 As icon.Add:
                BorderColor: =Self.Fill
                BorderThickness: =1
                Color: =RGBA(255, 255, 255, 1)
                DisabledBorderColor: =RGBA(219, 219, 219, 1)
                DisabledColor: =RGBA(149, 149, 149, 1)
                DisabledFill: =RGBA(244, 244, 244, 1)
                Fill: =glbThemePrimaryColor
                Height: =32
                HoverFill: =ColorFade(Self.Fill, -15%)
                Icon: =Icon.Search
                OnSelect: |-
                    =If(
                        TabGallery3_4.Selected.Value = "全部",
                        ClearCollect(
                            AllApprovalData,
                            Search(
                                Filter(
                                    SortByColumns(
                                        AllApprovalListDataCol,
                                        "FlowCreateDate",
                                        Descending
                                    ),
                                    IsBlank(ComboBox1_5.Selected.Value) || DepartMentName = ComboBox1_5.Selected.Value,
                                    IsBlank(ComboBox1_6.Selected.Value1) || FormType = ComboBox1_6.Selected.Value1,
                                    (DateValue(Text(FlowCreateDate)) >= DateValue(Text(TemplateStartDate_2.SelectedDate)) && DateValue(Text(FlowCreateDate)) <= DateValue(Text(TemplateEndDate_2.SelectedDate)))
                                ),
                                TextInput2_13.Text,
                                "FlowOrder",
                                "FlowTaskName"
                            )
                        ),
                        TabGallery3_4.Selected.Value = "待處理",
                        ClearCollect(
                            AllPendingApprovalData,
                            Search(
                                Filter(
                                    SortByColumns(
                                        FilterPendingDataCol,
                                        "FlowCreateDate",
                                        Descending
                                    ),
                                    IsBlank(ComboBox1_5.Selected.Value) || DepartMentName = ComboBox1_5.Selected.Value,
                                    IsBlank(ComboBox1_6.Selected.Value1) || FormType = ComboBox1_6.Selected.Value1,
                                    (DateValue(Text(FlowCreateDate)) >= DateValue(Text(TemplateStartDate_2.SelectedDate)) && DateValue(Text(FlowCreateDate)) <= DateValue(Text(TemplateEndDate_2.SelectedDate)))
                                ),
                                TextInput2_13.Text,
                                "FlowOrder",
                                "FlowTaskName"
                            )
                        ),
                        TabGallery3_4.Selected.Value = "已處理",
                        ClearCollect(
                            AllinprogressApprovalData,
                            Search(
                                Filter(
                                    SortByColumns(
                                        inprogressData,
                                        "FlowCreateDate",
                                        Descending
                                    ),
                                    IsBlank(ComboBox1_5.Selected.Value) || DepartMentName = ComboBox1_5.Selected.Value,
                                    IsBlank(ComboBox1_6.Selected.Value1) || FormType = ComboBox1_6.Selected.Value1,
                                    (DateValue(Text(FlowCreateDate)) >= DateValue(Text(TemplateStartDate_2.SelectedDate)) && DateValue(Text(FlowCreateDate)) <= DateValue(Text(TemplateEndDate_2.SelectedDate)))
                                ),
                                TextInput2_13.Text,
                                "FlowOrder",
                                "FlowTaskName"
                            )
                        )
                    )
                PaddingBottom: =8
                PaddingTop: =8
                PressedColor: =White
                PressedFill: =ColorFade(Self.Fill, -25%)
                Width: =32
                X: =947
                Y: =80
                ZIndex: =5

            BtnSecondIconOnly_4 As icon.Add:
                BorderColor: =glbNeutralQuaternaryColor
                BorderThickness: =1
                Color: =glbNeutralPrimaryColor
                DisabledBorderColor: =RGBA(219, 219, 219, 1)
                DisabledColor: =RGBA(149, 149, 149, 1)
                DisabledFill: =RGBA(244, 244, 244, 1)
                Fill: =White
                FocusedBorderThickness: =1
                Height: =32
                HoverBorderColor: =glbThemePrimaryColor
                HoverColor: =glbThemePrimaryColor
                HoverFill: =White
                Icon: =Icon.Erase
                OnSelect: =
                PaddingBottom: =8
                PaddingTop: =8
                PressedBorderColor: =ColorFade(glbThemePrimaryColor, -15%)
                PressedColor: =ColorFade(glbThemePrimaryColor, -15%)
                PressedFill: =ColorFade(glbThemePrimaryColor, 95%)
                Width: =32
                X: =989
                Y: =80
                ZIndex: =6

            LineRectangle_1 As rectangle:
                Fill: =RGBA(219, 219, 219, 1)
                Height: =1
                Width: =1142
                X: =20
                Y: =54
                ZIndex: =7

            TabGallery3_4 As gallery.galleryHorizontal:
                Height: =40
                Items: =["全部","待處理","已處理"]
                OnSelect: =//Select(BtnLgIconOnly_4);
                TemplatePadding: =0
                TemplateSize: =147
                Width: =996
                X: =20
                Y: =15
                ZIndex: =8

                Label2_3 As label:
                    Align: =Align.Center
                    Color: |-
                        =If(
                            ThisItem.IsSelected,
                            glbThemePrimaryColor,
                            glbNeutralSecondaryColor
                        )
                    FontWeight: |-
                        =If(
                            ThisItem.IsSelected,
                            FontWeight.Bold,
                            FontWeight.Normal
                        )
                    Height: =32
                    HoverColor: =glbThemePrimaryColor
                    OnSelect: =Select(BtnLgIconOnly_4);
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =15
                    Text: =ThisItem.Value
                    Width: =100
                    X: =24
                    ZIndex: =1

                Rectangle2_3 As rectangle:
                    Fill: =glbThemePrimaryColor
                    Height: =3
                    OnSelect: =Select(Parent)
                    Visible: =If(ThisItem.IsSelected, true, false)
                    Width: =100
                    X: =24
                    Y: =37
                    ZIndex: =2

            TextInput2_13 As text:
                BorderColor: =glbNeutralTertiaryColor
                BorderThickness: =1
                Color: =glbNeutralPrimaryColor
                Default: =""
                FocusedBorderColor: =glbNeutralSecondaryColor
                FocusedBorderThickness: =1
                Height: =32
                HintText: ="按表格名稱或編號搜索"
                HoverBorderColor: =ColorFade(Self.BorderColor, -20%)
                HoverFill: =ColorFade(Self.Fill, -5%)
                PaddingBottom: =0
                PaddingLeft: =10
                PaddingRight: =0
                PaddingTop: =0
                PressedBorderColor: =ColorFade(Self.BorderColor, -20%)
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =11
                Width: =260
                X: =20
                Y: =80
                ZIndex: =9

            Group1_1 As group:
                Height: =5
                Width: =5
                X: =-983
                Y: =-190
                ZIndex: =14

                DateBackground_3 As text:
                    BorderColor: =
                    BorderThickness: =1
                    Color: =
                    Default: =""
                    DisabledFill: =RGBA(255, 255, 255, 1)
                    DisplayMode: =DisplayMode.Disabled
                    FocusedBorderColor: =
                    FocusedBorderThickness: =1
                    Font: =Font.Arial
                    Height: =32
                    HintText: =""
                    HoverBorderColor: =
                    HoverFill: =
                    PaddingBottom: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    PressedBorderColor: =
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =11
                    Width: =263
                    X: =670
                    Y: =80
                    ZIndex: =10

                TemplateEndDate_2 As datepicker:
                    BorderColor: =
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =0
                    Color: =RGBA(96, 94, 92, 1)
                    Fill: =RGBA(0, 0, 0, 0)
                    FocusedBorderThickness: =1
                    Font: =Font.Arial
                    Format: ="dd/mm/yyyy"
                    Height: =30
                    IconBackground: =RGBA(0, 0, 0, 0)
                    IconFill: =glbNeutralSecondaryColor
                    InputTextPlaceholder: =//If(IsBlank(Self.SelectedDate), Text(Date(2001,12,31), Self.Format, Self.Language))
                    OnChange: |-
                        =/*If(
                            IsBlank(StartDate.SelectedDate) || IsBlank(EndDate.SelectedDate),
                            UpdateContext({DateErrorMessage: false}),
                            If(
                            EndDate.SelectedDate < StartDate.SelectedDate,
                            UpdateContext({DateErrorMessage: true})
                        ));*/
                        If(TemplateEndDate_2.SelectedDate < TemplateStartDate_2.SelectedDate,Notify("The end time must be greater than the start time");Reset(TemplateEndDate_2))
                    OnSelect: =
                    PaddingBottom: =0
                    PaddingRight: =0
                    Size: =11
                    Width: =120
                    X: =813
                    Y: =80
                    ZIndex: =11

                TemplateStartDate_2 As datepicker:
                    BorderColor: =
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =0
                    Color: =RGBA(96, 94, 92, 1)
                    DefaultDate: =Today()-30
                    Fill: =RGBA(0, 0, 0, 0)
                    FocusedBorderColor: =White
                    FocusedBorderThickness: =0
                    Font: =Font.Arial
                    Format: ="dd/mm/yyyy"
                    Height: =30
                    IconBackground: =RGBA(0, 0, 0, 0)
                    IconFill: =glbNeutralSecondaryColor
                    InputTextPlaceholder: =
                    PaddingBottom: =0
                    PaddingRight: =0
                    Size: =11
                    Width: =120
                    X: =671
                    Y: =80
                    ZIndex: =12

                DateLineLabel1_40 As label:
                    Align: =Align.Center
                    Color: =RGBA(149, 149, 149, 1)
                    Font: =Font.Arial
                    Height: =20
                    PaddingLeft: =0
                    Size: =10
                    Text: ="—"
                    Width: =16
                    X: =794
                    Y: =84
                    ZIndex: =13

        Container5_3 As groupContainer.manualLayoutContainer:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =559
            Width: =1182
            X: =12
            Y: =146
            ZIndex: =5

            Container2_2 As groupContainer.manualLayoutContainer:
                Fill: =RGBA(247, 247, 247, 1)
                Height: =40
                Width: =1142
                X: =20
                ZIndex: =1

                Label4_6 As label:
                    Align: =Center
                    Color: =glbNeutralPrimaryColor
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =12
                    Text: ="單號"
                    Width: =120
                    X: =10
                    ZIndex: =1

                Label4_7 As label:
                    Align: =Center
                    Color: =glbNeutralPrimaryColor
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =12
                    Text: ="表格名稱"
                    Width: =200
                    X: =150
                    ZIndex: =2

                Label4_8 As label:
                    Color: =glbNeutralPrimaryColor
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =12
                    Text: ="表格類型"
                    Width: =74
                    X: =483
                    ZIndex: =3

                Label4_9 As label:
                    Align: =Center
                    Color: =glbNeutralPrimaryColor
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =12
                    Text: ="部門"
                    Width: =100
                    X: =370
                    ZIndex: =4

                Label4_10 As label:
                    Align: =Center
                    Color: =glbNeutralPrimaryColor
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =12
                    Text: ="提交人"
                    Width: =74
                    X: =592
                    ZIndex: =5

                Label4_11 As label:
                    Align: =Center
                    Color: =glbNeutralPrimaryColor
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =12
                    Text: ="提交時間"
                    Width: =116
                    X: =690
                    ZIndex: =6

                Label4_12 As label:
                    Color: =glbNeutralPrimaryColor
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =12
                    Text: ="流程狀態"
                    Width: =74
                    X: =938
                    ZIndex: =7

                Label4_13 As label:
                    Color: =glbNeutralPrimaryColor
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =12
                    Text: ="當前節點"
                    Width: =74
                    X: =840
                    ZIndex: =8

                Label4_20 As label:
                    Align: =Center
                    Color: =glbNeutralPrimaryColor
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =12
                    Text: ="操作"
                    Width: =98
                    X: =1043
                    ZIndex: =9

            TaskListGallery As gallery.galleryVertical:
                Fill: =RGBA(255, 255, 255, 1)
                Height: =504
                Items: |-
                    =If(
                        TabGallery3_4.Selected.Value = "全部",
                        AllApprovalData,
                        //SortByColumns(AllApprovalListDataCol,"FlowCreateDate",Descending),
                        TabGallery3_4.Selected.Value = "待處理",
                        AllPendingApprovalData,
                        //SortByColumns(FilterPendingDataCol,"FlowCreateDate",Descending),
                        TabGallery3_4.Selected.Value = "已處理",
                        AllinprogressApprovalData
                        //SortByColumns(inprogressData,"FlowCreateDate",Descending)
                    )
                Layout: =Layout.Vertical
                OnSelect: |-
                    =If(
                        ThisItem.FlowTaskName = "招聘職位申請表",
                        If(
                            ThisItem.TaskStatus = "001",
                            Launch(
                                "https://apps.powerapps.com/play/abc17763-3a85-47e5-99a2-410af57f1a77?tenantId=b7a4bbdd-6e9c-4929-b5a4-6550feead77c&Screen=JobTitleFormScreen&AppIds=" & LookUp(
                                    ApplitionJobPosition,
                                    ApprovalId = TaskListGallery.Selected.Title
                                ).Title & "&MasterflowId=" & TaskListGallery.Selected.Title & "&resubmit=true"
                            ),
                            Launch(
                                "https://apps.powerapps.com/play/abc17763-3a85-47e5-99a2-410af57f1a77?tenantId=b7a4bbdd-6e9c-4929-b5a4-6550feead77c&Screen=JobTitleFormDetailScreen&AppIds=" & LookUp(
                                    ApplitionJobPosition,
                                    ApprovalId = TaskListGallery.Selected.Title
                                ).Title & "&MasterflowId=" & TaskListGallery.Selected.Title & "&resubmit=false"
                            )
                        ),
                        ThisItem.FlowTaskName = "假期批核人資料表",
                        If(
                            ThisItem.TaskStatus = "001",
                            Launch(
                                "https://apps.powerapps.com/play/8bc833a4-5aff-417c-ab44-f513af1f03f0?tenantId=b7a4bbdd-6e9c-4929-b5a4-6550feead77c&Screen=VacationFormDetailScreen&taskNum=" & LookUp(
                                    VacationApprovalForm,
                                    Applicant_No = TaskListGallery.Selected.Title
                                ).Title & "&approvalNum=" & TaskListGallery.Selected.Title & "&resubmit=true"
                            ),
                            Launch(
                                "https://apps.powerapps.com/play/8bc833a4-5aff-417c-ab44-f513af1f03f0?tenantId=b7a4bbdd-6e9c-4929-b5a4-6550feead77c&Screen=VacationFormDetailScreen&taskNum=" & LookUp(
                                    VacationApprovalForm,
                                    Applicant_No = TaskListGallery.Selected.Title
                                ).Title & "&approvalNum=" & TaskListGallery.Selected.Title & "&resubmit=false"
                            )
                        ),
                        ThisItem.FlowTaskName = "預備合約通知書(新入職)",
                        If(
                            ThisItem.TaskStatus = "001",
                            Launch(
                                "https://apps.powerapps.com/play/abc17763-3a85-47e5-99a2-410af57f1a77?tenantId=b7a4bbdd-6e9c-4929-b5a4-6550feead77c&Screen=ContractNoticeForm&taskNum=" & LookUp(
                                    ContractNotice,
                                    ApprovalId = TaskListGallery.Selected.Title
                                ).Title & "&approvalNum=" & TaskListGallery.Selected.Title & "&resubmit=true"
                            ),
                            Launch(
                                "https://apps.powerapps.com/play/abc17763-3a85-47e5-99a2-410af57f1a77?tenantId=b7a4bbdd-6e9c-4929-b5a4-6550feead77c&Screen=ContractNoticeFormDetail&taskNum=" & LookUp(
                                    ContractNotice,
                                    ApprovalId = TaskListGallery.Selected.Title
                                ).Title & "&approvalNum=" & TaskListGallery.Selected.Title & "&resubmit=false"
                            )
                        ),
                        ThisItem.FlowTaskName = "任職資源申請",
                        Launch(
                            "https://apps.powerapps.com/play/8bc833a4-5aff-417c-ab44-f513af1f03f0?tenantId=b7a4bbdd-6e9c-4929-b5a4-6550feead77c&Screen=EmploymentFormDetail&taskNum=" & LookUp(
                                EmploymentRresource,
                                ApprovalId = TaskListGallery.Selected.Title
                            ).Title & "&approvalNum=" & TaskListGallery.Selected.Title & "&resubmit=false"
                        ),
                        With(
                            {
                                FormId: LookUp(
                                    GenericFormList,
                                    ApprovalId = ThisItem.Approval_No
                                ).Title
                            },
                            Launch("https://apps.powerapps.com/play/b0fe476b-44c4-4c9c-9c05-4608369b9f9f?tenantId=b7a4bbdd-6e9c-4929-b5a4-6550feead77c&Screen=DetailGeneralFormScreen&FormId=" & FormId & "&FLowId=" & TaskListGallery.Selected.Approval_No)
                        )
                    )
                TemplatePadding: =0
                TemplateSize: =48
                Width: =1142
                X: =20
                Y: =40
                ZIndex: =2

                Label3_6 As label:
                    Color: =glbNeutralSecondaryColor
                    Height: =48
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =12
                    Text: =ThisItem.FlowOrder
                    Width: =140
                    X: =10
                    ZIndex: =1

                Rectangle3_3 As rectangle:
                    Fill: =glbNeutralLightColor
                    Height: =1
                    OnSelect: =Select(Parent)
                    Width: =Parent.TemplateWidth
                    Y: =47
                    ZIndex: =2

                Label3_7 As label:
                    Align: =Center
                    Color: =glbNeutralSecondaryColor
                    Height: =48
                    HoverColor: =glbThemePrimaryColor
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =12
                    Text: =ThisItem.FlowTaskName
                    Width: =200
                    X: =150
                    ZIndex: =9

                lblTag_7 As label:
                    Align: =Align.Center
                    BorderColor: =RGBA(255, 255, 255, 1)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =1
                    Color: |-
                        =If(
                            lblTag_7.Text = "任務完成",
                            glbSuccessColor,
                            lblTag_7.Text = "Success",
                            glbSuccessColor,
                            lblTag_7.Text = "Processing",
                            glbLinkColor,
                            lblTag_7.Text = "審批中",
                            glbWarningColor,
                            lblTag_7.Text = "已拒絕",
                            glbErrorColor
                        )
                    Fill: =ColorFade(Self.Color, 90%)
                    FocusedBorderThickness: =2
                    Height: =28
                    OnSelect: =
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =11.5
                    Text: =ThisItem.Application_Status
                    Width: =72
                    X: =938
                    Y: =10
                    ZIndex: =10

                BtnDefaultIconOnly_5 As icon.Add:
                    BorderColor: =Self.Color
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =1
                    Color: =glbThemePrimaryColor
                    DisabledBorderColor: =RGBA(219, 219, 219, 1)
                    DisabledColor: =RGBA(149, 149, 149, 1)
                    DisabledFill: =RGBA(244, 244, 244, 1)
                    Fill: =White
                    FocusedBorderThickness: =1
                    Height: =24
                    HoverBorderColor: =ColorFade(Self.BorderColor, -25%)
                    HoverColor: =ColorFade(Self.BorderColor, -25%)
                    Icon: =Icon.Copy
                    OnSelect: |-
                        =If(
                            ThisItem.FlowTaskName = "招聘職位申請表",
                           
                                Launch(
                                    "https://apps.powerapps.com/play/abc17763-3a85-47e5-99a2-410af57f1a77?tenantId=b7a4bbdd-6e9c-4929-b5a4-6550feead77c&Screen=JobTitleFormDetailScreen&AppIds=" & LookUp(
                                        ApplitionJobPosition,
                                        ApprovalId = TaskListGallery.Selected.Title
                                    ).Title & "&MasterflowId=" & TaskListGallery.Selected.Title & "&resubmit=false&isCopy=true"
                                )
                            ,
                            ThisItem.FlowTaskName = "假期批核人資料表",
                           
                                Launch(
                                    "https://apps.powerapps.com/play/8bc833a4-5aff-417c-ab44-f513af1f03f0?tenantId=b7a4bbdd-6e9c-4929-b5a4-6550feead77c&Screen=VacationFormDetailScreen&taskNum=" & LookUp(
                                        VacationApprovalForm,
                                        Applicant_No = TaskListGallery.Selected.Title
                                    ).Title & "&approvalNum=" & TaskListGallery.Selected.Title & "&resubmit=false&isCopy=true"
                                )
                            ,
                            ThisItem.FlowTaskName = "預備合約通知書(新入職)",
                           
                                Launch(
                                    "https://apps.powerapps.com/play/abc17763-3a85-47e5-99a2-410af57f1a77?tenantId=b7a4bbdd-6e9c-4929-b5a4-6550feead77c&Screen=ContractNoticeFormDetail&taskNum=" & LookUp(
                                        ContractNotice,
                                        ApprovalId = TaskListGallery.Selected.Title
                                    ).Title & "&approvalNum=" & TaskListGallery.Selected.Title & "&resubmit=false&isCopy=true"
                                )
                            
                           
                        )
                    PaddingBottom: =4
                    PaddingTop: =4
                    PressedBorderColor: =ColorFade(Self.BorderColor, -15%)
                    PressedColor: =ColorFade(Self.BorderColor, -15%)
                    PressedFill: =ColorFade(Self.Color, 95%)
                    Visible: =If(ThisItem.FlowTaskName="任職資源申請",false,true)
                    Width: =24
                    X: =1067
                    Y: =12
                    ZIndex: =11

                BtnDefaultIconOnly_6 As icon.Add:
                    BorderColor: =Self.Color
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =1
                    Color: =glbErrorColor
                    DisabledBorderColor: =RGBA(219, 219, 219, 1)
                    DisabledColor: =RGBA(149, 149, 149, 1)
                    DisabledFill: =RGBA(244, 244, 244, 1)
                    Fill: =White
                    FocusedBorderThickness: =1
                    Height: =24
                    HoverBorderColor: =ColorFade(Self.BorderColor, -25%)
                    HoverColor: =ColorFade(Self.BorderColor, -25%)
                    Icon: =Icon.Trash
                    OnSelect: =
                    PaddingBottom: =4
                    PaddingTop: =4
                    PressedBorderColor: =ColorFade(Self.BorderColor, -15%)
                    PressedColor: =ColorFade(Self.BorderColor, -15%)
                    PressedFill: =ColorFade(Self.Color, 95%)
                    Visible: =If(ThisItem.TaskStatus="001",true,false)
                    Width: =24
                    X: =1103
                    Y: =12
                    ZIndex: =12

                Label3_8 As label:
                    Align: =Center
                    Color: =glbNeutralSecondaryColor
                    Height: =48
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =12
                    Text: =ThisItem.DepartMentName
                    Width: =100
                    X: =370
                    ZIndex: =13

                Label3_9 As label:
                    Color: =glbNeutralSecondaryColor
                    Height: =48
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =12
                    Text: =ThisItem.FormType
                    Width: =100
                    X: =482
                    ZIndex: =14

                Label3_10 As label:
                    Color: =glbNeutralSecondaryColor
                    Height: =48
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =12
                    Text: =ThisItem.Approver
                    Width: =80
                    X: =590
                    ZIndex: =15

                Label3_11 As label:
                    Color: =glbNeutralSecondaryColor
                    Height: =48
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =11
                    Text: |-
                        =Text(ThisItem.FlowCreateDate,"dd/mm/yyyy HH:mm")
                    Width: =129
                    X: =690
                    ZIndex: =16

                Label3_12 As label:
                    Align: =""
                    Color: =glbNeutralSecondaryColor
                    Height: =48
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =12
                    Text: |-
                        =Switch(
                                ThisItem.TaskStatus,
                                "001",
                                "準備中",
                                "002",
                                "待批准",
                                "003",
                                "待執行",
                                "004",
                                "進行中",
                                "006",
                                "任務完成",
                                "000",
                                "已拒絕",
                                "進行中"
                            )
                    Width: =74
                    X: =840
                    ZIndex: =17

    ContainerMenu As groupContainer.manualLayoutContainer:
        Fill: =RGBA(255, 255, 255, 1)
        Height: =718
        Width: =160
        Y: =50
        ZIndex: =4

        GalleryNav_6 As gallery.galleryVertical:
            Height: =237
            Items: =["首頁","表格管理","組織機構","用戶管理","任務管理"]
            Layout: =Layout.Vertical
            TemplatePadding: =0
            TemplateSize: =40
            Width: =160
            ZIndex: =1

            BtnDefault_12 As button:
                Align: =Align.Left
                BorderColor: =Self.Color
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =If(ThisItem.Value="任務管理", glbThemePrimaryColor,glbNeutralSecondaryColor)
                DisabledBorderColor: =RGBA(219, 219, 219, 1)
                Fill: =If(ThisItem.Value="任務管理", ColorFade(Self.Color, 90%),White)
                FocusedBorderThickness: =1
                FontWeight: =If(ThisItem.Value="任務管理", FontWeight.Semibold,Normal)
                Height: =32
                HoverBorderColor: =ColorFade(Self.Color, -15%)
                HoverColor: =ColorFade(Self.Color, -15%)
                HoverFill: =ColorFade(glbThemePrimaryColor, 90%)
                OnSelect: |-
                    =If(
                        ThisItem.Value = "首頁",
                        Navigate(
                            HomepageScreen,
                            ScreenTransition.None
                        ),
                        ThisItem.Value = "表格管理",
                        Navigate(
                            'AdminFormListScreen-leo',
                            ScreenTransition.None
                        ),
                        ThisItem.Value = "組織機構",
                        "",
                        ThisItem.Value = "任務管理",
                        Navigate(
                            GeneralFormListScreen,
                            ScreenTransition.None
                        )
                    )
                PaddingBottom: =0
                PaddingLeft: =36
                PaddingRight: =0
                PaddingTop: =0
                PressedBorderColor: =ColorFade(Self.Color, -25%)
                PressedColor: =ColorFade(Self.Color, -25%)
                PressedFill: =ColorFade(Self.Color, 95%)
                RadiusBottomLeft: =4
                RadiusBottomRight: =4
                RadiusTopLeft: =4
                RadiusTopRight: =4
                Size: =12
                Text: =ThisItem.Value
                Width: =140
                X: =10
                ZIndex: =3

            Icon1_6 As icon.ListScrollWatchlist:
                Color: =If(ThisItem.Value="任務管理", glbThemePrimaryColor,glbNeutralSecondaryColor)
                Height: =20
                Icon: |
                    =If(
                        ThisItem.Value = "首頁",
                        Icon.Home,
                        ThisItem.Value = "表格管理",
                        Icon.ListScrollWatchlist,
                        ThisItem.Value = "組織機構",
                        Icon.LogJournal,
                        ThisItem.Value = "用戶管理",
                        Icon.People,
                        ThisItem.Value = "任務管理",
                        Icon.Lock
                    )
                OnSelect: =Select(Parent)
                Width: =20
                X: =20
                Y: =6
                ZIndex: =5

        GalleryNav_7 As gallery.galleryVertical:
            Height: =120
            Items: =["IT服務台","操作手冊","用戶反饋"]
            Layout: =Layout.Vertical
            TemplatePadding: =0
            TemplateSize: =40
            Width: =160
            Y: =558
            ZIndex: =5

            BtnDefault_14 As button:
                Align: =Align.Left
                BorderColor: =Self.Color
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =glbNeutralSecondaryColor
                DisabledBorderColor: =RGBA(219, 219, 219, 1)
                Fill: =White
                FocusedBorderThickness: =1
                FontWeight: =Normal
                Height: =32
                HoverBorderColor: =ColorFade(Self.Color, -15%)
                HoverColor: =ColorFade(Self.Color, -15%)
                HoverFill: =ColorFade(glbThemePrimaryColor, 90%)
                PaddingBottom: =0
                PaddingLeft: =36
                PaddingRight: =0
                PaddingTop: =0
                PressedBorderColor: =ColorFade(Self.Color, -25%)
                PressedColor: =ColorFade(Self.Color, -25%)
                PressedFill: =ColorFade(Self.Color, 95%)
                RadiusBottomLeft: =4
                RadiusBottomRight: =4
                RadiusTopLeft: =4
                RadiusTopRight: =4
                Size: =12
                Text: =ThisItem.Value
                Width: =140
                X: =10
                ZIndex: =3

            Icon1_7 As icon.ListScrollWatchlist:
                Color: =glbNeutralSecondaryColor
                Height: =20
                Icon: |
                    =If(
                        ThisItem.Value = "IT服務台",
                        Icon.ComputerDesktop,
                        ThisItem.Value = "操作手冊",
                        Icon.Notebook,
                        ThisItem.Value = "組織機構",
                        Icon.LogJournal,
                        ThisItem.Value = "用戶反饋",
                        Icon.Mail
                    )
                    //["IT服務台","操作手冊","用戶反饋"]
                OnSelect: =Select(Parent)
                Width: =20
                X: =20
                Y: =6
                ZIndex: =5

        Label8_1 As label:
            Align: =Align.Center
            Color: =RGBA(149, 149, 149, 1)
            Size: =11
            Text: ="Version 1.0.0"
            Width: =160
            Y: =678
            ZIndex: =6


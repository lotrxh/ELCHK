"HomePageScreen As screen.'phoneLayout_FluidGridWithHeaderPageLayout_ver3.0'":
    Fill: =RGBA(242, 242, 242, 1)
    OnHidden: =
    OnVisible: |+
        =//生成带部门Taskname字段的ApprovalDetail_Table待理任务
        ClearCollect(
            ApprovalDetailColwithdepartment,
            AddColumns(
                Filter(
                ShowColumns(
                    ApprovalDetail_Table,
                    "Title",
                    "Approval_No",
                    "Approver",
                    "ApproverEmail",
                    "Priortty",
                    "TaskStatus",
                    "AgentUserEmail",
                    "ActionNode",
                    "Modified",
                    "Created"
                ),
                CurrentUser in ApproverEmail,
                TaskStatus = "001" || TaskStatus = "002"
            ),
                "DepartMentName",
                LookUp(
                    Approval_Table,
                    标题 = Approval_No
                ).DepartMentUnit,
                "FormDepartMentName",
                LookUp(
                    Approval_Table,
                    标题 = Approval_No
                ).DepartMentName,
                "Application_No",
                LookUp(
                    Approval_Table,
                    标题 = Approval_No
                ).Application_No,
                "Task_Name",
                LookUp(
                    Approval_Table,
                    标题 = Approval_No
                ).Task_Name
            )
        );
        //生成带部门Taskname字段的ApprovalDetail_Table全部待理任务
        ClearCollect(
            ApprovalDetailColwithdepartmentAll,
            AddColumns(
                Filter(
                ShowColumns(
                    ApprovalDetail_Table,
                    "Title",
                    "Approval_No",
                    "Approver",
                    "ApproverEmail",
                    "Priortty",
                    "TaskStatus",
                    "AgentUserEmail",
                    "ActionNode",
                    "Modified",
                    "Created"
                ),
                TaskStatus = "001" || TaskStatus = "002"
            ),
                "DepartMentName",
                LookUp(
                    Approval_Table,
                    标题 = Approval_No
                ).DepartMentUnit,
                "FormDepartMentName",
                LookUp(
                    Approval_Table,
                    标题 = Approval_No
                ).DepartMentName,
                "Application_No",
                LookUp(
                    Approval_Table,
                    标题 = Approval_No
                ).Application_No,
                "Task_Name",
                LookUp(
                    Approval_Table,
                    标题 = Approval_No
                ).Task_Name
            )
        );
        //過濾二期超過30天待處理任務
        ClearCollect(
            ApprovalDetailColwithPhase2_30days1,
            Filter(ApprovalDetailColwithdepartmentAll,
            Task_Name <> "任職資源申請" && Task_Name <> "招聘職位申請表" && Task_Name <> "假期批核人資料表" && Task_Name <> "預備合約通知書(新入職)" && Task_Name <> Blank() && DateDiff(Created,Now()) > 30 && !(CurrentUser in ApproverEmail) &&
            (CurrentRoleTaskPermission in DepartMentName || CurrentRoleTaskPermissionForm in FormDepartMentName)
            )
        );
        ClearCollect(PandingTask,ApprovalDetailColwithdepartment,ApprovalDetailColwithPhase2_30days1);
        ClearCollect(DataModelName,GenericFormModel);
        Patch(DataModelName,Defaults(DataModelName),{ModelName:"招聘職位申請表",ModelDescription:"申請招聘空缺",ModelFlowNumber:"X0101",ModelDepartment:"新入職",ModelType:"全部"});
        // Patch(DataModelName,Defaults(DataModelName),{ModelName:"假期批核人資料表",ModelDescription:"假期表格",ModelFlowNumber:"A306",ModelDepartment:"行政部"});
        Patch(DataModelName,Defaults(DataModelName),{ModelName:"任職資源申請",ModelDescription:"申請卡片及系統帳戶等資源",ModelFlowNumber:"X0103",ModelDepartment:"新入職",ModelType:"全部"});
        Patch(DataModelName,Defaults(DataModelName),{ModelName:"預備合約通知書(新入職)",ModelDescription:"只適用於新入職申請",ModelFlowNumber:"X0102",ModelDepartment:"新入職",ModelType:"全部"});
        

    MainflowContainer_1 As groupContainer.verticalAutoLayoutContainer:
        Fill: =RGBA(242, 242, 242, 1)
        Height: =Parent.Height-Self.X
        LayoutDirection: =LayoutDirection.Vertical
        LayoutGap: =10
        LayoutMode: =LayoutMode.Auto
        LayoutOverflowY: =LayoutOverflow.Scroll
        Width: =Parent.Width
        Y: =80
        ZIndex: =5

        FillInContainer_2 As groupContainer.horizontalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.Center
            Fill: =RGBA(242, 242, 242, 1)
            FillPortions: =0
            Height: =Max(LeftContainer12_2.Y+LeftContainer12_2.Height+40,RightContainer_2.Y+RightContainer_2.Height+40)
            LayoutGap: =20
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            LayoutWrap: =true
            Width: |
                =Switch(
                        HomePageScreen.Size,
                        ScreenSize.Small,
                       Parent.Width,
                        ScreenSize.Medium,
                       Parent.Width-40,
                       ScreenSize.Large,
                       Parent.Width-40,
                       1200
                  )
            X: =(Parent.Width-Self.Width)/2
            Y: =LeftContainer12_2.Y+LeftContainer12_2.Height+10
            ZIndex: =2

            LeftContainer12_2 As groupContainer.verticalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                Fill: =RGBA(255, 255, 255, 1)
                FillPortions: =1.3
                Height: |-
                    =//WaitingTaskContainer.Y+WaitingTaskContainer.Height+20
                    Rectangle5_5.Y+Rectangle5_5.Height
                LayoutAlignItems: =LayoutAlignItems.Stretch
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =100
                LayoutMinWidth: =400
                LayoutMode: =LayoutMode.Auto
                ZIndex: =1

                WaitingTaskContainer As groupContainer.verticalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    Fill: =RGBA(255, 255, 255, 1)
                    FillPortions: =0
                    Height: =Rectangle5_5.Y+Rectangle5_5.Height
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutGap: =10
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    PaddingLeft: =20
                    PaddingRight: =20
                    PaddingTop: =20
                    ZIndex: =1

                    Container15 As groupContainer.horizontalAutoLayoutContainer:
                        FillPortions: =0
                        Height: =TextInput2_15.Height+10
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        PaddingLeft: =1
                        PaddingRight: =1
                        ZIndex: =1

                        Container23 As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.Center
                            Height: =40
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            PaddingRight: =1
                            ZIndex: =2

                            TextInput2_15 As text:
                                BorderColor: =glbNeutralQuaternaryColor
                                BorderThickness: =1
                                Color: =glbNeutralPrimaryColor
                                Default: =""
                                FocusedBorderColor: =glbNeutralSecondaryColor
                                FocusedBorderThickness: =1
                                Height: =36
                                HintText: ="搜尋待處理申請"
                                HoverBorderColor: =glbThemePrimaryColor
                                HoverFill: =White
                                PaddingBottom: =1
                                PaddingLeft: =34
                                PaddingRight: =4
                                PaddingTop: =1
                                PressedBorderColor: =ColorFade(Self.BorderColor, -20%)
                                PressedFill: =White
                                RadiusBottomLeft: =4
                                RadiusBottomRight: =4
                                RadiusTopLeft: =4
                                RadiusTopRight: =4
                                Size: =11
                                Width: =Container23.Width-2
                                X: =1
                                Y: =1
                                ZIndex: =1

                            Icon3_2 As icon.Search:
                                Color: =RGBA(116, 116, 116, 1)
                                Height: =32
                                Icon: =Icon.Search
                                PaddingBottom: =6
                                PaddingTop: =6
                                Width: =32
                                X: =1
                                Y: =3
                                ZIndex: =2

                    Container16 As groupContainer.horizontalAutoLayoutContainer:
                        FillPortions: =0
                        Height: =Gallery5.Height+10
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        PaddingLeft: =1
                        PaddingRight: =1
                        ZIndex: =2

                        Gallery5 As gallery.galleryVertical:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            Height: |-
                                =//400
                                If(
                                    CountA(
                                        ApprovalDetailColwithdepartment.ActionNode)<5,
                                    CountA(
                                        ApprovalDetailColwithdepartment.ActionNode)*80,
                                        400)
                            Items: =Search(SortByColumns(PandingTask,"Modified",Ascending),TextInput2_15.Text,"DepartMentName","Application_No","Task_Name")
                            Layout: =Layout.Vertical
                            LayoutMinHeight: =287
                            LayoutMinWidth: =320
                            OnSelect: =
                            TemplatePadding: =0
                            TemplateSize: =80
                            Transition: =Transition.Pop
                            Width: =505
                            X: =20
                            Y: =95
                            ZIndex: =1

                            Label11 As label:
                                Color: =glbNeutralSecondaryColor
                                Height: =32
                                OnSelect: =Select(Parent)
                                Size: =10
                                Text: =ThisItem.Application_No
                                Tooltip: ="ThisItem.Application_No"
                                Wrap: =false
                                Y: =7
                                ZIndex: =1

                            Label11_1 As label:
                                Align: =Align.Right
                                Color: =glbNeutralSecondaryColor
                                Height: =32
                                OnSelect: =Select(Parent)
                                Size: =10
                                Text: |-
                                    =//ThisItem.DepartMentUnit
                                    If(CountA(Split(ThisItem.DepartMentName,"-").Result)=2,First(Split(ThisItem.DepartMentName,"-")).Result,First(Split(ThisItem.DepartMentName,"-")).Result&"-"&Index(Split(ThisItem.DepartMentName,"-"),2).Result)
                                Tooltip: ="ThisItem.DepartMentUnit"
                                Wrap: =false
                                X: =Gallery5.Width-Icon5_6.Width-Label11_1.Width-10
                                Y: =7
                                ZIndex: =2

                            Label11_2 As label:
                                Color: =glbNeutralSecondaryColor
                                Height: =32
                                OnSelect: =Select(Parent)
                                Size: =10
                                Text: =ThisItem.Task_Name
                                Tooltip: ="ThisItem.Task_Name"
                                Wrap: =false
                                Y: =39
                                ZIndex: =3

                            Label11_3 As label:
                                Align: =Align.Right
                                Color: =glbNeutralSecondaryColor
                                Height: =32
                                OnSelect: =Select(Parent)
                                Size: =10
                                Text: |-
                                    =If(App.ActiveScreen.Width>1000,Text(ThisItem.Modified,"dd/mm/yyyy HH:mm"),Text(ThisItem.Modified,"dd/mm/yyyy"))
                                Tooltip: ="ThisItem.Modified"
                                Wrap: =false
                                X: =Gallery5.Width-Icon5_6.Width-Label11_1.Width-10
                                Y: =39
                                ZIndex: =4

                            LineRectangle_4 As rectangle:
                                Fill: =RGBA(219, 219, 219, 1)
                                Height: =1
                                Width: =Gallery5.Width
                                Y: =79
                                ZIndex: =5

                            Icon5_6 As icon.ChevronRight:
                                Color: =glbThemePrimaryColor
                                Height: =30
                                HoverColor: =RGBA(102, 182, 227, 1)
                                HoverFill: =RGBA(0, 0, 0, 0)
                                Icon: =Icon.ChevronRight
                                OnSelect: |-
                                    =With(
                                    {
                                    FormName:LookUp(Approval_Table,标题=ThisItem.Approval_No).Task_Name
                                    },
                                    If(
                                        ThisItem.Task_Name = "招聘職位申請表",
                                        If(
                                            ThisItem.TaskStatus = "001",
                                            Launch(
                                                JumpUrl & "&Screen=JobTitleFormScreen&AppIds=" & LookUp(
                                                    ApplitionJobPosition,
                                                    ApprovalId = Gallery5.Selected.Approval_No
                                                ).Title & "&MasterflowId=" & Gallery5.Selected.Approval_No & "&resubmit=true&bustype=edit"
                                            ),
                                            ThisItem.TaskStatus = "002",
                                            Launch(
                                                JumpUrl & "&Screen=JobTitleFormDetailScreen&AppIds=" & LookUp(
                                                    ApplitionJobPosition,
                                                    ApprovalId = Gallery5.Selected.Approval_No
                                                ).Title & "&MasterflowId=" & Gallery5.Selected.Approval_No & "&resubmit=false&canOperation=true"
                                            ),
                                            Launch(
                                                JumpUrl & "&Screen=JobTitleFormDetailScreen&AppIds=" & LookUp(
                                                    ApplitionJobPosition,
                                                    ApprovalId = Gallery5.Selected.Approval_No
                                                ).Title & "&MasterflowId=" & Gallery5.Selected.Approval_No & "&resubmit=false&canOperation=true"
                                            )
                                        ),
                                        ThisItem.Task_Name = "假期批核人資料表",
                                        If(
                                            ThisItem.TaskStatus = "001",
                                            Launch(
                                                JumpUrlA306A111 & "&Screen=VacationFormScreen&taskNum=" & LookUp(
                                                    VacationApprovalForm,
                                                    Applicant_No = Gallery5.Selected.Approval_No
                                                ).Title & "&approvalNum=" & Gallery5.Selected.Approval_No & "&resubmit=true&bustype=edit"
                                            ),
                                            ThisItem.TaskStatus = "002",
                                            Launch(
                                                JumpUrlA306A111 & "&Screen=VacationFormDetailScreen&taskNum=" & LookUp(
                                                    VacationApprovalForm,
                                                    Applicant_No = Gallery5.Selected.Approval_No
                                                ).Title & "&approvalNum=" & Gallery5.Selected.Approval_No & "&resubmit=false&canOperation=true"
                                            ),
                                            Launch(
                                                JumpUrlA306A111 & "&Screen=VacationFormDetailScreen&taskNum=" & LookUp(
                                                    VacationApprovalForm,
                                                    Applicant_No = Gallery5.Selected.Approval_No
                                                ).Title & "&approvalNum=" & Gallery5.Selected.Approval_No & "&resubmit=false&canOperation=true"
                                            )
                                        ),
                                        ThisItem.Task_Name = "預備合約通知書(新入職)",
                                        If(
                                            ThisItem.TaskStatus = "001",
                                            Launch(
                                                JumpUrl & "&Screen=ContractNoticeForm&taskNum=" & LookUp(
                                                    ContractNotice,
                                                    ApprovalId = Gallery5.Selected.Approval_No
                                                ).标题 & "&approvalNum=" & Gallery5.Selected.Approval_No & "&resubmit=true&bustype=edit"
                                            ),
                                            ThisItem.TaskStatus = "002",
                                            Launch(
                                                JumpUrl & "&Screen=ContractNoticeFormDetail&taskNum=" & LookUp(
                                                    ContractNotice,
                                                    ApprovalId = Gallery5.Selected.Approval_No
                                                ).标题 & "&approvalNum=" & Gallery5.Selected.Approval_No & "&resubmit=false&canOperation=true"
                                            ),
                                            Launch(
                                                JumpUrl & "&Screen=ContractNoticeFormDetail&taskNum=" & LookUp(
                                                    ContractNotice,
                                                    ApprovalId = Gallery5.Selected.Approval_No
                                                ).标题 & "&approvalNum=" & Gallery5.Selected.Approval_No & "&resubmit=false&canOperation=true"
                                            )
                                        ),
                                        ThisItem.Task_Name = "任職資源申請",
                                        If(
                                            ThisItem.TaskStatus = "001",
                                            Launch(
                                                JumpUrlA306A111 & "&Screen=EmploymentFormScreen&taskNum=" & LookUp(
                                                    ContractNotice,
                                                    ApprovalId = Gallery5.Selected.Approval_No
                                                ).标题 & "&approvalNum=" & Gallery5.Selected.Approval_No & "&resubmit=true&bustype=edit"
                                            ),
                                            Launch(
                                                JumpUrlA306A111 & "&Screen=EmploymentFormDetail&taskNum=" & LookUp(
                                                    EmploymentResource,
                                                    ApprovalId = Gallery5.Selected.Approval_No
                                                ).Title & "&approvalNum=" & Gallery5.Selected.Approval_No & "&resubmit=false&canOperation=true"
                                            )
                                        ),
                                        With(
                                            {
                                                FormId: LookUp(
                                                    GenericFormList,
                                                    ApprovalId = ThisItem.Approval_No
                                                ).标题,
                                                FLowId: Gallery5.Selected.Approval_No
                                            },
                                            Launch(JumpUrlMobileApp&"&Screen=DetailGeneralFormScreen&FormId=" & FormId & "&FLowId=" & Gallery5.Selected.Approval_No & "&Page=Moblie" & "&approvalNum=" & Gallery5.Selected.Approval_No
                                            ,{},LaunchTarget.Replace)
                                        )
                                    )
                                    )
                                PaddingBottom: =3
                                PaddingTop: =3
                                Width: =30
                                X: =Gallery5.Width-Self.Width-15
                                Y: =26
                                ZIndex: =6

                    Rectangle5_5 As rectangle:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =5
                        ZIndex: =4

            RightContainer_2 As groupContainer.verticalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                Fill: =RGBA(255, 255, 255, 1)
                Height: =Rectangle5_7.Y+Rectangle5_7.Height+10
                LayoutAlignItems: =LayoutAlignItems.Stretch
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =100
                LayoutMinWidth: =300
                LayoutMode: =LayoutMode.Auto
                PaddingLeft: =20
                PaddingRight: =20
                ZIndex: =2

                Container4_1 As groupContainer.manualLayoutContainer:
                    Fill: =RGBA(255, 255, 255, 1)
                    FillPortions: =0
                    Height: =158
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Width: =545
                    X: =569
                    Y: =114
                    ZIndex: =1

                    TextInput2_16 As text:
                        BorderColor: =glbNeutralQuaternaryColor
                        BorderThickness: =1
                        Color: =glbNeutralPrimaryColor
                        Default: =""
                        FocusedBorderColor: =glbNeutralSecondaryColor
                        FocusedBorderThickness: =1
                        Height: =36
                        HintText: ="搜尋表格"
                        HoverBorderColor: =glbThemePrimaryColor
                        HoverFill: =White
                        PaddingBottom: =0
                        PaddingLeft: =34
                        PaddingRight: =0
                        PaddingTop: =0
                        PressedBorderColor: =ColorFade(Self.BorderColor, -20%)
                        PressedFill: =White
                        RadiusBottomLeft: =4
                        RadiusBottomRight: =4
                        RadiusTopLeft: =4
                        RadiusTopRight: =4
                        Size: =11
                        Width: =Parent.Width-2
                        X: =1
                        Y: =23
                        ZIndex: =1

                    Icon3_1 As icon.Search:
                        Color: =RGBA(116, 116, 116, 1)
                        Height: =32
                        Icon: =Icon.Search
                        PaddingBottom: =6
                        PaddingTop: =6
                        Width: =32
                        X: =1
                        Y: =22
                        ZIndex: =2

                    TaskNameGallery_2 As gallery.galleryVertical:
                        Height: =80
                        Items: |-
                            =If(
                                TextInput2_16.Text = "",
                                Search(
                                    ShowColumns(RenameColumns(
                                        SortByColumns(
                                            Filter(
                                                MyContacts,
                                                UserEmail = User().Email,
                                                ContatsType = Blank()
                                                //,TaskFormName = First(Filter(GenericFormModel,ModelName = TaskFormName, IsEnable= "1")).ModelName
                                                
                                            ),
                                            "Created",
                                            Descending
                                        ),
                                        "TaskFormName",
                                        "ModelName",
                                        "TaskFormDescription",
                                        "ModelDescription"
                                    ),"ModelName","ModelDescription","ModelFlowNumber"),
                                    TextInput2_16.Text,
                                    "ModelName","ModelDescription","ModelFlowNumber"
                                ),
                                
                                    Search(
                                        ShowColumns(
                                            DataModelName,
                                           /* Filter(
                                                ,
                                                ModelDescription = Gallery2_1.Selected.FormType
                                            ),*/
                                            "ModelName",
                                            "ModelDescription",
                                            "ModelFlowNumber"
                                        ),
                                        TextInput2_16.Text,
                                        "ModelName","ModelDescription","ModelFlowNumber"
                                    
                            )
                            )
                        Layout: =Layout.Vertical
                        ShowScrollbar: =false
                        TemplatePadding: =0
                        TemplateSize: =80
                        Width: =Parent.Width-2
                        WrapCount: =3
                        X: =1
                        Y: =70
                        ZIndex: =3

                        Label2_9 As label:
                            Color: =glbNeutralSecondaryColor
                            Height: =20
                            HoverColor: =glbThemePrimaryColor
                            OnSelect: =Select(Parent)
                            PaddingBottom: =0
                            PaddingLeft: =20
                            PaddingRight: =20
                            PaddingTop: =0
                            Size: =10
                            Text: =If(ThisItem.ModelName in Filter(GenericFormModel,IsEnable="0").ModelName,ThisItem.ModelFlowNumber&"(停用中)",ThisItem.ModelFlowNumber)
                            Width: =Parent.TemplateWidth-10
                            Wrap: =false
                            Y: =16
                            ZIndex: =1

                        Label2_10 As label:
                            Color: =glbNeutralSecondaryColor
                            Height: =20
                            HoverColor: =glbThemePrimaryColor
                            OnSelect: =Select(Parent)
                            PaddingBottom: =0
                            PaddingLeft: =20
                            PaddingRight: =20
                            PaddingTop: =0
                            Size: =10
                            Text: =ThisItem.ModelName
                            Tooltip: =Self.Text
                            Width: =Parent.TemplateWidth-10
                            Wrap: =false
                            Y: =36
                            ZIndex: =2

                        Button_large_13 As button:
                            Align: =Align.Left
                            BorderColor: =glbNeutralQuaternaryColor
                            BorderThickness: =1
                            Color: =glbNeutralPrimaryColor
                            DisabledBorderColor: =RGBA(219, 219, 219, 1)
                            DisabledFill: =RGBA(0, 0, 0,0)
                            DisplayMode: =If(ThisItem.ModelName in Filter(GenericFormModel,IsEnable="0").ModelName,Disabled,Edit)
                            Fill: =RGBA(0, 0, 0, 0)
                            FocusedBorderThickness: =1
                            FontWeight: =FontWeight.Normal
                            Height: =70
                            HoverBorderColor: =glbThemePrimaryColor
                            HoverColor: =
                            HoverFill: =
                            OnSelect: |-
                                =If(
                                    ThisItem.ModelName = "招聘職位申請表",
                                        If(
                                            !IsBlank(
                                                LookUp(
                                                    MyContacts,
                                                    UserEmail = User().Email && TaskFormName = "招聘職位申請表"
                                                )
                                            ),
                                            "",
                                            Patch(
                                                MyContacts,
                                                Defaults(MyContacts),
                                                {
                                                    TaskFormName: "招聘職位申請表",
                                                    标题: GUID(),
                                                    UserEmail: User().Email,
                                                    ContatsType: "",
                                                    ModelFlowNumber: "A103"
                                                }
                                            )
                                        );
                                    Launch(
                                        JumpUrl & "&Screen=JobTitleFormScreen&newApplicationGuid=" & GUID() & "&flowguid=" & GUID() & "&bustype=New",
                                        {},
                                        LaunchTarget.Replace
                                    ),
                                    ThisItem.ModelName = "假期批核人資料表",
                                    
                                        If(
                                            !IsBlank(
                                                LookUp(
                                                    MyContacts,
                                                    UserEmail = User().Email && TaskFormName = "假期批核人資料表"
                                                )
                                            ),
                                            "",
                                            Patch(
                                                MyContacts,
                                                Defaults(MyContacts),
                                                {
                                                    TaskFormName: "假期批核人資料表",
                                                    标题: GUID(),
                                                    UserEmail: User().Email,
                                                    ContatsType: "",
                                                    ModelFlowNumber: "A306"
                                                }
                                            )
                                        );
                                    Launch(
                                        JumpUrlA306A111 & "&Screen=VacationFormScreen&newApplicationGuid=" & GUID() & "&flowguid=" & GUID() & "&bustype=New",
                                        {},
                                        LaunchTarget.Replace
                                    ),
                                    ThisItem.ModelName = "任職資源申請",
                                        If(
                                            !IsBlank(
                                                LookUp(
                                                    MyContacts,
                                                    UserEmail = User().Email && TaskFormName = "任職資源申請"
                                                )
                                            ),
                                            "",
                                            Patch(
                                                MyContacts,
                                                Defaults(MyContacts),
                                                {
                                                    TaskFormName: "任職資源申請",
                                                    标题: GUID(),
                                                    UserEmail: User().Email,
                                                    ContatsType: "",
                                                    ModelFlowNumber: "A111"
                                                }
                                            )
                                        );
                                    Launch(
                                        JumpUrlA306A111 & "&Screen=EmploymentFormScreen&newApplicationGuid=" & GUID() & "&flowguid=" & GUID() & "&bustype=New",
                                        {},
                                        LaunchTarget.Replace
                                    ),
                                    ThisItem.ModelName = "預備合約通知書(新入職)",
                                        If(
                                            !IsBlank(
                                                LookUp(
                                                    MyContacts,
                                                    UserEmail = User().Email && TaskFormName = "預備合約通知書(新入職)"
                                                )
                                            ),
                                            "",
                                            Patch(
                                                MyContacts,
                                                Defaults(MyContacts),
                                                {
                                                    TaskFormName: "預備合約通知書(新入職)",
                                                    标题: GUID(),
                                                    UserEmail: User().Email,
                                                    ContatsType: "",
                                                    ModelFlowNumber: "A104"
                                                }
                                            )
                                        );
                                    Launch(
                                        JumpUrl & "&Screen=ContractNoticeForm&newApplicationGuid=" & GUID() & "&flowguid=" & GUID() & "&bustype=New",
                                        {},
                                        LaunchTarget.Replace
                                    ),
                                        If(
                                            !IsBlank(
                                                LookUp(
                                                    MyContacts,
                                                    UserEmail = User().Email && TaskFormName = ThisItem.ModelName
                                                )
                                            ),
                                            "",
                                            Patch(
                                                MyContacts,
                                                Defaults(MyContacts),
                                                {
                                                    TaskFormName: ThisItem.ModelName,
                                                    标题: GUID(),
                                                    UserEmail: User().Email,
                                                    ContatsType: "",
                                                    TaskFormDescription: ThisItem.ModelDescription,
                                                    ModelFlowNumber: ThisItem.ModelFlowNumber
                                                }
                                            )
                                        );
                                    With(
                                        {
                                            FormModelId: LookUp(
                                                GenericFormModel,
                                                ModelFlowNumber = ThisItem.ModelFlowNumber
                                            ).标题
                                        },
                                        Launch(
                                            JumpUrlMobileApp&"&Screen=CreateGeneralFormScreen&FormModelId="&FormModelId & "&Page=Moblie",
                                            {},
                                            LaunchTarget.Replace
                                        )
                                    )
                                )
                            PaddingBottom: =0
                            PaddingLeft: =10
                            PaddingRight: =10
                            PaddingTop: =0
                            PressedBorderColor: =glbThemePrimaryColor
                            PressedColor: =
                            PressedFill: =
                            RadiusBottomLeft: =4
                            RadiusBottomRight: =4
                            RadiusTopLeft: =4
                            RadiusTopRight: =4
                            Size: =10
                            Text: =
                            Tooltip: ="名稱："&ThisItem.ModelName&Char(10)&"備註："&If(ThisItem.ModelDescription=Blank(),"/",ThisItem.ModelDescription)
                            Width: =Parent.TemplateWidth-10
                            X: =1
                            Y: =1
                            ZIndex: =3

                LineRectangle_7 As rectangle:
                    AlignInContainer: =AlignInContainer.Center
                    Fill: =RGBA(237, 237, 237, 1)
                    Height: =3
                    Width: =RightContainer_2.Width
                    Y: =79
                    ZIndex: =2

                Container4_2 As groupContainer.manualLayoutContainer:
                    Fill: =RGBA(255, 255, 255, 1)
                    FillPortions: =0
                    Height: =TaskNameGallery_1.Y+TaskNameGallery_1.Height+10
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Width: =477
                    ZIndex: =3

                    drpFilterDepartmentType As combobox:
                        BorderColor: =glbNeutralTertiaryColor
                        BorderThickness: =1
                        ChevronBackground: =RGBA(255, 255, 255, 1)
                        ChevronDisabledBackground: =RGBA(0, 0, 0, 0)
                        ChevronDisabledFill: =RGBA(202, 202, 202, 1)
                        ChevronFill: =glbNeutralTertiaryColor
                        ChevronHoverBackground: =ColorFade(Self.ChevronBackground, -5%)
                        ChevronHoverFill: =ColorFade(Self.BorderColor, -20%)
                        Color: =glbNeutralPrimaryColor
                        DefaultSelectedItems: |-
                            =//Distinct(DepartmentForm,Department)//加载编辑表格部门
                            Distinct(Filter(
                                MyContacts,
                                    UserEmail = User().Email,
                                        ContatsType = "部門"
                                    ),ApplyDepartment)
                        DisplayFields: =["Value"]
                        FocusedBorderThickness: =1
                        Height: =33
                        HoverBorderColor: =ColorFade(Self.BorderColor, -20%)
                        HoverColor: =Self.Color
                        HoverFill: =ColorFade(Self.Fill, -5%)
                        InputTextPlaceholder: ="請選擇部門/服務"
                        IsSearchable: =false
                        Items: =["部門","服務","功能"]
                        NoSelectionText: ="請選擇部門/服務"
                        OnChange: =Reset(drpFilterDepartmentName);Reset(drpFilterFormTypeName);
                        PaddingBottom: =0
                        PaddingLeft: =10
                        PaddingTop: =0
                        PressedColor: =Self.Color
                        PressedFill: =ColorFade(Self.Fill, -5%)
                        SearchFields: =["Value"]
                        SearchItems: =[]
                        SelectionColor: =glbThemePrimaryColor
                        SelectionFill: =ColorFade(Self.SelectionColor, 90%)
                        SelectMultiple: =false
                        Size: =10
                        Width: =Parent.Width-2
                        X: =1
                        Y: =15
                        ZIndex: =4

                    drpFilterDepartmentName As combobox:
                        BorderColor: =glbNeutralTertiaryColor
                        BorderThickness: =1
                        ChevronBackground: =RGBA(255, 255, 255, 1)
                        ChevronDisabledBackground: =RGBA(0, 0, 0, 0)
                        ChevronDisabledFill: =RGBA(202, 202, 202, 1)
                        ChevronFill: =glbNeutralTertiaryColor
                        ChevronHoverBackground: =ColorFade(Self.ChevronBackground, -5%)
                        ChevronHoverFill: =ColorFade(Self.BorderColor, -20%)
                        Color: =glbNeutralPrimaryColor
                        DefaultSelectedItems: =
                        DisplayFields: =["Result"]
                        FocusedBorderThickness: =1
                        Height: =33
                        HoverBorderColor: =ColorFade(Self.BorderColor, -20%)
                        HoverColor: =Self.Color
                        HoverFill: =ColorFade(Self.Fill, -5%)
                        InputTextPlaceholder: ="請選擇類型/單位"
                        Items: =Distinct(Filter(FormTableType,DepartMentType=drpFilterDepartmentType.Selected.Value),DepartMentName)
                        NoSelectionText: ="請選擇類型/單位"
                        OnChange: =Reset(drpFilterFormTypeName);
                        PaddingBottom: =
                        PaddingLeft: =10
                        PaddingTop: =0
                        PressedColor: =Self.Color
                        PressedFill: =ColorFade(Self.Fill, -5%)
                        SearchFields: =["Result"]
                        SearchItems: =Search(Distinct(Filter(FormTableType,DepartMentType=drpFilterDepartmentType.Selected.Value),DepartMentName),drpFilterDepartmentName.SearchText,"Result")
                        SelectionColor: =glbThemePrimaryColor
                        SelectionFill: =ColorFade(Self.SelectionColor, 90%)
                        SelectMultiple: =false
                        Size: =10
                        Width: =Parent.Width-2
                        X: =1
                        Y: =67
                        ZIndex: =5

                    drpFilterFormTypeName As combobox:
                        BorderColor: =glbNeutralTertiaryColor
                        BorderThickness: =1
                        ChevronBackground: =RGBA(255, 255, 255, 1)
                        ChevronDisabledBackground: =RGBA(0, 0, 0, 0)
                        ChevronDisabledFill: =RGBA(202, 202, 202, 1)
                        ChevronFill: =glbNeutralTertiaryColor
                        ChevronHoverBackground: =ColorFade(Self.ChevronBackground, -5%)
                        ChevronHoverFill: =ColorFade(Self.BorderColor, -20%)
                        Color: =glbNeutralPrimaryColor
                        DefaultSelectedItems: |-
                            =//Distinct(DepartmentForm,Department)//加载编辑表格部门
                            Distinct(Filter(
                                MyContacts,
                                    UserEmail = User().Email,
                                        ContatsType = "部門"
                                    ),ApplyDepartment)
                        DisplayFields: =["FormType"]
                        FocusedBorderThickness: =1
                        Height: =33
                        HoverBorderColor: =ColorFade(Self.BorderColor, -20%)
                        HoverColor: =Self.Color
                        HoverFill: =ColorFade(Self.Fill, -5%)
                        InputTextPlaceholder: ="請選擇填申請部門/單位"
                        Items: |-
                            =Filter(
                                    FormTableType,
                                    DepartMentName = drpFilterDepartmentName.Selected.Result
                                ).FormType
                        NoSelectionText: ="請選擇填申請部門/單位"
                        PaddingBottom: =0
                        PaddingLeft: =10
                        PaddingTop: =0
                        PressedColor: =Self.Color
                        PressedFill: =ColorFade(Self.Fill, -5%)
                        SearchFields: =["FormType"]
                        SearchItems: |-
                            =Search(Filter(
                                    FormTableType,
                                    DepartMentName = drpFilterDepartmentName.Selected.Result
                                ).FormType,drpFilterFormTypeName.SearchText,"FormType")
                        SelectionColor: =glbThemePrimaryColor
                        SelectionFill: =ColorFade(Self.SelectionColor, 90%)
                        SelectMultiple: =false
                        Size: =10
                        Width: =Parent.Width-2
                        X: =1
                        Y: =120
                        ZIndex: =6

                    TaskNameGallery_1 As gallery.galleryVertical:
                        Height: |-
                            =//144
                            If(CountA(
                                Filter(
                                                DataModelName,
                                                ModelDepartment = drpFilterDepartmentName.Selected.Result,
                                                ModelType = drpFilterFormTypeName.Selected.FormType
                                            ).ModelType)=0,0,
                            CountA(
                                Filter(
                                                DataModelName,
                                                ModelDepartment = drpFilterDepartmentName.Selected.Result,
                                                ModelType = drpFilterFormTypeName.Selected.FormType
                                            ).ModelType)<4,72,144)
                        Items: |-
                            =ShowColumns(
                                    Filter(
                                                DataModelName,
                                                ModelDepartment = drpFilterDepartmentName.Selected.Result,
                                                ModelType = drpFilterFormTypeName.Selected.FormType
                                            ),
                                            "ModelName",
                                            "ModelDescription",
                                            "ModelFlowNumber"
                                        )
                        Layout: =Layout.Vertical
                        TemplatePadding: =0
                        TemplateSize: =70
                        Width: =Parent.Width-2
                        WrapCount: =3
                        X: =1
                        Y: =170
                        ZIndex: =7

                        Label2_7 As label:
                            Color: =glbNeutralSecondaryColor
                            Height: =20
                            HoverColor: =glbThemePrimaryColor
                            OnSelect: =Select(Parent)
                            PaddingBottom: =0
                            PaddingLeft: =20
                            PaddingRight: =20
                            PaddingTop: =0
                            Size: =10
                            Text: =If(ThisItem.ModelName in Filter(GenericFormModel,IsEnable="0").ModelName,ThisItem.ModelFlowNumber&"(停用中)",ThisItem.ModelFlowNumber)
                            Width: =Parent.TemplateWidth-10
                            Wrap: =false
                            Y: =16
                            ZIndex: =1

                        Label2_8 As label:
                            Color: =glbNeutralSecondaryColor
                            Height: =20
                            HoverColor: =glbThemePrimaryColor
                            OnSelect: =Select(Parent)
                            PaddingBottom: =0
                            PaddingLeft: =20
                            PaddingRight: =20
                            PaddingTop: =0
                            Size: =10
                            Text: =ThisItem.ModelName
                            Tooltip: =Self.Text
                            Width: =Parent.TemplateWidth-10
                            Wrap: =false
                            Y: =36
                            ZIndex: =2

                        Button_large_12 As button:
                            Align: =Align.Left
                            BorderColor: =glbNeutralQuaternaryColor
                            BorderThickness: =1
                            Color: =glbNeutralPrimaryColor
                            DisabledBorderColor: =RGBA(219, 219, 219, 1)
                            DisabledFill: =RGBA(0, 0, 0,0)
                            DisplayMode: =If(ThisItem.ModelName in Filter(GenericFormModel,IsEnable="0").ModelName,Disabled,Edit)
                            Fill: =RGBA(0, 0, 0, 0)
                            FocusedBorderThickness: =1
                            FontWeight: =FontWeight.Normal
                            Height: =70
                            HoverBorderColor: =glbThemePrimaryColor
                            HoverColor: =RGBA(128, 128, 128, 1)
                            HoverFill: =
                            OnSelect: |-
                                =If(
                                    ThisItem.ModelName = "招聘職位申請表",
                                        If(
                                            !IsBlank(
                                                LookUp(
                                                    MyContacts,
                                                    UserEmail = User().Email && TaskFormName = "招聘職位申請表"
                                                )
                                            ),
                                            "",
                                            Patch(
                                                MyContacts,
                                                Defaults(MyContacts),
                                                {
                                                    TaskFormName: "招聘職位申請表",
                                                    标题: GUID(),
                                                    UserEmail: User().Email,
                                                    ContatsType: "",
                                                    ModelFlowNumber: "A103"
                                                }
                                            )
                                        );
                                    Launch(
                                        JumpUrl & "&Screen=JobTitleFormScreen&newApplicationGuid=" & GUID() & "&flowguid=" & GUID() & "&bustype=New",
                                        {},
                                        LaunchTarget.Replace
                                    ),
                                    ThisItem.ModelName = "假期批核人資料表",
                                    
                                        If(
                                            !IsBlank(
                                                LookUp(
                                                    MyContacts,
                                                    UserEmail = User().Email && TaskFormName = "假期批核人資料表"
                                                )
                                            ),
                                            "",
                                            Patch(
                                                MyContacts,
                                                Defaults(MyContacts),
                                                {
                                                    TaskFormName: "假期批核人資料表",
                                                    标题: GUID(),
                                                    UserEmail: User().Email,
                                                    ContatsType: "",
                                                    ModelFlowNumber: "A306"
                                                }
                                            )
                                        );
                                    Launch(
                                        JumpUrlA306A111 & "&Screen=VacationFormScreen&newApplicationGuid=" & GUID() & "&flowguid=" & GUID() & "&bustype=New",
                                        {},
                                        LaunchTarget.Replace
                                    ),
                                    ThisItem.ModelName = "任職資源申請",
                                        If(
                                            !IsBlank(
                                                LookUp(
                                                    MyContacts,
                                                    UserEmail = User().Email && TaskFormName = "任職資源申請"
                                                )
                                            ),
                                            "",
                                            Patch(
                                                MyContacts,
                                                Defaults(MyContacts),
                                                {
                                                    TaskFormName: "任職資源申請",
                                                    标题: GUID(),
                                                    UserEmail: User().Email,
                                                    ContatsType: "",
                                                    ModelFlowNumber: "A111"
                                                }
                                            )
                                        );
                                    Launch(
                                        JumpUrlA306A111 & "&Screen=EmploymentFormScreen&newApplicationGuid=" & GUID() & "&flowguid=" & GUID() & "&bustype=New",
                                        {},
                                        LaunchTarget.Replace
                                    ),
                                    ThisItem.ModelName = "預備合約通知書(新入職)",
                                        If(
                                            !IsBlank(
                                                LookUp(
                                                    MyContacts,
                                                    UserEmail = User().Email && TaskFormName = "預備合約通知書(新入職)"
                                                )
                                            ),
                                            "",
                                            Patch(
                                                MyContacts,
                                                Defaults(MyContacts),
                                                {
                                                    TaskFormName: "預備合約通知書(新入職)",
                                                    标题: GUID(),
                                                    UserEmail: User().Email,
                                                    ContatsType: "",
                                                    ModelFlowNumber: "A104"
                                                }
                                            )
                                        );
                                    Launch(
                                        JumpUrl & "&Screen=ContractNoticeForm&newApplicationGuid=" & GUID() & "&flowguid=" & GUID() & "&bustype=New",
                                        {},
                                        LaunchTarget.Replace
                                    ),
                                        If(
                                            !IsBlank(
                                                LookUp(
                                                    MyContacts,
                                                    UserEmail = User().Email && TaskFormName = ThisItem.ModelName
                                                )
                                            ),
                                            "",
                                            Patch(
                                                MyContacts,
                                                Defaults(MyContacts),
                                                {
                                                    TaskFormName: ThisItem.ModelName,
                                                    标题: GUID(),
                                                    UserEmail: User().Email,
                                                    ContatsType: "",
                                                    TaskFormDescription: ThisItem.ModelDescription,
                                                    ModelFlowNumber: ThisItem.ModelFlowNumber
                                                }
                                            )
                                        );
                                    With(
                                        {
                                            FormModelId: LookUp(
                                                GenericFormModel,
                                                ModelFlowNumber = ThisItem.ModelFlowNumber
                                            ).标题
                                        },
                                        Launch(
                                            JumpUrlMobileApp&"&Screen=CreateGeneralFormScreen&FormModelId="&FormModelId & "&Page=Moblie",
                                            {},
                                            LaunchTarget.Replace
                                        )
                                    )
                                )
                            PaddingBottom: =0
                            PaddingLeft: =10
                            PaddingRight: =0
                            PaddingTop: =0
                            PressedBorderColor: =glbThemePrimaryColor
                            PressedColor: =
                            PressedFill: =
                            RadiusBottomLeft: =4
                            RadiusBottomRight: =4
                            RadiusTopLeft: =4
                            RadiusTopRight: =4
                            Size: =10
                            Text: =
                            Tooltip: ="名稱："&ThisItem.ModelName&Char(10)&"備註："&If(ThisItem.ModelDescription=Blank(),"/",ThisItem.ModelDescription)
                            Width: =Parent.TemplateWidth-10
                            X: =1
                            Y: =1
                            ZIndex: =3

                Rectangle5_7 As rectangle:
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =5
                    X: =40
                    Y: =40
                    ZIndex: =4

    HeaderContainer_5 As groupContainer.manualLayoutContainer:
        Fill: =RGBA(255, 255, 255, 1)
        Height: =60
        Width: |-
            =//Switch(HomePageScreen.Size,ScreenSize.Small, Parent .Width,ScreenSize.Medium, Parent .Width-40,ScreenSize.Large, Parent .Width-40,1200)
            Parent.Width
        X: =(Parent.Width-Self.Width)/2
        ZIndex: =6

        Image1_3 As image:
            Height: =60
            Image: =logo_单图标
            OnSelect: =
            Width: =40
            X: =8
            ZIndex: =7

        Label1_76 As label:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =60
            OnSelect: =
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =10
            Text: |-
                ="ELCSS-HK
                eProcessing System (ePS)"
            Width: =217
            X: =60
            ZIndex: =8

        Image7_1 As image:
            Height: =40
            Image: =User().Image
            RadiusBottomLeft: =20
            RadiusBottomRight: =20
            RadiusTopLeft: =20
            RadiusTopRight: =20
            Visible: =If(App.ActiveScreen.Width>700,true,false)
            Width: =40
            X: =Parent.Width-Self.Width-8
            Y: =10
            ZIndex: =10

        Label1_77 As label:
            Align: =Align.Right
            Fill: =RGBA(255, 255, 255, 1)
            Height: =60
            OnSelect: =
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =10
            Text: ="歡迎你，"&CurrentUserName
            Visible: =If(App.ActiveScreen.Width>700,true,false)
            Width: =191
            X: =Parent.Width-Self.Width-Image7_1.Width-20
            ZIndex: =11

